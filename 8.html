<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ® äººç”Ÿæ¨¡æ‹Ÿå™¨2.0</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
            --info: #3498db;
            --gold: #f5af19;
            --purple: #9b59b6;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #fff;
            overflow-x: hidden;
        }

        /* ç²’å­èƒŒæ™¯ */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 0;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            animation: float 15s infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100vh) rotate(720deg); opacity: 0; }
        }

        /* ä¸»å®¹å™¨ */
        .game-wrapper {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* å¼€å§‹ç•Œé¢ */
        .start-screen {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            animation: fadeIn 1s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .game-title {
            font-size: 4em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #f5af19, #f12711, #667eea, #764ba2);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientShift 5s ease infinite;
            text-shadow: 0 0 60px rgba(102, 126, 234, 0.5);
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .game-subtitle {
            font-size: 1.3em;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 40px;
        }

        /* è§’è‰²åˆ›å»º */
        .creation-panel {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 40px;
            max-width: 600px;
            width: 100%;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .input-group {
            margin-bottom: 25px;
            text-align: left;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 600;
        }

        .input-group input,
        .input-group select {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            font-size: 16px;
            background: rgba(0, 0, 0, 0.2);
            color: #fff;
            transition: all 0.3s;
        }

        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }

        .gender-options {
            display: flex;
            gap: 15px;
        }

        .gender-btn {
            flex: 1;
            padding: 18px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            background: rgba(0, 0, 0, 0.2);
            color: #fff;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .gender-btn:hover {
            border-color: var(--primary);
            background: rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        .gender-btn.selected {
            border-color: var(--primary);
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3));
        }

        /* å¤©èµ‹é€‰æ‹© */
        .talent-selection {
            margin: 25px 0;
        }

        .talent-title {
            font-size: 1.1em;
            margin-bottom: 15px;
            color: var(--gold);
        }

        .talent-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
        }

        .talent-card {
            padding: 15px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .talent-card:hover {
            transform: translateY(-3px);
            border-color: var(--primary);
        }

        .talent-card.selected {
            border-color: var(--gold);
            background: rgba(245, 175, 25, 0.1);
        }

        .talent-card.legendary { border-color: #ff6b6b; }
        .talent-card.epic { border-color: #9b59b6; }
        .talent-card.rare { border-color: #3498db; }
        .talent-card.common { border-color: #95a5a6; }

        .talent-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .talent-desc {
            font-size: 0.8em;
            color: rgba(255, 255, 255, 0.6);
        }

        /* æŒ‰é’®æ ·å¼ */
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: #fff;
        }

        .btn-success {
            background: linear-gradient(135deg, #11998e, #38ef7d);
            color: #fff;
        }

        .btn-warning {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: #fff;
        }

        .btn-gold {
            background: linear-gradient(135deg, #f5af19, #f12711);
            color: #fff;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .start-btn {
            width: 100%;
            padding: 18px;
            font-size: 1.2em;
            margin-top: 20px;
        }

        /* æ¸¸æˆä¸»ç•Œé¢ */
        .game-screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        /* é¡¶éƒ¨ä¿¡æ¯æ  */
        .top-bar {
            display: grid;
            grid-template-columns: auto 1fr auto;
            gap: 20px;
            align-items: center;
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .player-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5em;
            position: relative;
            overflow: hidden;
        }

        .player-avatar::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.2), transparent);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) rotate(45deg); }
            100% { transform: translateX(100%) rotate(45deg); }
        }

        .player-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .player-name {
            font-size: 1.5em;
            font-weight: 700;
        }

        .player-badges {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .badge-age { background: var(--danger); }
        .badge-job { background: var(--success); }
        .badge-money { background: var(--gold); }
        .badge-edu { background: var(--info); }

        .time-control {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: flex-end;
        }

        .time-display {
            font-size: 1.3em;
            font-weight: 700;
            color: var(--gold);
        }

        .time-buttons {
            display: flex;
            gap: 8px;
        }

        .time-btn {
            padding: 8px 16px;
            font-size: 0.9em;
        }

        /* ä¸»å†…å®¹åŒº */
        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 20px;
        }

        /* å·¦ä¾§é¢æ¿ */
        .left-panel, .right-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .panel {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .panel-title {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* å±æ€§æ¡ */
        .stat-item {
            margin-bottom: 15px;
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            font-size: 0.9em;
        }

        .stat-bar {
            height: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            overflow: hidden;
        }

        .stat-fill {
            height: 100%;
            border-radius: 5px;
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        .stat-health { background: linear-gradient(90deg, #ff6b6b, #ee5a5a); }
        .stat-happiness { background: linear-gradient(90deg, #feca57, #ff9f43); }
        .stat-intelligence { background: linear-gradient(90deg, #48dbfb, #0abde3); }
        .stat-appearance { background: linear-gradient(90deg, #ff9ff3, #f368e0); }
        .stat-energy { background: linear-gradient(90deg, #1dd1a1, #10ac84); }
        .stat-morality { background: linear-gradient(90deg, #a29bfe, #6c5ce7); }
        .stat-reputation { background: linear-gradient(90deg, #fd79a8, #e84393); }
        .stat-stress { background: linear-gradient(90deg, #636e72, #2d3436); }

        /* ä¸­é—´åŒºåŸŸ */
        .center-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* äº‹ä»¶æ—¥å¿— */
        .event-log {
            flex: 1;
            min-height: 400px;
            max-height: 500px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 16px;
            padding: 20px;
            font-family: 'Courier New', monospace;
        }

        .event-log::-webkit-scrollbar {
            width: 8px;
        }

        .event-log::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        }

        .event-log::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        .event-item {
            margin-bottom: 12px;
            padding: 12px 15px;
            border-radius: 10px;
            border-left: 4px solid var(--primary);
            background: rgba(255, 255, 255, 0.05);
            animation: slideIn 0.3s ease;
            transition: all 0.3s;
        }

        .event-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .event-time {
            color: var(--gold);
            font-weight: bold;
            margin-right: 8px;
        }

        .event-type-good { border-left-color: var(--success); background: rgba(39, 174, 96, 0.1); }
        .event-type-bad { border-left-color: var(--danger); background: rgba(231, 76, 60, 0.1); }
        .event-type-money { border-left-color: var(--gold); background: rgba(245, 175, 25, 0.1); }
        .event-type-love { border-left-color: #ff6b9d; background: rgba(255, 107, 157, 0.1); }
        .event-type-career { border-left-color: var(--info); background: rgba(52, 152, 219, 0.1); }
        .event-type-special { border-left-color: var(--purple); background: rgba(155, 89, 182, 0.1); }

        /* è¡ŒåŠ¨æŒ‰é’®åŒº */
        .action-area {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .action-btn {
            padding: 15px 10px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .action-btn:hover {
            border-color: var(--primary);
            background: rgba(102, 126, 234, 0.1);
            transform: translateY(-3px);
        }

        .action-btn .icon {
            font-size: 1.5em;
        }

        .action-btn .cost {
            font-size: 0.75em;
            color: var(--danger);
        }

        .action-btn .gain {
            font-size: 0.75em;
            color: var(--success);
        }

        /* å³ä¾§é¢æ¿ */
        .relation-list {
            max-height: 200px;
            overflow-y: auto;
        }

        .relation-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 8px;
            background: rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
        }

        .relation-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .relation-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
        }

        .relation-info {
            flex: 1;
        }

        .relation-name {
            font-weight: 600;
        }

        .relation-type {
            font-size: 0.8em;
            color: rgba(255, 255, 255, 0.6);
        }

        .relation-closeness {
            font-size: 0.85em;
            color: var(--gold);
        }

        /* ä»»åŠ¡åˆ—è¡¨ */
        .quest-item {
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-left: 3px solid var(--gold);
        }

        .quest-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .quest-desc {
            font-size: 0.85em;
            color: rgba(255, 255, 255, 0.7);
        }

        .quest-progress {
            margin-top: 8px;
            height: 6px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 3px;
            overflow: hidden;
        }

        .quest-progress-fill {
            height: 100%;
            background: var(--gold);
            border-radius: 3px;
            transition: width 0.3s;
        }

        /* æŠ€èƒ½åˆ—è¡¨ */
        .skill-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 8px;
            background: rgba(0, 0, 0, 0.2);
        }

        .skill-name {
            font-weight: 600;
        }

        .skill-level {
            display: flex;
            gap: 3px;
        }

        .skill-star {
            color: var(--gold);
        }

        .skill-star.empty {
            color: rgba(255, 255, 255, 0.2);
        }

        /* åº•éƒ¨åŠŸèƒ½åŒº */
        .bottom-bar {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .bottom-bar .btn {
            flex: 1;
            min-width: 120px;
            justify-content: center;
        }

        /* æ¨¡æ€æ¡† */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border-radius: 20px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: modalIn 0.3s ease;
        }

        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-header {
            font-size: 1.5em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: #fff;
            font-size: 1.5em;
            cursor: pointer;
        }

        /* é€‰æ‹©æŒ‰é’® */
        .choice-btn {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
        }

        .choice-btn:hover {
            border-color: var(--primary);
            background: rgba(102, 126, 234, 0.1);
            padding-left: 25px;
        }

        .choice-effect {
            font-size: 0.85em;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 5px;
        }

        /* å•†åº— */
        .shop-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }

        .shop-item {
            padding: 15px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.2);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .shop-item:hover {
            border-color: var(--gold);
            transform: translateY(-3px);
        }

        .shop-item.owned {
            opacity: 0.5;
            border-color: var(--success);
        }

        .shop-item-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .shop-item-price {
            color: var(--gold);
            font-weight: 600;
        }

        .shop-item-desc {
            font-size: 0.8em;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 5px;
        }

        /* æˆå°± */
        .achievement-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
        }

        .achievement-item {
            padding: 15px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.2);
            text-align: center;
            transition: all 0.3s;
        }

        .achievement-item.unlocked {
            border-color: var(--gold);
            background: rgba(245, 175, 25, 0.1);
        }

        .achievement-icon {
            font-size: 2em;
            margin-bottom: 8px;
        }

        .achievement-name {
            font-size: 0.9em;
            font-weight: 600;
        }

        /* æ¸¸æˆç»“æŸ */
        .game-over-screen {
            display: none;
            min-height: 100vh;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            animation: fadeIn 1s ease;
        }

        .game-over-title {
            font-size: 3em;
            margin-bottom: 20px;
            color: var(--danger);
        }

        .life-summary {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 40px;
            max-width: 700px;
            margin: 20px 0;
        }

        .final-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        .final-stat {
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
        }

        .final-stat-value {
            font-size: 2em;
            font-weight: 700;
            color: var(--gold);
        }

        .final-stat-label {
            color: rgba(255, 255, 255, 0.6);
            margin-top: 5px;
        }

        /* é€šçŸ¥ */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            padding: 16px 24px;
            border-radius: 12px;
            border-left: 4px solid var(--primary);
            z-index: 2000;
            animation: slideInRight 0.3s ease;
            max-width: 300px;
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(100px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* æµ®åŠ¨æ–‡å­— */
        .float-text {
            position: fixed;
            font-weight: bold;
            font-size: 1.2em;
            pointer-events: none;
            animation: floatUp 1s ease-out forwards;
            z-index: 1500;
        }

        @keyframes floatUp {
            0% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-50px); }
        }

        /* å“åº”å¼ */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            .left-panel, .right-panel {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .game-title { font-size: 2.5em; }
            .top-bar { grid-template-columns: 1fr; text-align: center; }
            .action-area { grid-template-columns: repeat(2, 1fr); }
            .final-stats { grid-template-columns: 1fr; }
        }

        /* ç‰¹æ®Šæ•ˆæœ */
        .rainbow-text {
            background: linear-gradient(90deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3);
            background-size: 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: rainbow 3s linear infinite;
        }

        @keyframes rainbow {
            0% { background-position: 0%; }
            100% { background-position: 400%; }
        }

        .glow {
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 0 0 10px #fff, 0 0 20px #fff; }
            to { text-shadow: 0 0 20px #ff00de, 0 0 30px #ff00de; }
        }
    </style>
</head>
<body>
    <!-- ç²’å­èƒŒæ™¯ -->
    <div class="particles" id="particles"></div>

    <div class="game-wrapper">
        <!-- å¼€å§‹ç•Œé¢ -->
        <div class="start-screen" id="startScreen">
            <h1 class="game-title">ğŸ® äººç”Ÿæ¨¡æ‹Ÿå™¨ 2.0</h1>
            <p class="game-subtitle">é‡å†™ä½ çš„å‘½è¿ï¼Œä½“éªŒæ— é™å¯èƒ½</p>
            
            <div class="creation-panel">
                <div class="input-group">
                    <label>ä½ çš„åå­—</label>
                    <input type="text" id="playerName" placeholder="è¾“å…¥ä½ çš„åå­—..." maxlength="10">
                </div>
                
                <div class="input-group">
                    <label>é€‰æ‹©æ€§åˆ«</label>
                    <div class="gender-options">
                        <button class="gender-btn" onclick="selectGender('ç”·')" id="maleBtn">
                            <span>ğŸ‘¦</span> ç”·æ€§
                        </button>
                        <button class="gender-btn" onclick="selectGender('å¥³')" id="femaleBtn">
                            <span>ğŸ‘§</span> å¥³æ€§
                        </button>
                    </div>
                </div>

                <div class="talent-selection">
                    <div class="talent-title">ğŸ² é€‰æ‹©ä½ çš„å¤©èµ‹ï¼ˆæœ€å¤š3ä¸ªï¼Œçº¢è‰²å¤©èµ‹é™é€‰1ä¸ªï¼‰</div>
                    <div class="talent-grid" id="talentGrid">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
                
                <button class="btn btn-primary start-btn" onclick="startGame()">
                    <span>ğŸš€</span> å¼€å§‹æ–°çš„äººç”Ÿ
                </button>
            </div>
        </div>

        <!-- æ¸¸æˆä¸»ç•Œé¢ -->
        <div class="game-screen" id="gameScreen">
            <!-- é¡¶éƒ¨ä¿¡æ¯æ  -->
            <div class="top-bar">
                <div class="player-avatar" id="playerAvatar">ğŸ‘¶</div>
                <div class="player-info">
                    <div class="player-name" id="displayName">-</div>
                    <div class="player-badges">
                        <span class="badge badge-age" id="ageBadge">0å²</span>
                        <span class="badge badge-job" id="jobBadge" style="display:none;">æ— ä¸š</span>
                        <span class="badge badge-edu" id="eduBadge" style="display:none;">æœªä¸Šå­¦</span>
                    </div>
                </div>
                <div class="time-control">
                    <div class="time-display" id="timeDisplay">ç¬¬1å¹´ 1æœˆ</div>
                    <div class="time-buttons">
                        <button class="btn btn-primary time-btn" onclick="nextMonth()">
                            <span>ğŸ“…</span> ä¸‹ä¸ªæœˆ
                        </button>
                        <button class="btn btn-success time-btn" onclick="toggleAutoPlay()" id="autoBtn">
                            <span>â–¶ï¸</span> è‡ªåŠ¨
                        </button>
                    </div>
                </div>
            </div>

            <!-- ä¸»å†…å®¹åŒº -->
            <div class="main-content">
                <!-- å·¦ä¾§é¢æ¿ -->
                <div class="left-panel">
                    <!-- å±æ€§é¢æ¿ -->
                    <div class="panel">
                        <div class="panel-title">ğŸ“Š äººç‰©å±æ€§</div>
                        <div class="stat-item">
                            <div class="stat-header">
                                <span>â¤ï¸ å¥åº·</span>
                                <span id="healthValue">100</span>
                            </div>
                            <div class="stat-bar">
                                <div class="stat-fill stat-health" id="healthBar" style="width:100%"></div>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-header">
                                <span>ğŸ˜Š å¿«ä¹</span>
                                <span id="happinessValue">100</span>
                            </div>
                            <div class="stat-bar">
                                <div class="stat-fill stat-happiness" id="happinessBar" style="width:100%"></div>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-header">
                                <span>ğŸ§  æ™ºåŠ›</span>
                                <span id="intelligenceValue">50</span>
                            </div>
                            <div class="stat-bar">
                                <div class="stat-fill stat-intelligence" id="intelligenceBar" style="width:50%"></div>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-header">
                                <span>âœ¨ é­…åŠ›</span>
                                <span id="appearanceValue">50</span>
                            </div>
                            <div class="stat-bar">
                                <div class="stat-fill stat-appearance" id="appearanceBar" style="width:50%"></div>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-header">
                                <span>âš¡ ä½“åŠ›</span>
                                <span id="energyValue">100</span>
                            </div>
                            <div class="stat-bar">
                                <div class="stat-fill stat-energy" id="energyBar" style="width:100%"></div>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-header">
                                <span>âš–ï¸ é“å¾·</span>
                                <span id="moralityValue">0</span>
                            </div>
                            <div class="stat-bar">
                                <div class="stat-fill stat-morality" id="moralityBar" style="width:50%"></div>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-header">
                                <span>ğŸ‘‘ å£°æœ›</span>
                                <span id="reputationValue">0</span>
                            </div>
                            <div class="stat-bar">
                                <div class="stat-fill stat-reputation" id="reputationBar" style="width:0%"></div>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-header">
                                <span>ğŸ˜° å‹åŠ›</span>
                                <span id="stressValue">0</span>
                            </div>
                            <div class="stat-bar">
                                <div class="stat-fill stat-stress" id="stressBar" style="width:0%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- æŠ€èƒ½é¢æ¿ -->
                    <div class="panel">
                        <div class="panel-title">ğŸ¯ æŠ€èƒ½</div>
                        <div id="skillList">
                            <!-- åŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>

                <!-- ä¸­é—´é¢æ¿ -->
                <div class="center-panel">
                    <!-- äº‹ä»¶æ—¥å¿— -->
                    <div class="event-log" id="eventLog">
                        <div class="event-item event-type-good">
                            <span class="event-time">å‡ºç”Ÿæ—¶ï¼š</span>
                            <span>ä½ æ¥åˆ°äº†è¿™ä¸ªä¸–ç•Œï¼Œçˆ¶æ¯æ»¡æ€€æœŸå¾…åœ°çœ‹ç€ä½ ã€‚</span>
                        </div>
                    </div>

                    <!-- è¡ŒåŠ¨æŒ‰é’® -->
                    <div class="action-area">
                        <button class="action-btn" onclick="doAction('study')">
                            <span class="icon">ğŸ“š</span>
                            <span>å­¦ä¹ </span>
                            <span class="cost">-10ä½“åŠ›</span>
                            <span class="gain">+æ™ºåŠ›</span>
                        </button>
                        <button class="action-btn" onclick="doAction('work')">
                            <span class="icon">ğŸ’¼</span>
                            <span>å·¥ä½œ</span>
                            <span class="cost">-20ä½“åŠ›</span>
                            <span class="gain">+é‡‘é’±</span>
                        </button>
                        <button class="action-btn" onclick="doAction('exercise')">
                            <span class="icon">ğŸƒ</span>
                            <span>é”»ç‚¼</span>
                            <span class="cost">-15ä½“åŠ›</span>
                            <span class="gain">+å¥åº·</span>
                        </button>
                        <button class="action-btn" onclick="doAction('social')">
                            <span class="icon">ğŸ‰</span>
                            <span>ç¤¾äº¤</span>
                            <span class="cost">-Â¥50</span>
                            <span class="gain">+å¿«ä¹</span>
                        </button>
                        <button class="action-btn" onclick="doAction('rest')">
                            <span class="icon">ğŸ˜´</span>
                            <span>ä¼‘æ¯</span>
                            <span class="gain">+ä½“åŠ›</span>
                        </button>
                        <button class="action-btn" onclick="doAction('travel')">
                            <span class="icon">âœˆï¸</span>
                            <span>æ—…è¡Œ</span>
                            <span class="cost">-Â¥500</span>
                            <span class="gain">+å¿«ä¹</span>
                        </button>
                        <button class="action-btn" onclick="doAction('date')">
                            <span class="icon">ğŸ’•</span>
                            <span>çº¦ä¼š</span>
                            <span class="cost">-Â¥200</span>
                            <span class="gain">+æ„Ÿæƒ…</span>
                        </button>
                        <button class="action-btn" onclick="doAction('skill')">
                            <span class="icon">ğŸ“</span>
                            <span>å­¦æŠ€èƒ½</span>
                            <span class="cost">-Â¥300</span>
                            <span class="gain">+æŠ€èƒ½</span>
                        </button>
                    </div>
                </div>

                <!-- å³ä¾§é¢æ¿ -->
                <div class="right-panel">
                    <!-- èµ„é‡‘é¢æ¿ -->
                    <div class="panel">
                        <div class="panel-title">ğŸ’° èµ„äº§</div>
                        <div style="font-size: 2em; color: var(--gold); font-weight: 700;" id="moneyDisplay">
                            Â¥0
                        </div>
                        <div style="margin-top: 10px; color: rgba(255,255,255,0.6);">
                            æœˆæ”¶å…¥: <span id="incomeDisplay">Â¥0</span>
                        </div>
                    </div>

                    <!-- å…‘æ¢ç é¢æ¿ï¼ˆä½äºèµ„äº§åº•ä¸‹ï¼Œæ— æç¤ºï¼‰ -->
                    <div class="panel" style="opacity: 0.7; padding: 15px;">
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <input type="text" id="redeemCodeInput" placeholder="è¾“å…¥å…‘æ¢ç ..." style="flex: 1; padding: 8px 12px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.2); color: #fff; font-size: 0.9em;">
                            <button class="btn btn-secondary" onclick="redeemCode()" style="padding: 8px 16px; font-size: 0.9em; white-space: nowrap;">ç¡®è®¤</button>
                        </div>
                    </div>

                    <!-- å…³ç³»é¢æ¿ -->
                    <div class="panel">
                        <div class="panel-title">ğŸ‘¥ äººé™…å…³ç³»</div>
                        <div class="relation-list" id="relationList">
                            <!-- åŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>

                    <!-- ä»»åŠ¡é¢æ¿ -->
                    <div class="panel">
                        <div class="panel-title">ğŸ“‹ å½“å‰ä»»åŠ¡</div>
                        <div id="questList">
                            <!-- åŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>

                    <!-- å¤©èµ‹é¢æ¿ -->
                    <div class="panel">
                        <div class="panel-title">ğŸŒŸ å¤©èµ‹</div>
                        <div id="talentDisplay">
                            <!-- åŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- åº•éƒ¨åŠŸèƒ½åŒº -->
            <div class="bottom-bar">
                <button class="btn btn-primary" onclick="showCareer()">
                    <span>ğŸ’¼</span> èŒä¸š
                </button>
                <button class="btn btn-success" onclick="showRelations()">
                    <span>ğŸ‘¥</span> äººé™…
                </button>
                <button class="btn btn-warning" onclick="showShop()">
                    <span>ğŸ›’</span> å•†åº—
                </button>
                <button class="btn btn-gold" onclick="showAchievements()">
                    <span>ğŸ†</span> æˆå°±
                </button>
                <button class="btn btn-primary" onclick="showSkills()">
                    <span>ğŸ¯</span> æŠ€èƒ½æ ‘
                </button>
                <button class="btn btn-success" onclick="showProperties()">
                    <span>ğŸ </span> èµ„äº§
                </button>
            </div>
        </div>

        <!-- æ¸¸æˆç»“æŸç•Œé¢ -->
        <div class="game-over-screen" id="gameOverScreen">
            <h1 class="game-over-title">ğŸ’€ äººç”Ÿè½å¹•</h1>
            <div class="life-summary">
                <h2 id="deathReason">ä½ å®‰è¯¦åœ°ç¦»å¼€äº†äººä¸–</h2>
                <div class="final-stats">
                    <div class="final-stat">
                        <div class="final-stat-value" id="finalAge">0</div>
                        <div class="final-stat-label">äº«å¹´</div>
                    </div>
                    <div class="final-stat">
                        <div class="final-stat-value" id="finalMoney">0</div>
                        <div class="final-stat-label">æ€»èµ„äº§</div>
                    </div>
                    <div class="final-stat">
                        <div class="final-stat-value" id="finalAchievements">0</div>
                        <div class="final-stat-label">æˆå°±æ•°</div>
                    </div>
                </div>
                <div id="lifeStory" style="line-height: 1.8; color: rgba(255,255,255,0.8);"></div>
                <div class="achievement-grid" id="unlockedAchievements" style="margin-top: 20px;"></div>
            </div>
            <button class="btn btn-primary start-btn" onclick="restartGame()" style="max-width: 300px;">
                <span>ğŸ”„</span> é‡æ–°å¼€å§‹
            </button>
        </div>
    </div>

    <!-- æ¨¡æ€æ¡† -->
    <div class="modal" id="choiceModal">
        <div class="modal-content">
            <h2 class="modal-header" id="choiceTitle">åšå‡ºé€‰æ‹©</h2>
            <p id="choiceDesc" style="margin-bottom: 20px; color: rgba(255,255,255,0.8);"></p>
            <div id="choiceButtons"></div>
        </div>
    </div>

    <div class="modal" id="shopModal">
        <div class="modal-content">
            <h2 class="modal-header">ğŸ›’ å•†åº—</h2>
            <div class="shop-grid" id="shopGrid"></div>
        </div>
    </div>

    <div class="modal" id="achievementModal">
        <div class="modal-content">
            <h2 class="modal-header">ğŸ† æˆå°±</h2>
            <div class="achievement-grid" id="achievementGrid"></div>
        </div>
    </div>

    <div class="modal" id="careerModal">
        <div class="modal-content">
            <h2 class="modal-header">ğŸ’¼ èŒä¸šå‘å±•</h2>
            <div id="careerContent"></div>
        </div>
    </div>

    <div class="modal" id="skillModal">
        <div class="modal-content">
            <h2 class="modal-header">ğŸ¯ æŠ€èƒ½æ ‘</h2>
            <div id="skillTreeContent"></div>
        </div>
    </div>

    <!-- é€šçŸ¥å®¹å™¨ -->
    <div id="notificationContainer"></div>

    <script>

        // ==================== æ¸¸æˆæ ¸å¿ƒæ•°æ® ====================
        
        // æ¸¸æˆçŠ¶æ€
        let gameState = {
            player: {
                name: '',
                gender: '',
                age: 0,
                month: 1,
                money: 0,
                health: 100,
                happiness: 100,
                intelligence: 50,
                appearance: 50,
                energy: 100,
                morality: 0,
                reputation: 0,
                stress: 0,
                job: null,
                education: 'æœªä¸Šå­¦',
                income: 0,
                talents: [],
                skills: {},
                relations: [],
                properties: [],
                achievements: [],
                quests: [],
                redeemedCodes: []
            },
            isAlive: true,
            isAutoPlaying: false,
            autoPlayInterval: null,
            selectedTalents: [],
            history: []
        };

        // å¤©èµ‹æ•°æ®åº“ (30ä¸ª)
        const talentsDB = [
            { id: 'genius', name: 'ç»ä¸–å¤©æ‰', desc: 'æ™ºåŠ›+30ï¼Œå­¦ä¹ é€Ÿåº¦ç¿»å€', rarity: 'legendary', effect: (p) => { p.intelligence += 30; } },
            { id: 'rich2g', name: 'å¯ŒäºŒä»£', desc: 'åˆå§‹èµ„é‡‘+10000', rarity: 'legendary', effect: (p) => { p.money += 10000; } },
            { id: 'lucky', name: 'å¤©é€‰ä¹‹å­', desc: 'é‡åˆ°å¥½äº‹æ¦‚ç‡+50%', rarity: 'legendary', effect: (p) => {} },
            { id: 'athlete', name: 'è¿åŠ¨å¥å°†', desc: 'å¥åº·ä¸Šé™+30ï¼Œä½“åŠ›æ¢å¤+50%', rarity: 'epic', effect: (p) => { p.maxHealth = 130; } },
            { id: 'charming', name: 'é­…åŠ›å››å°„', desc: 'é­…åŠ›+25ï¼Œç¤¾äº¤æ•ˆæœç¿»å€', rarity: 'epic', effect: (p) => { p.appearance += 25; } },
            { id: 'strong', name: 'é“èƒƒ', desc: 'å¥åº·æ¶ˆè€—-50%', rarity: 'epic', effect: (p) => {} },
            { id: 'social', name: 'ç¤¾äº¤è¾¾äºº', desc: 'ç¤¾äº¤æ”¶ç›Šç¿»å€ï¼Œå®¹æ˜“äº¤æœ‹å‹', rarity: 'epic', effect: (p) => {} },
            { id: 'workaholic', name: 'å·¥ä½œç‹‚', desc: 'å·¥ä½œæ”¶å…¥+50%', rarity: 'epic', effect: (p) => {} },
            { id: 'lucky_common', name: 'å¹¸è¿å„¿', desc: 'é‡åˆ°å¥½äº‹æ¦‚ç‡+20%', rarity: 'rare', effect: (p) => {} },
            { id: 'earlybird', name: 'æ—©èµ·é¸Ÿ', desc: 'ä½“åŠ›æ¢å¤+30%', rarity: 'rare', effect: (p) => {} },
            { id: 'nightowl', name: 'å¤œçŒ«å­', desc: 'æ™šä¸Šå­¦ä¹ æ•ˆç‡+50%', rarity: 'rare', effect: (p) => {} },
            { id: 'optimist', name: 'ä¹å¤©æ´¾', desc: 'å¿«ä¹ä¸‹é™é€Ÿåº¦-50%', rarity: 'rare', effect: (p) => {} },
            { id: 'resilient', name: 'æŠ—å‹è¾¾äºº', desc: 'å‹åŠ›å¢é•¿-50%', rarity: 'rare', effect: (p) => {} },
            { id: 'frugal', name: 'ç²¾æ‰“ç»†ç®—', desc: 'è´­ç‰©èŠ±è´¹-20%', rarity: 'rare', effect: (p) => {} },
            { id: 'creative', name: 'åˆ›æ„æ— é™', desc: 'è‰ºæœ¯æŠ€èƒ½å­¦ä¹ é€Ÿåº¦+50%', rarity: 'rare', effect: (p) => {} },
            { id: 'healthy', name: 'å¥åº·ä½“è´¨', desc: 'å¥åº·+15', rarity: 'common', effect: (p) => { p.health += 15; } },
            { id: 'smart', name: 'èªæ˜ä¼¶ä¿', desc: 'æ™ºåŠ›+10', rarity: 'common', effect: (p) => { p.intelligence += 10; } },
            { id: 'pretty', name: 'çœ‰æ¸…ç›®ç§€', desc: 'é­…åŠ›+10', rarity: 'common', effect: (p) => { p.appearance += 10; } },
            { id: 'energetic', name: 'ç²¾åŠ›å……æ²›', desc: 'ä½“åŠ›+15', rarity: 'common', effect: (p) => { p.energy += 15; } },
            { id: 'kind', name: 'å¿ƒåœ°å–„è‰¯', desc: 'é“å¾·+20', rarity: 'common', effect: (p) => { p.morality += 20; } },
            { id: 'ambitious', name: 'é›„å¿ƒå£®å¿—', desc: 'å£°æœ›è·å–+30%', rarity: 'common', effect: (p) => {} },
            { id: 'bookworm', name: 'ä¹¦è™«', desc: 'é˜…è¯»æ”¶ç›Š+50%', rarity: 'common', effect: (p) => {} },
            { id: 'gamer', name: 'æ¸¸æˆé«˜æ‰‹', desc: 'ç©æ¸¸æˆæ—¶å¿«ä¹+50%', rarity: 'common', effect: (p) => {} },
            { id: 'cook', name: 'å¨è‰ºè¾¾äºº', desc: 'çƒ¹é¥ªæŠ€èƒ½åˆå§‹+2çº§', rarity: 'common', effect: (p) => { p.skills.cooking = 2; } },
            { id: 'musician', name: 'éŸ³ä¹å¤©èµ‹', desc: 'éŸ³ä¹æŠ€èƒ½åˆå§‹+2çº§', rarity: 'common', effect: (p) => { p.skills.music = 2; } },
            { id: 'artist', name: 'è‰ºæœ¯ç»†èƒ', desc: 'ç»˜ç”»æŠ€èƒ½åˆå§‹+2çº§', rarity: 'common', effect: (p) => { p.skills.art = 2; } },
            { id: 'sporty', name: 'è¿åŠ¨å¤©èµ‹', desc: 'è¿åŠ¨æŠ€èƒ½åˆå§‹+2çº§', rarity: 'common', effect: (p) => { p.skills.sports = 2; } },
            { id: 'techie', name: 'ç§‘æŠ€è¿·', desc: 'ç¼–ç¨‹æŠ€èƒ½åˆå§‹+2çº§', rarity: 'common', effect: (p) => { p.skills.programming = 2; } },
            { id: 'polyglot', name: 'è¯­è¨€å¤©èµ‹', desc: 'è¯­è¨€å­¦ä¹ é€Ÿåº¦+50%', rarity: 'common', effect: (p) => {} },
            { id: 'investor', name: 'æŠ•èµ„çœ¼å…‰', desc: 'æŠ•èµ„æ”¶ç›Š+30%', rarity: 'common', effect: (p) => {} }
        ];

        // æŠ€èƒ½æ•°æ®åº“
        const skillsDB = {
            academic: {
                name: 'å­¦æœ¯',
                skills: [
                    { id: 'math', name: 'æ•°å­¦', desc: 'å½±å“ç†ç§‘å­¦ä¹ å’Œç¼–ç¨‹' },
                    { id: 'physics', name: 'ç‰©ç†', desc: 'å½±å“å·¥ç¨‹å’Œç§‘ç ”' },
                    { id: 'chemistry', name: 'åŒ–å­¦', desc: 'å½±å“åŒ»å­¦å’Œåˆ¶è¯' },
                    { id: 'biology', name: 'ç”Ÿç‰©', desc: 'å½±å“åŒ»å­¦å’Œå†œä¸š' },
                    { id: 'literature', name: 'æ–‡å­¦', desc: 'å½±å“å†™ä½œå’Œè¡¨è¾¾' },
                    { id: 'history', name: 'å†å²', desc: 'å½±å“äººæ–‡ç´ å…»' }
                ]
            },
            practical: {
                name: 'å®ç”¨',
                skills: [
                    { id: 'programming', name: 'ç¼–ç¨‹', desc: 'ITè¡Œä¸šå¿…å¤‡' },
                    { id: 'design', name: 'è®¾è®¡', desc: 'åˆ›æ„è¡Œä¸šå¿…å¤‡' },
                    { id: 'cooking', name: 'çƒ¹é¥ª', desc: 'ç”Ÿæ´»æŠ€èƒ½' },
                    { id: 'driving', name: 'é©¾é©¶', desc: 'å‡ºè¡Œä¾¿åˆ©' },
                    { id: 'finance', name: 'ç†è´¢', desc: 'è´¢å¯Œç®¡ç†' }
                ]
            },
            art: {
                name: 'è‰ºæœ¯',
                skills: [
                    { id: 'music', name: 'éŸ³ä¹', desc: 'è‰ºæœ¯ä¿®å…»' },
                    { id: 'art', name: 'ç»˜ç”»', desc: 'è§†è§‰è‰ºæœ¯' },
                    { id: 'dance', name: 'èˆè¹ˆ', desc: 'å½¢ä½“è‰ºæœ¯' },
                    { id: 'acting', name: 'è¡¨æ¼”', desc: 'æ¼”è‰ºäº‹ä¸š' }
                ]
            },
            sports: {
                name: 'è¿åŠ¨',
                skills: [
                    { id: 'swimming', name: 'æ¸¸æ³³', desc: 'æ°´ä¸Šè¿åŠ¨' },
                    { id: 'running', name: 'è·‘æ­¥', desc: 'æœ‰æ°§è¿åŠ¨' },
                    { id: 'fitness', name: 'å¥èº«', desc: 'åŠ›é‡è®­ç»ƒ' },
                    { id: 'martial', name: 'æ­¦æœ¯', desc: 'æ ¼æ–—æŠ€èƒ½' }
                ]
            },
            social: {
                name: 'ç¤¾äº¤',
                skills: [
                    { id: 'speech', name: 'æ¼”è®²', desc: 'å…¬ä¼—è¡¨è¾¾' },
                    { id: 'negotiation', name: 'è°ˆåˆ¤', desc: 'å•†åŠ¡æŠ€èƒ½' },
                    { id: 'psychology', name: 'å¿ƒç†å­¦', desc: 'æ´å¯Ÿäººå¿ƒ' }
                ]
            }
        };

        // èŒä¸šæ•°æ®åº“ï¼ˆå¢åŠ å¹´é¾„é™åˆ¶ï¼‰
        const careersDB = {
            student: {
                name: 'å­¦ç”Ÿ',
                levels: ['å¹¼å„¿å›­', 'å°å­¦ç”Ÿ', 'åˆä¸­ç”Ÿ', 'é«˜ä¸­ç”Ÿ', 'å¤§å­¦ç”Ÿ', 'ç ”ç©¶ç”Ÿ', 'åšå£«ç”Ÿ'],
                salaries: [0, 0, 0, 0, 0, 0, 0],
                requirements: { intelligence: 0 },
                minAge: 3,
                maxAge: 35
            },
            worker: {
                name: 'æ‰“å·¥æ—',
                levels: ['å®ä¹ ç”Ÿ', 'æ™®é€šå‘˜å·¥', 'èµ„æ·±å‘˜å·¥', 'ä¸»ç®¡', 'ç»ç†', 'æ€»ç›‘', 'VP', 'CEO'],
                salaries: [2000, 3500, 5000, 8000, 15000, 30000, 60000, 150000],
                requirements: { intelligence: 30 },
                minAge: 16,
                maxAge: 65
            },
            programmer: {
                name: 'ç¨‹åºå‘˜',
                levels: ['åˆçº§ç¨‹åºå‘˜', 'ä¸­çº§ç¨‹åºå‘˜', 'é«˜çº§ç¨‹åºå‘˜', 'æ¶æ„å¸ˆ', 'æŠ€æœ¯æ€»ç›‘', 'CTO'],
                salaries: [5000, 10000, 20000, 40000, 80000, 200000],
                requirements: { programming: 3 },
                minAge: 18,
                maxAge: 50
            },
            doctor: {
                name: 'åŒ»ç”Ÿ',
                levels: ['å®ä¹ åŒ»ç”Ÿ', 'ä½é™¢åŒ»å¸ˆ', 'ä¸»æ²»åŒ»å¸ˆ', 'å‰¯ä¸»ä»»åŒ»å¸ˆ', 'ä¸»ä»»åŒ»å¸ˆ', 'é™¢é•¿'],
                salaries: [3000, 6000, 12000, 25000, 50000, 100000],
                requirements: { biology: 4, chemistry: 3 },
                minAge: 22,
                maxAge: 70
            },
            lawyer: {
                name: 'å¾‹å¸ˆ',
                levels: ['å®ä¹ å¾‹å¸ˆ', 'æ‰§ä¸šå¾‹å¸ˆ', 'èµ„æ·±å¾‹å¸ˆ', 'åˆä¼™äºº', 'å¾‹æ‰€ä¸»ä»»'],
                salaries: [4000, 10000, 25000, 60000, 150000],
                requirements: { literature: 3, speech: 2 },
                minAge: 21,
                maxAge: 70
            },
            artist: {
                name: 'è‰ºæœ¯å®¶',
                levels: ['è‰ºæœ¯æ–°äºº', 'å°ä¼—è‰ºæœ¯å®¶', 'çŸ¥åè‰ºæœ¯å®¶', 'è‰ºæœ¯å¤§å¸ˆ', 'ä¼ å¥‡è‰ºæœ¯å®¶'],
                salaries: [2000, 5000, 20000, 80000, 300000],
                requirements: { art: 3, music: 2 },
                minAge: 16,
                maxAge: 80
            },
            athlete: {
                name: 'è¿åŠ¨å‘˜',
                levels: ['ä¸šä½™é€‰æ‰‹', 'èŒä¸šé€‰æ‰‹', 'å›½å®¶é˜Ÿ', 'ä¸–ç•Œå† å†›', 'ä¼ å¥‡è¿åŠ¨å‘˜'],
                salaries: [3000, 10000, 30000, 100000, 500000],
                requirements: { fitness: 4, sports: 3 },
                minAge: 16,
                maxAge: 35
            },
            entrepreneur: {
                name: 'åˆ›ä¸šè€…',
                levels: ['åˆåˆ›è€…', 'å°ä¼ä¸šä¸»', 'ä¼ä¸šå®¶', 'å•†ä¸šå·¨å¤´', 'è¡Œä¸šé¢†è¢–'],
                salaries: [0, 10000, 50000, 200000, 1000000],
                requirements: { finance: 3, negotiation: 2 },
                minAge: 18,
                maxAge: 70
            },
            civil: {
                name: 'å…¬åŠ¡å‘˜',
                levels: ['ç§‘å‘˜', 'å‰¯ç§‘çº§', 'æ­£ç§‘çº§', 'å‰¯å¤„çº§', 'æ­£å¤„çº§', 'å‰¯å…çº§', 'æ­£å…çº§', 'çœéƒ¨çº§'],
                salaries: [4000, 5000, 7000, 10000, 15000, 25000, 40000, 80000],
                requirements: { intelligence: 40 },
                minAge: 18,
                maxAge: 60
            },
            freelancer: {
                name: 'è‡ªç”±èŒä¸šè€…',
                levels: ['æ–°æ‰‹', 'ç†Ÿæ‰‹', 'é«˜æ‰‹', 'ä¸“å®¶', 'å¤§ç¥'],
                salaries: [3000, 8000, 20000, 50000, 150000],
                requirements: {},
                minAge: 16,
                maxAge: 70
            }
        };

        // æˆå°±æ•°æ®åº“
        const achievementsDB = [
            { id: 'rich1', name: 'ä¸‡å…ƒæˆ·', desc: 'èµ„äº§è¾¾åˆ°1ä¸‡å…ƒ', icon: 'ğŸ’°', condition: (p) => p.money >= 10000 },
            { id: 'rich2', name: 'ç™¾ä¸‡å¯Œç¿', desc: 'èµ„äº§è¾¾åˆ°100ä¸‡å…ƒ', icon: 'ğŸ’', condition: (p) => p.money >= 1000000 },
            { id: 'rich3', name: 'äº¿ä¸‡å¯Œç¿', desc: 'èµ„äº§è¾¾åˆ°1äº¿å…ƒ', icon: 'ğŸ‘‘', condition: (p) => p.money >= 100000000 },
            { id: 'smart1', name: 'å°å­¦éœ¸', desc: 'æ™ºåŠ›è¾¾åˆ°70', icon: 'ğŸ“š', condition: (p) => p.intelligence >= 70 },
            { id: 'smart2', name: 'å¤©æ‰', desc: 'æ™ºåŠ›è¾¾åˆ°90', icon: 'ğŸ§ ', condition: (p) => p.intelligence >= 90 },
            { id: 'smart3', name: 'ç»ä¸–å¤©æ‰', desc: 'æ™ºåŠ›è¾¾åˆ°100', icon: 'ğŸ”®', condition: (p) => p.intelligence >= 100 },
            { id: 'healthy1', name: 'å¥åº·è¾¾äºº', desc: 'å¥åº·ä¿æŒ90ä»¥ä¸Šåˆ°60å²', icon: 'ğŸ’ª', condition: (p, g) => p.age >= 60 && p.health >= 90 },
            { id: 'happy1', name: 'å¿«ä¹äººç”Ÿ', desc: 'å¿«ä¹ä¿æŒ90ä»¥ä¸Šåˆ°50å²', icon: 'ğŸ˜Š', condition: (p, g) => p.age >= 50 && p.happiness >= 90 },
            { id: 'longlife1', name: 'é•¿å¯¿è€äºº', desc: 'æ´»åˆ°80å²', icon: 'ğŸ‘´', condition: (p, g) => p.age >= 80 },
            { id: 'longlife2', name: 'äººç‘', desc: 'æ´»åˆ°100å²', icon: 'ğŸ‚', condition: (p, g) => p.age >= 100 },
            { id: 'social1', name: 'ç¤¾äº¤è¾¾äºº', desc: 'æ‹¥æœ‰10ä¸ªæœ‹å‹', icon: 'ğŸ‘¥', condition: (p, g) => g.relations.filter(r => r.type === 'æœ‹å‹').length >= 10 },
            { id: 'love1', name: 'åˆæ‹', desc: 'ç»å†ç¬¬ä¸€æ¬¡æ‹çˆ±', icon: 'ğŸ’•', condition: (p, g) => g.history.some(h => h.includes('æ‹çˆ±')) },
            { id: 'marry1', name: 'æ–°å©šå¿«ä¹', desc: 'ç»“å©š', icon: 'ğŸ’’', condition: (p, g) => g.relations.some(r => r.type === 'é…å¶') },
            { id: 'parent1', name: 'ä¸ºäººçˆ¶æ¯', desc: 'æ‹¥æœ‰å­©å­', icon: 'ğŸ‘¶', condition: (p, g) => g.relations.some(r => r.type === 'å­å¥³') },
            { id: 'career1', name: 'èŒåœºæ–°äºº', desc: 'è·å¾—ç¬¬ä¸€ä»½å·¥ä½œ', icon: 'ğŸ’¼', condition: (p, g) => p.job !== null },
            { id: 'career2', name: 'èŒåœºç²¾è‹±', desc: 'æˆä¸ºç»ç†', icon: 'â­', condition: (p, g) => p.job && p.job.level >= 4 },
            { id: 'career3', name: 'è¡Œä¸šé¢†è¢–', desc: 'æˆä¸ºCEO/æ€»ç›‘', icon: 'ğŸ†', condition: (p, g) => p.job && p.job.level >= 6 },
            { id: 'edu1', name: 'å¤§å­¦ç”Ÿ', desc: 'è€ƒä¸Šå¤§å­¦', icon: 'ğŸ“', condition: (p, g) => p.education.includes('å¤§å­¦') },
            { id: 'edu2', name: 'ç¡•å£«', desc: 'è·å¾—ç¡•å£«å­¦ä½', icon: 'ğŸ“œ', condition: (p, g) => p.education.includes('ç ”ç©¶ç”Ÿ') },
            { id: 'edu3', name: 'åšå£«', desc: 'è·å¾—åšå£«å­¦ä½', icon: 'ğŸ”¬', condition: (p, g) => p.education.includes('åšå£«') },
            { id: 'travel1', name: 'æ—…è¡Œå®¶', desc: 'å»è¿‡5ä¸ªå›½å®¶', icon: 'âœˆï¸', condition: (p, g) => g.player.travelCount >= 5 },
            { id: 'skill1', name: 'å¤šæ‰å¤šè‰º', desc: 'æŒæ¡5ä¸ªæŠ€èƒ½', icon: 'ğŸ¯', condition: (p, g) => Object.keys(p.skills).length >= 5 },
            { id: 'skill2', name: 'æŠ€èƒ½å¤§å¸ˆ', desc: 'ä¸€ä¸ªæŠ€èƒ½è¾¾åˆ°æ»¡çº§', icon: 'ğŸ…', condition: (p, g) => Object.values(p.skills).some(s => s >= 5) },
            { id: 'prop1', name: 'æœ‰æˆ¿ä¸€æ—', desc: 'è´­ä¹°ç¬¬ä¸€å¥—æˆ¿å­', icon: 'ğŸ ', condition: (p, g) => p.properties.some(prop => prop.includes('æˆ¿')) },
            { id: 'prop2', name: 'è½¦ä¸»', desc: 'è´­ä¹°ç¬¬ä¸€è¾†è½¦', icon: 'ğŸš—', condition: (p, g) => p.properties.some(prop => prop.includes('è½¦')) },
            { id: 'prop3', name: 'æˆ¿äº§å¤§äº¨', desc: 'æ‹¥æœ‰3å¥—ä»¥ä¸Šæˆ¿äº§', icon: 'ğŸ˜ï¸', condition: (p, g) => p.properties.filter(prop => prop.includes('æˆ¿')).length >= 3 },
            { id: 'moral1', name: 'å¤§å–„äºº', desc: 'é“å¾·è¾¾åˆ°50', icon: 'ğŸ˜‡', condition: (p, g) => p.morality >= 50 },
            { id: 'moral2', name: 'æ¶äºº', desc: 'é“å¾·è¾¾åˆ°-50', icon: 'ğŸ˜ˆ', condition: (p, g) => p.morality <= -50 },
            { id: 'rep1', name: 'åäºº', desc: 'å£°æœ›è¾¾åˆ°80', icon: 'â­', condition: (p, g) => p.reputation >= 80 },
            { id: 'rep2', name: 'ä¼ å¥‡', desc: 'å£°æœ›è¾¾åˆ°100', icon: 'ğŸŒŸ', condition: (p, g) => p.reputation >= 100 },
            { id: 'lottery1', name: 'ä¸­å¥–ç»ç¼˜ä½“', desc: 'ä¹°å½©ç¥¨10æ¬¡ä¸ä¸­', icon: 'ğŸ°', condition: (p, g) => g.lotteryLoseCount >= 10 },
            { id: 'lottery2', name: 'å¤©é€‰ä¹‹å­', desc: 'ä¸­å½©ç¥¨å¤§å¥–', icon: 'ğŸ€', condition: (p, g) => g.lotteryWinBig },
            { id: 'accident1', name: 'å‘½å¤§', desc: 'é­é‡3æ¬¡äº‹æ•…å­˜æ´»', icon: 'ğŸš‘', condition: (p, g) => g.accidentCount >= 3 },
            { id: 'invest1', name: 'æŠ•èµ„è¾¾äºº', desc: 'æŠ•èµ„æ”¶ç›Šè¶…è¿‡10ä¸‡', icon: 'ğŸ“ˆ', condition: (p, g) => g.investProfit >= 100000 },
            { id: 'food1', name: 'ç¾é£Ÿå®¶', desc: 'å“å°50ç§ç¾é£Ÿ', icon: 'ğŸœ', condition: (p, g) => g.foodCount >= 50 },
            { id: 'read1', name: 'ä¹¦è™«', desc: 'é˜…è¯»100æœ¬ä¹¦', icon: 'ğŸ“–', condition: (p, g) => g.bookCount >= 100 },
            { id: 'sport1', name: 'è¿åŠ¨å¥å°†', desc: 'åšæŒè¿åŠ¨100æ¬¡', icon: 'ğŸƒ', condition: (p, g) => g.exerciseCount >= 100 },
            { id: 'game1', name: 'æ¸¸æˆç©å®¶', desc: 'ç©æ¸¸æˆ50æ¬¡', icon: 'ğŸ®', condition: (p, g) => g.gameCount >= 50 },
            { id: 'music1', name: 'éŸ³ä¹å®¶', desc: 'éŸ³ä¹æŠ€èƒ½æ»¡çº§', icon: 'ğŸµ', condition: (p, g) => p.skills.music >= 5 },
            { id: 'art1', name: 'ç”»å®¶', desc: 'ç»˜ç”»æŠ€èƒ½æ»¡çº§', icon: 'ğŸ¨', condition: (p, g) => p.skills.art >= 5 },
            { id: 'code1', name: 'ä»£ç å¤§ç¥', desc: 'ç¼–ç¨‹æŠ€èƒ½æ»¡çº§', icon: 'ğŸ’»', condition: (p, g) => p.skills.programming >= 5 },
            { id: 'cook1', name: 'ç±³å…¶æ—å¨å¸ˆ', desc: 'çƒ¹é¥ªæŠ€èƒ½æ»¡çº§', icon: 'ğŸ‘¨â€ğŸ³', condition: (p, g) => p.skills.cooking >= 5 },
            { id: 'divorce1', name: 'ç¦»å©šäººå£«', desc: 'ç»å†ç¦»å©š', icon: 'ğŸ’”', condition: (p, g) => g.divorced },
            { id: 'richparent', name: 'å•ƒè€æ—', desc: '30å²è¿˜åœ¨èŠ±çˆ¶æ¯çš„é’±', icon: 'ğŸ¼', condition: (p, g) => p.age >= 30 && p.money < 1000 && !p.job },
            { id: 'hobo', name: 'æµæµªæ±‰', desc: 'å­˜æ¬¾ä¸º0ä¸”æ²¡æœ‰å·¥ä½œ', icon: 'ğŸšï¸', condition: (p, g) => p.money <= 0 && !p.job },
            { id: 'depression', name: 'æŠ‘éƒç—‡', desc: 'å¿«ä¹ä¸º0æŒç»­1å¹´', icon: 'ğŸ’Š', condition: (p, g) => g.depressionTime >= 12 },
            { id: 'worklife', name: 'å·¥ä½œç‹‚', desc: 'è¿ç»­å·¥ä½œä¸ä¼‘æ¯50æ¬¡', icon: 'ğŸ’¼', condition: (p, g) => g.workStreak >= 50 },
            { id: 'hermit', name: 'éšå£«', desc: '50å²æ²¡æœ‰æœ‹å‹', icon: 'ğŸ§˜', condition: (p, g) => p.age >= 50 && g.relations.filter(r => r.type === 'æœ‹å‹').length === 0 },
            { id: 'playboy', name: 'èŠ±èŠ±å…¬å­', desc: 'äº¤å¾€10ä¸ªæ‹äºº', icon: 'ğŸ’‹', condition: (p, g) => g.loverCount >= 10 },
            { id: 'virgin', name: 'å•èº«ç‹—', desc: '50å²æ²¡æœ‰æ‹çˆ±ç»å†', icon: 'ğŸ•', condition: (p, g) => p.age >= 50 && g.loverCount === 0 },
            { id: 'jackofall', name: 'ä¸‡é‡‘æ²¹', desc: 'æ‰€æœ‰æŠ€èƒ½è¾¾åˆ°3çº§', icon: 'ğŸ”§', condition: (p, g) => Object.values(p.skills).length >= 10 && Object.values(p.skills).every(s => s >= 3) },
            { id: 'masterofone', name: 'ä¸“ç²¾ä¸€é¡¹', desc: 'ä¸€ä¸ªæŠ€èƒ½è¾¾åˆ°5çº§', icon: 'ğŸ–ï¸', condition: (p, g) => Object.values(p.skills).some(s => s >= 5) },
            { id: 'balanced', name: 'å…¨é¢å‘å±•', desc: 'æ‰€æœ‰å±æ€§è¾¾åˆ°70', icon: 'âš–ï¸', condition: (p, g) => p.health >= 70 && p.happiness >= 70 && p.intelligence >= 70 && p.appearance >= 70 },
            { id: 'extreme', name: 'æç«¯äººç”Ÿ', desc: 'æŸä¸ªå±æ€§è¾¾åˆ°100æˆ–0', icon: 'âš¡', condition: (p, g) => p.health >= 100 || p.happiness >= 100 || p.intelligence >= 100 || p.appearance >= 100 || p.health <= 0 || p.happiness <= 0 },
            { id: 'rebirth', name: 'é‡ç”Ÿè€…', desc: 'æ¸¸æˆé€šå…³3æ¬¡', icon: 'ğŸ”„', condition: (p, g) => g.rebirthCount >= 3 },
            { id: 'speedrun', name: 'é€Ÿé€šç©å®¶', desc: '30å²å‰æˆä¸ºCEO', icon: 'â±ï¸', condition: (p, g) => p.age <= 30 && p.job && p.job.level >= 6 },
            { id: 'slowlife', name: 'æ…¢ç”Ÿæ´»', desc: '50å²è¿˜æ˜¯å­¦ç”Ÿ', icon: 'ğŸ¢', condition: (p, g) => p.age >= 50 && p.job && p.job.type === 'student' },
            { id: 'phoenix', name: 'å‡¤å‡°æ¶…æ§ƒ', desc: 'ä»ç ´äº§åˆ°ç™¾ä¸‡å¯Œç¿', icon: 'ğŸ”¥', condition: (p, g) => g.wasBankrupt && p.money >= 1000000 },
            { id: 'richest', name: 'ä¸–ç•Œé¦–å¯Œ', desc: 'èµ„äº§è¾¾åˆ°10äº¿', icon: 'ğŸ’', condition: (p, g) => p.money >= 1000000000 },
            { id: 'immortal', name: 'æ°¸ç”Ÿè€…', desc: 'æ´»åˆ°120å²', icon: 'ğŸ‘¼', condition: (p, g) => p.age >= 120 },
            { id: 'perfect', name: 'å®Œç¾äººç”Ÿ', desc: 'è§£é”æ‰€æœ‰æˆå°±', icon: 'ğŸ†', condition: (p, g) => g.achievements.length >= achievementsDB.length - 1 }
        ];

        // å•†åº—å•†å“
        const shopItems = [
            // æ¶ˆè€—å“
            { id: 'vitamin', name: 'ç»´ç”Ÿç´ ç‰‡', price: 50, effect: { health: 5 }, desc: 'åŸºç¡€è¥å…»è¡¥å……', category: 'consumable' },
            { id: 'energy_drink', name: 'èƒ½é‡é¥®æ–™', price: 30, effect: { energy: 20 }, desc: 'å¿«é€Ÿæ¢å¤ä½“åŠ›', category: 'consumable' },
            { id: 'medicine', name: 'é«˜çº§åŒ»ç–—åŒ…', price: 500, effect: { health: 30 }, desc: 'å…¨é¢æ¢å¤å¥åº·', category: 'consumable' },
            { id: 'psych_book', name: 'å¿ƒç†å­¦ä¹¦ç±', price: 100, effect: { happiness: 10, intelligence: 3 }, desc: 'æå‡å¿ƒæƒ…å’Œæ™ºæ…§', category: 'consumable' },
            { id: 'delicious_food', name: 'ç¾é£Ÿå¤§é¤', price: 200, effect: { happiness: 15, health: 5 }, desc: 'äº«å—ç¾é£Ÿ', category: 'consumable' },
            { id: 'spa', name: 'SPAæŒ‰æ‘©', price: 300, effect: { happiness: 10, health: 10, stress: -20 }, desc: 'æ”¾æ¾èº«å¿ƒ', category: 'consumable' },
            
            // æ•™è‚²
            { id: 'online_course', name: 'åœ¨çº¿è¯¾ç¨‹', price: 800, effect: { intelligence: 8 }, desc: 'æå‡æŠ€èƒ½', category: 'education' },
            { id: 'gym_card', name: 'å¥èº«å¡', price: 1500, effect: { health: 15, appearance: 5 }, desc: 'å¢å¼ºä½“è´¨', category: 'education' },
            { id: 'language_course', name: 'è¯­è¨€è¯¾ç¨‹', price: 1200, effect: { intelligence: 10 }, desc: 'å­¦ä¹ å¤–è¯­', category: 'education' },
            { id: 'cert_training', name: 'è€ƒè¯åŸ¹è®­', price: 3000, effect: { intelligence: 20 }, desc: 'èŒä¸šèµ„æ ¼è¯ä¹¦', category: 'education' },
            { id: 'master_class', name: 'å¤§å¸ˆç­', price: 10000, effect: { intelligence: 30, reputation: 10 }, desc: 'é¡¶çº§åŸ¹è®­', category: 'education' },
            
            // å¤–è§‚
            { id: 'fashion_clothes', name: 'æ—¶å°šæœè£…', price: 600, effect: { appearance: 8, happiness: 3 }, desc: 'æå‡é­…åŠ›', category: 'appearance' },
            { id: 'skincare', name: 'æŠ¤è‚¤å“å¥—è£…', price: 400, effect: { appearance: 5 }, desc: 'ä¿å…»çš®è‚¤', category: 'appearance' },
            { id: 'makeup', name: 'åŒ–å¦†å“', price: 800, effect: { appearance: 10 }, desc: 'ç²¾è‡´å¦†å®¹', category: 'appearance' },
            { id: 'luxury_watch', name: 'åè¡¨', price: 10000, effect: { appearance: 20, happiness: 5, reputation: 5 }, desc: 'å¥¢ä¾ˆå“', category: 'appearance' },
            { id: 'designer_bag', name: 'åç‰ŒåŒ…', price: 20000, effect: { appearance: 25, happiness: 10, reputation: 5 }, desc: 'æ—¶å°šå•å“', category: 'appearance' },
            
            // å¨±ä¹
            { id: 'game_console', name: 'æ¸¸æˆæœº', price: 2500, effect: { happiness: 20 }, desc: 'å¨±ä¹æ”¾æ¾', category: 'entertainment' },
            { id: 'movie_ticket', name: 'ç”µå½±ç¥¨', price: 80, effect: { happiness: 5 }, desc: 'è§‚å½±å¨±ä¹', category: 'entertainment' },
            { id: 'ktv', name: 'KTVåŒ…å¢', price: 400, effect: { happiness: 10 }, desc: 'å”±æ­Œæ”¾æ¾', category: 'entertainment' },
            { id: 'concert', name: 'æ¼”å”±ä¼šé—¨ç¥¨', price: 800, effect: { happiness: 15 }, desc: 'éŸ³ä¹ç››å®´', category: 'entertainment' },
            { id: 'theme_park', name: 'æ¸¸ä¹å›­', price: 500, effect: { happiness: 20 }, desc: 'æ¬¢ä¹æ—¶å…‰', category: 'entertainment' },
            
            // äº¤é€š
            { id: 'bicycle', name: 'è‡ªè¡Œè½¦', price: 500, effect: { health: 3, happiness: 2 }, desc: 'ç»¿è‰²å‡ºè¡Œ', permanent: true, category: 'property' },
            { id: 'ebike', name: 'ç”µåŠ¨è½¦', price: 3000, effect: { happiness: 5 }, desc: 'é€šå‹¤ä¾¿åˆ©', permanent: true, category: 'property' },
            { id: 'used_car', name: 'äºŒæ‰‹è½¦', price: 20000, effect: { happiness: 10, appearance: 5 }, desc: 'ä»£æ­¥å·¥å…·', permanent: true, category: 'property' },
            { id: 'new_car', name: 'æ–°è½¦', price: 100000, effect: { happiness: 20, appearance: 15, reputation: 5 }, desc: 'è±ªåè½¿è½¦', permanent: true, category: 'property' },
            { id: 'sports_car', name: 'è·‘è½¦', price: 500000, effect: { happiness: 30, appearance: 25, reputation: 15 }, desc: 'é€Ÿåº¦ä¸æ¿€æƒ…', permanent: true, category: 'property' },
            
            // æˆ¿äº§
            { id: 'rent', name: 'ç§Ÿæˆ¿é¦–ä»˜', price: 15000, effect: { happiness: 5 }, desc: 'å®‰èº«ä¹‹æ‰€', permanent: true, category: 'property' },
            { id: 'small_apartment', name: 'å°æˆ·å‹', price: 300000, effect: { happiness: 15, health: 5 }, desc: 'æ¸©é¦¨å°çª', permanent: true, category: 'property' },
            { id: 'apartment', name: 'å¤§å¹³å±‚', price: 800000, effect: { happiness: 25, health: 10, appearance: 10 }, desc: 'èˆ’é€‚ç”Ÿæ´»', permanent: true, category: 'property' },
            { id: 'villa', name: 'åˆ«å¢…', price: 3000000, effect: { happiness: 40, health: 15, appearance: 20, reputation: 10 }, desc: 'è±ªå®…', permanent: true, category: 'property' },
            { id: 'mansion', name: 'åº„å›­', price: 10000000, effect: { happiness: 50, health: 20, appearance: 30, reputation: 20 }, desc: 'é¡¶çº§è±ªå®…', permanent: true, category: 'property' },
            
            // æŠ•èµ„
            { id: 'stocks', name: 'è‚¡ç¥¨åŸºé‡‘', price: 10000, effect: {}, desc: 'é«˜é£é™©é«˜æ”¶ç›Š', risk: true, category: 'investment' },
            { id: 'bonds', name: 'å›½å€º', price: 20000, effect: {}, desc: 'ç¨³å¥ç†è´¢', safe: true, category: 'investment' },
            { id: 'bitcoin', name: 'æ¯”ç‰¹å¸', price: 50000, effect: {}, desc: 'è™šæ‹Ÿè´§å¸ï¼ˆæ³¢åŠ¨æå¤§ï¼‰', highRisk: true, category: 'investment' },
            { id: 'real_estate', name: 'æˆ¿åœ°äº§æŠ•èµ„', price: 100000, effect: {}, desc: 'é•¿æœŸæŒæœ‰', investment: true, category: 'investment' }
        ];

        // ==================== äº‹ä»¶æ•°æ®åº“ (500+äº‹ä»¶) ====================
        
        // å©´å„¿æœŸäº‹ä»¶ (0-3å²)
        const babyEvents = [
            { text: "ä½ å­¦ä¼šäº†çˆ¬è¡Œï¼Œå¼€å§‹æ¢ç´¢è¿™ä¸ªé™Œç”Ÿçš„ä¸–ç•Œã€‚", effect: { health: 1 } },
            { text: "ä½ é•¿å‡ºäº†ç¬¬ä¸€é¢—ç‰™ï¼Œå’¬äº†å¦ˆå¦ˆä¸€å£ã€‚", effect: { happiness: 2 } },
            { text: "ä½ ç¬¬ä¸€æ¬¡å«'å¦ˆå¦ˆ'ï¼Œæ¯äº²æ¿€åŠ¨å¾—çƒ­æ³ªç›ˆçœ¶ã€‚", effect: { happiness: 5 } },
            { text: "ä½ å­¦ä¼šäº†èµ°è·¯ï¼Œè™½ç„¶æ‘‡æ‘‡æ™ƒæ™ƒä½†å……æ»¡å¥½å¥‡ã€‚", effect: { health: 2, happiness: 3 } },
            { text: "ä½ ç”Ÿäº†ä¸€åœºå°ç—…ï¼Œçˆ¶æ¯å½»å¤œæœªçœ åœ°ç…§é¡¾ä½ ã€‚", effect: { health: -5, happiness: 3 } },
            { text: "ä½ ç¬¬ä¸€æ¬¡åƒè¾…é£Ÿï¼Œè¡¨æƒ…å¾ˆæ»‘ç¨½ã€‚", effect: { happiness: 2 } },
            { text: "ä½ åœ¨æ‘‡ç¯®é‡Œå¬å¦ˆå¦ˆå”±æ­Œï¼Œç¡å¾—å¾ˆé¦™ç”œã€‚", effect: { happiness: 3 } },
            { text: "ä½ æŠ“å‘¨æŠ“åˆ°äº†ä¸€æ”¯ç¬”ï¼Œçˆ¶æ¯å¸Œæœ›ä½ å°†æ¥æœ‰å‡ºæ¯ã€‚", effect: { intelligence: 2 } },
            { text: "ä½ ç¬¬ä¸€æ¬¡è¿‡ç”Ÿæ—¥ï¼Œæ”¶åˆ°äº†å¾ˆå¤šç©å…·ã€‚", effect: { happiness: 5 } },
            { text: "ä½ å¼€å§‹å­¦è¯´è¯ï¼Œè¯æ±‡é‡ä¸æ–­å¢åŠ ã€‚", effect: { intelligence: 3 } }
        ];

        // å¹¼å„¿æœŸäº‹ä»¶ (4-6å²)
        const toddlerEvents = [
            { text: "ä½ ä¸Šå¹¼å„¿å›­äº†ï¼Œç¬¬ä¸€å¤©å“­å¾—å¾ˆä¼¤å¿ƒã€‚", effect: { happiness: -3, intelligence: 2 } },
            { text: "ä½ åœ¨å¹¼å„¿å›­äº¤åˆ°äº†ç¬¬ä¸€ä¸ªæœ‹å‹ã€‚", effect: { happiness: 5 }, addRelation: { type: 'æœ‹å‹', closeness: 60 } },
            { text: "ä½ åœ¨å¹¼å„¿å›­ç”»ç”»æ¯”èµ›ä¸­è·å¾—ç¬¬ä¸€åã€‚", effect: { happiness: 5, intelligence: 2 } },
            { text: "ä½ ä¸å°å¿ƒå°¿è£¤å­äº†ï¼Œè§‰å¾—å¾ˆä¸¢è„¸ã€‚", effect: { happiness: -5 } },
            { text: "ä½ å­¦ä¼šäº†éª‘ä¸‰è½®è½¦ï¼Œå¾ˆæœ‰æˆå°±æ„Ÿã€‚", effect: { happiness: 5, health: 1 } },
            { text: "ä½ è¿·ä¸Šäº†çœ‹åŠ¨ç”»ç‰‡ï¼Œæ¯å¤©éƒ½æƒ³çœ‹ã€‚", effect: { happiness: 3, intelligence: -1 } },
            { text: "ä½ å¼€å§‹å­¦æ‹¼éŸ³ï¼Œè§‰å¾—å¾ˆæœ‰è¶£ã€‚", effect: { intelligence: 3 } },
            { text: "ä½ åœ¨å¹¼å„¿å›­è¡¨æ¼”èŠ‚ç›®ï¼Œè¡¨ç°å¾—å¾ˆæ£’ã€‚", effect: { happiness: 5, appearance: 2 } },
            { text: "ä½ å’Œå°æœ‹å‹æ‰“æ¶äº†ï¼Œè¢«è€å¸ˆæ‰¹è¯„ã€‚", effect: { happiness: -3, morality: -2 } },
            { text: "ä½ å­¦ä¼šäº†åˆ†äº«ç©å…·ï¼Œå¦ˆå¦ˆè¡¨æ‰¬äº†ä½ ã€‚", effect: { happiness: 3, morality: 3 } },
            { text: "ä½ ç¬¬ä¸€æ¬¡è‡ªå·±ç©¿è¡£æœï¼Œè™½ç„¶å¾ˆæ…¢ä½†æˆåŠŸäº†ã€‚", effect: { happiness: 4, intelligence: 1 } },
            { text: "ä½ åœ¨å…¬å›­ç©æ»‘æ¢¯ï¼Œç©å¾—å¾ˆå¼€å¿ƒã€‚", effect: { happiness: 5, health: 1 } },
            { text: "ä½ å¼€å§‹å­¦ç®€å•çš„ç®—æœ¯ï¼Œ1+1=2ã€‚", effect: { intelligence: 3 } },
            { text: "ä½ å…»äº†ä¸€åªå°é‡‘é±¼ï¼Œå­¦ä¼šäº†ç…§é¡¾ç”Ÿå‘½ã€‚", effect: { happiness: 3, morality: 2 } },
            { text: "ä½ åœ¨å¹¼å„¿å›­åˆç¡æ—¶ç¡ä¸ç€ï¼Œå·å·ç©æ‰‹æŒ‡ã€‚", effect: { energy: -5 } }
        ];

        // ç«¥å¹´æœŸäº‹ä»¶ (7-12å²)
        const childhoodEvents = [
            { text: "ä½ ä¸Šå°å­¦äº†ï¼ŒèƒŒç€å´­æ–°çš„ä¹¦åŒ…ï¼Œå……æ»¡æ†§æ†¬ã€‚", effect: { intelligence: 5, happiness: 3 } },
            { text: "å…¥å­¦ç¬¬ä¸€å¤©ï¼Œä½ å› ä¸ºç´§å¼ åœ¨è¯¾å ‚ä¸Šè¯´ä¸å‡ºè¯ã€‚", effect: { happiness: -3, stress: 5 } },
            { text: "ä½ è€ƒè¯•å¾—äº†æ»¡åˆ†ï¼Œè€å¸ˆè¡¨æ‰¬äº†ä½ ã€‚", effect: { happiness: 8, intelligence: 2, reputation: 3 } },
            { text: "ä½ è€ƒè¯•ä¸åŠæ ¼ï¼Œè¢«çˆ¶æ¯æ‰¹è¯„äº†ã€‚", effect: { happiness: -5, stress: 10 } },
            { text: "ä½ å‚åŠ äº†å­¦æ ¡çš„è¿åŠ¨ä¼šï¼Œè·‘äº†ç¬¬ä¸€åã€‚", effect: { happiness: 5, health: 3, reputation: 3 } },
            { text: "ä½ åœ¨å­¦æ ¡è¢«åŒå­¦æ¬ºè´Ÿäº†ï¼Œå¾ˆéš¾è¿‡ã€‚", effect: { happiness: -8, health: -3, stress: 10 } },
            { text: "ä½ äº¤åˆ°äº†ä¸€ä¸ªå¥½æœ‹å‹ï¼Œæ¯å¤©ä¸€èµ·ä¸Šå­¦æ”¾å­¦ã€‚", effect: { happiness: 5 }, addRelation: { type: 'æœ‹å‹', closeness: 70 } },
            { text: "ä½ å¼€å§‹å­¦é’¢ç´ï¼Œå‘ç°å¾ˆå–œæ¬¢éŸ³ä¹ã€‚", effect: { happiness: 3 }, skillGain: 'music' },
            { text: "ä½ å‚åŠ äº†ç»˜ç”»å…´è¶£ç­ï¼Œç”»äº†ä¸€å¹…æ¼‚äº®çš„ç”»ã€‚", effect: { happiness: 4 }, skillGain: 'art' },
            { text: "ä½ è¿·ä¸Šäº†ç”µå­æ¸¸æˆï¼Œç»å¸¸å·å·ç©ã€‚", effect: { happiness: 5, intelligence: -2, health: -2 } },
            { text: "ä½ è¯»äº†ä¸€æœ¬å¾ˆæœ‰è¶£çš„è¯¾å¤–ä¹¦ã€‚", effect: { happiness: 3, intelligence: 2 }, book: true },
            { text: "ä½ å’Œçˆ¶æ¯å»äº†ä¸€æ¬¡éš¾å¿˜çš„æ—…è¡Œã€‚", effect: { happiness: 10, intelligence: 2 }, travel: true },
            { text: "ä½ å­¦ä¼šäº†æ¸¸æ³³ï¼Œå¾ˆæœ‰æˆå°±æ„Ÿã€‚", effect: { happiness: 5, health: 3 }, skillGain: 'swimming' },
            { text: "ä½ åœ¨ç­çº§ç«é€‰ç­å¹²éƒ¨ï¼ŒæˆåŠŸå½“é€‰ã€‚", effect: { happiness: 5, reputation: 5 } },
            { text: "ä½ å› ä¸ºå¿˜å¸¦ä½œä¸šè¢«è€å¸ˆç½šç«™ã€‚", effect: { happiness: -3, stress: 5 } },
            { text: "ä½ åœ¨å­¦æ ¡é£Ÿå ‚åƒåˆ°äº†å¾ˆéš¾åƒçš„èœã€‚", effect: { happiness: -2 } },
            { text: "ä½ çš„ä½œæ–‡è¢«è€å¸ˆå½“ä½œèŒƒæ–‡æœ—è¯»ã€‚", effect: { happiness: 6, reputation: 5 } },
            { text: "ä½ å¼€å§‹å­¦éª‘è‡ªè¡Œè½¦ï¼Œæ‘”äº†å‡ æ¬¡ç»ˆäºå­¦ä¼šäº†ã€‚", effect: { happiness: 5, health: 1 } },
            { text: "ä½ å…»äº†ä¸€åªå°ç‹—ï¼Œæˆä¸ºäº†æœ€å¥½çš„æœ‹å‹ã€‚", effect: { happiness: 8, morality: 3 } },
            { text: "ä½ åœ¨å­¦æ ¡æ–‡è‰ºæ±‡æ¼”ä¸­è¡¨æ¼”äº†èŠ‚ç›®ã€‚", effect: { happiness: 5, appearance: 2 } },
            { text: "ä½ å› ä¸ºä¸Šè¯¾è¯´è¯è¢«è€å¸ˆç‚¹åæ‰¹è¯„ã€‚", effect: { happiness: -3 } },
            { text: "ä½ å‚åŠ äº†æ•°å­¦ç«èµ›ï¼Œè·å¾—äº†ä¸‰ç­‰å¥–ã€‚", effect: { happiness: 6, intelligence: 3, reputation: 5 } },
            { text: "ä½ å¼€å§‹å­¦ä¹¦æ³•ï¼Œå­—å†™å¾—è¶Šæ¥è¶Šæ¼‚äº®ã€‚", effect: { happiness: 3, intelligence: 1 } },
            { text: "ä½ å’ŒåŒå­¦ä¸€èµ·å»éƒŠæ¸¸ï¼Œç©å¾—å¾ˆå¼€å¿ƒã€‚", effect: { happiness: 8, health: 2 } },
            { text: "ä½ ç¬¬ä¸€æ¬¡è‡ªå·±åšé¥­ï¼Œè™½ç„¶å¾ˆç®€å•ä½†å¾ˆæœ‰æˆå°±æ„Ÿã€‚", effect: { happiness: 4 }, skillGain: 'cooking' }
        ];

        // é’æ˜¥æœŸäº‹ä»¶ (13-18å²)
        const teenEvents = [
            { text: "ä½ è¿›å…¥äº†é’æ˜¥æœŸï¼Œè„¸ä¸Šå¼€å§‹é•¿ç—˜ç—˜ã€‚", effect: { appearance: -5, happiness: -3 } },
            { text: "ä½ çš„å£°éŸ³å¼€å§‹å˜ç²—ï¼Œè¿›å…¥äº†å˜å£°æœŸã€‚", effect: { appearance: 2 } },
            { text: "ä½ è€ƒä¸Šäº†ç†æƒ³çš„åˆä¸­ï¼Œçˆ¶æ¯ä¸ºä½ æ„Ÿåˆ°éª„å‚²ã€‚", effect: { happiness: 8, intelligence: 3, reputation: 5 } },
            { text: "ä½ ç»å†äº†åˆæ‹ï¼Œè™½ç„¶é’æ¶©ä½†ç¾å¥½ã€‚", effect: { happiness: 10, appearance: 3 }, addRelation: { type: 'æ‹äºº', closeness: 80 }, love: true },
            { text: "ä½ è¡¨ç™½è¢«æ‹’ç»äº†ï¼Œæ„Ÿåˆ°å¾ˆæ²®ä¸§ã€‚", effect: { happiness: -10, stress: 15 } },
            { text: "ä¸­è€ƒå‹åŠ›å¤§ï¼Œä½ ç»å¸¸ç†¬å¤œå­¦ä¹ ã€‚", effect: { intelligence: 5, health: -5, stress: 15, energy: -20 } },
            { text: "ä½ è€ƒä¸Šäº†é‡ç‚¹é«˜ä¸­ï¼Œå¼€å¯äº†æ–°çš„ç¯‡ç« ã€‚", effect: { happiness: 10, intelligence: 5, reputation: 8 } },
            { text: "ä½ å¼€å§‹å…³æ³¨è‡ªå·±çš„å¤–è¡¨ï¼Œä¹°äº†å¾ˆå¤šæŠ¤è‚¤å“ã€‚", effect: { appearance: 5, money: -200 } },
            { text: "ä½ åŠ å…¥äº†å­¦æ ¡çš„ç¯®çƒé˜Ÿï¼Œæ¯å¤©è®­ç»ƒã€‚", effect: { health: 5, happiness: 3, energy: -10 }, skillGain: 'sports' },
            { text: "ä½ å¼€å§‹è¿½æ˜Ÿï¼Œæˆ¿é—´é‡Œè´´æ»¡äº†æµ·æŠ¥ã€‚", effect: { happiness: 5, money: -100 } },
            { text: "ä½ å’Œçˆ¶æ¯å‘ç”Ÿäº†æ¿€çƒˆçš„äº‰åµï¼Œå…³äºä½ çš„æœªæ¥ã€‚", effect: { happiness: -5, stress: 10 } },
            { text: "ä½ ç¬¬ä¸€æ¬¡æ‰“å·¥ï¼Œä½“éªŒäº†èµšé’±çš„è¾›è‹¦ã€‚", effect: { money: 500, happiness: 3, stress: 5 } },
            { text: "ä½ å‚åŠ äº†é«˜è€ƒï¼Œè¿™æ˜¯äººç”Ÿçš„é‡è¦è½¬æŠ˜ç‚¹ã€‚", effect: { stress: 20 }, choice: {
                title: "é«˜è€ƒåçš„é€‰æ‹©",
                desc: "é«˜è€ƒç»“æŸäº†ï¼Œä½ é¢ä¸´äººç”Ÿçš„é‡è¦é€‰æ‹©ï¼š",
                options: [
                    { text: "å…¨åŠ›ä»¥èµ´æŠ¥è€ƒåæ ¡", effect: { intelligence: 15, health: -5, money: -2000, stress: 10 } },
                    { text: "é€‰æ‹©æ™®é€šå¤§å­¦è½»æ¾åº¦è¿‡", effect: { happiness: 5, intelligence: 3 } },
                    { text: "æ”¾å¼ƒå­¦ä¸šç›´æ¥å·¥ä½œ", effect: { money: 3000, intelligence: -5, job: 'worker', level: 0 } }
                ]
            }},
            { text: "ä½ è€ƒä¸Šäº†ç†æƒ³çš„å¤§å­¦ï¼", effect: { happiness: 15, intelligence: 5, reputation: 10 }, education: 'å¤§å­¦ç”Ÿ' },
            { text: "ä½ å¼€å§‹å­¦ç¼–ç¨‹ï¼Œå‘ç°å¾ˆæœ‰è¶£ã€‚", effect: { happiness: 3, intelligence: 3 }, skillGain: 'programming' },
            { text: "ä½ å‚åŠ äº†ä¸€ä¸ªç¤¾å›¢ï¼Œè®¤è¯†äº†å¾ˆå¤šå¿—åŒé“åˆçš„æœ‹å‹ã€‚", effect: { happiness: 5 }, addRelation: { type: 'æœ‹å‹', closeness: 60 } },
            { text: "ä½ å¼€å§‹å°è¯•å†™ä½œï¼Œåœ¨ç½‘ä¸Šå‘è¡¨æ–‡ç« ã€‚", effect: { happiness: 4, intelligence: 2 } },
            { text: "ä½ å› ä¸ºæ²‰è¿·æ¸¸æˆæˆç»©ä¸‹æ»‘ã€‚", effect: { intelligence: -5, happiness: 5, stress: 5 } },
            { text: "ä½ å‚åŠ äº†ä¸€æ¬¡å¿—æ„¿è€…æ´»åŠ¨ï¼Œå¸®åŠ©äº†éœ€è¦å¸®åŠ©çš„äººã€‚", effect: { happiness: 8, morality: 5, reputation: 3 } },
            { text: "ä½ å¼€å§‹å…³æ³¨æ—¶å°šï¼Œç©¿æ­è¶Šæ¥è¶Šæœ‰å“å‘³ã€‚", effect: { appearance: 5, money: -300 } },
            { text: "ä½ å’Œåˆæ‹åˆ†æ‰‹äº†ï¼Œå¾ˆéš¾è¿‡ã€‚", effect: { happiness: -15, stress: 15 }, breakup: true },
            { text: "ä½ åœ¨å­¦æ ¡è¾©è®ºèµ›ä¸­è¡¨ç°å‡ºè‰²ã€‚", effect: { happiness: 5, intelligence: 2, reputation: 3 }, skillGain: 'speech' },
            { text: "ä½ å¼€å§‹å¥èº«ï¼Œèº«æè¶Šæ¥è¶Šå¥½ã€‚", effect: { health: 5, appearance: 5, energy: -10 }, skillGain: 'fitness' },
            { text: "ä½ å‚åŠ äº†ä¸€æ¬¡é‡è¦çš„æ¯”èµ›ï¼Œè·å¾—äº†å¥–é¡¹ã€‚", effect: { happiness: 10, reputation: 10 } },
            { text: "ä½ å¼€å§‹å­¦ä¹ ç†è´¢ï¼Œç®¡ç†è‡ªå·±çš„ç”Ÿæ´»è´¹ã€‚", effect: { intelligence: 2 }, skillGain: 'finance' },
            { text: "ä½ å’Œå®¤å‹å‘ç”Ÿäº†çŸ›ç›¾ï¼Œå®¿èˆæ°”æ°›å¾ˆå°´å°¬ã€‚", effect: { happiness: -5, stress: 5 } },
            { text: "ä½ å¼€å§‹å®ä¹ ï¼Œä½“éªŒäº†èŒåœºç”Ÿæ´»ã€‚", effect: { money: 2000, happiness: 3, stress: 5, intelligence: 3 } },
            { text: "ä½ å‚åŠ äº†ä¸€æ¬¡éš¾å¿˜çš„æ¯•ä¸šæ—…è¡Œã€‚", effect: { happiness: 10, intelligence: 2 }, travel: true },
            { text: "ä½ å¼€å§‹æ€è€ƒäººç”Ÿçš„æ„ä¹‰ï¼Œæ„Ÿåˆ°å¾ˆè¿·èŒ«ã€‚", effect: { happiness: -3, intelligence: 2, stress: 5 } },
            { text: "ä½ å†³å®šè€ƒç ”ï¼Œå¼€å§‹äº†è‰°è‹¦çš„å¤‡è€ƒã€‚", effect: { intelligence: 10, health: -3, stress: 15, energy: -15 } },
            { text: "ä½ å†³å®šæ¯•ä¸šåç›´æ¥å·¥ä½œã€‚", effect: { money: 5000, happiness: 5 }, job: 'worker', level: 0 }
        ];

        // é’å¹´æœŸäº‹ä»¶ (19-30å²)
        const youngAdultEvents = [
            { text: "ä½ å¤§å­¦æ¯•ä¸šäº†ï¼Œæ­£å¼è¸å…¥ç¤¾ä¼šã€‚", effect: { happiness: 5, stress: 5 }, education: 'æœ¬ç§‘' },
            { text: "ä½ æ‰¾åˆ°äº†ç¬¬ä¸€ä»½å·¥ä½œï¼Œè™½ç„¶å·¥èµ„ä¸é«˜ä½†å¾ˆå…´å¥‹ã€‚", effect: { money: 3000, happiness: 5, stress: 5 }, job: 'worker', level: 0 },
            { text: "ä½ åœ¨å·¥ä½œä¸­çŠ¯äº†ä¸€ä¸ªå¤§é”™ï¼Œè¢«é¢†å¯¼æ‰¹è¯„ã€‚", effect: { happiness: -5, stress: 10, reputation: -3 } },
            { text: "ä½ å› ä¸ºå·¥ä½œå‡ºè‰²å¾—åˆ°äº†æ™‹å‡ã€‚", effect: { happiness: 8, reputation: 5, money: 5000 }, promotion: true },
            { text: "ä½ å¼€å§‹äº†ä¸€æ®µæ–°çš„æ‹æƒ…ã€‚", effect: { happiness: 10 }, addRelation: { type: 'æ‹äºº', closeness: 80 }, love: true },
            { text: "ä½ å’Œæ‹äººåŒå±…äº†ï¼Œå¼€å§‹äº†æ–°ç”Ÿæ´»ã€‚", effect: { happiness: 5, money: -1000 } },
            { text: "ä½ å‘æ‹äººæ±‚å©šäº†ï¼", effect: { happiness: 15 }, choice: {
                title: "æ±‚å©š",
                desc: "ä½ å•è†è·ªåœ°ï¼Œæ‹¿å‡ºäº†æˆ’æŒ‡...",
                options: [
                    { text: "ä¹°æ˜‚è´µçš„é’»æˆ’æ±‚å©š", effect: { happiness: 10, money: -20000 } },
                    { text: "ä¹°æ™®é€šçš„æˆ’æŒ‡æ±‚å©š", effect: { happiness: 5, money: -3000 } },
                    { text: "ç”¨åˆ›æ„æ–¹å¼æ±‚å©š", effect: { happiness: 8, intelligence: 2, money: -500 } }
                ]
            }},
            { text: "ä½ ä»¬ç»“å©šäº†ï¼å©šç¤¼ä¸Šä½ ä»¬äº¤æ¢äº†èª“è¨€ã€‚", effect: { happiness: 20, money: -50000 }, marry: true },
            { text: "ä½ ä»¬æœ‰äº†å­©å­ï¼Œç”Ÿæ´»å˜å¾—æ›´åŠ å¿™ç¢Œä½†ä¹Ÿå……å®ã€‚", effect: { happiness: 15, health: -3, money: -8000, stress: 10 }, addRelation: { type: 'å­å¥³', closeness: 90 }, baby: true },
            { text: "ä½ å†³å®šè·³æ§½åˆ°å¦ä¸€å®¶å…¬å¸ï¼Œè–ªèµ„æ¶¨äº†ä¸å°‘ã€‚", effect: { money: 8000, happiness: 5, stress: 5 } },
            { text: "ä½ å¼€å§‹åˆ›ä¸šï¼ŒæŠ•å…¥äº†å¤§é‡èµ„é‡‘ã€‚", effect: { money: -50000, happiness: 5, stress: 20 }, job: 'entrepreneur', level: 0 },
            { text: "ä½ çš„åˆ›ä¸šé¡¹ç›®è·å¾—äº†æŠ•èµ„ï¼", effect: { money: 200000, happiness: 15, reputation: 15 } },
            { text: "ä½ çš„åˆ›ä¸šå¤±è´¥äº†ï¼ŒæŸå¤±äº†å¾ˆå¤šé’±ã€‚", effect: { money: -100000, happiness: -15, stress: 20 } },
            { text: "ä½ ä¹°äº†ä¸€å¥—å°æˆ¿å­ï¼Œç»ˆäºæœ‰äº†å±äºè‡ªå·±çš„å®¶ã€‚", effect: { happiness: 15, money: -300000 }, property: 'å°æˆ·å‹' },
            { text: "ä½ ä¹°äº†ä¸€è¾†è½¦ï¼Œå‡ºè¡Œæ–¹ä¾¿äº†å¾ˆå¤šã€‚", effect: { happiness: 10, money: -100000 }, property: 'æ–°è½¦' },
            { text: "ä½ å¼€å§‹æŠ•èµ„è‚¡ç¥¨ï¼Œå°èµšäº†ä¸€ç¬”ã€‚", effect: { money: 10000, happiness: 5 }, invest: true },
            { text: "ä½ æŠ•èµ„è‚¡ç¥¨äºæŸäº†ï¼Œå¿ƒæƒ…å¾ˆç³Ÿç³•ã€‚", effect: { money: -20000, happiness: -8, stress: 10 } },
            { text: "ä½ è¢«å…¬å¸è£å‘˜äº†ï¼Œæ­£åœ¨æ‰¾å·¥ä½œã€‚", effect: { happiness: -10, stress: 15, money: -5000 }, job: null },
            { text: "ä½ å¾ˆå¿«æ‰¾åˆ°äº†æ–°å·¥ä½œï¼Œè€Œä¸”è–ªèµ„æ›´é«˜ã€‚", effect: { money: 10000, happiness: 10, stress: -5 } },
            { text: "ä½ å¼€å§‹æ”»è¯»ç¡•å£«å­¦ä½ï¼Œè¾¹å·¥ä½œè¾¹å­¦ä¹ ã€‚", effect: { intelligence: 10, health: -3, stress: 15, money: -20000 }, education: 'ç ”ç©¶ç”Ÿ' },
            { text: "ä½ å’Œé…å¶å› ä¸ºçäº‹åµæ¶ï¼Œæ„Ÿæƒ…å‡ºç°äº†è£‚ç—•ã€‚", effect: { happiness: -5, stress: 5 } },
            { text: "ä½ ä»¬å†³å®šç¦»å©šï¼Œç»“æŸäº†è¿™æ®µå©šå§»ã€‚", effect: { happiness: -20, stress: 20, money: -50000 }, divorce: true },
            { text: "ä½ å¼€å§‹å¥èº«ï¼Œèº«ä½“çŠ¶å†µè¶Šæ¥è¶Šå¥½ã€‚", effect: { health: 8, appearance: 5, happiness: 5 } },
            { text: "ä½ å‚åŠ äº†ä¸€æ¬¡è¡Œä¸šå¤§ä¼šï¼Œè®¤è¯†äº†å¾ˆå¤šä¸šå†…äººå£«ã€‚", effect: { reputation: 10, happiness: 3 } },
            { text: "ä½ åœ¨å·¥ä½œä¸­é‡åˆ°äº†ä¸€ä¸ªå¾ˆéš¾ç¼ çš„å®¢æˆ·ã€‚", effect: { stress: 10, happiness: -3 } },
            { text: "ä½ æˆåŠŸå®Œæˆäº†ä¸€ä¸ªé‡è¦é¡¹ç›®ï¼Œå¾—åˆ°äº†è€æ¿çš„èµè¯†ã€‚", effect: { happiness: 10, reputation: 10, money: 10000 } },
            { text: "ä½ å¼€å§‹å­¦ä¹ ä¸€é—¨æ–°çš„æŠ€èƒ½ï¼Œæå‡è‡ªæˆ‘ã€‚", effect: { intelligence: 5, happiness: 3, money: -2000 } },
            { text: "ä½ å‚åŠ äº†ä¸€æ¬¡åŒå­¦èšä¼šï¼Œå‘ç°å¤§å®¶éƒ½æ··å¾—ä¸é”™ã€‚", effect: { happiness: 3, stress: 3 } },
            { text: "ä½ çš„çˆ¶æ¯å¼€å§‹å‚¬ä½ è¦å­©å­ã€‚", effect: { stress: 5 } },
            { text: "ä½ å¸¦å­©å­å»äº†ä¸€æ¬¡éš¾å¿˜çš„æ—…è¡Œã€‚", effect: { happiness: 10, money: -3000 }, travel: true },
            { text: "ä½ å¼€å§‹å…³æ³¨å¥åº·ï¼Œæˆ’æ‰äº†ç†¬å¤œçš„ä¹ æƒ¯ã€‚", effect: { health: 5, happiness: 2 } },
            { text: "ä½ åœ¨ç½‘ä¸Šä¹°äº†ä¸€å †æ²¡ç”¨çš„ä¸œè¥¿ï¼Œåæ‚”ä¸å·²ã€‚", effect: { happiness: -3, money: -2000 } },
            { text: "ä½ å¼€å§‹å…»æ¤ç‰©ï¼Œå®¶é‡Œå……æ»¡äº†ç”Ÿæœºã€‚", effect: { happiness: 3 } },
            { text: "ä½ å‚åŠ äº†ä¸€æ¬¡é©¬æ‹‰æ¾æ¯”èµ›ï¼Œå®Œæˆäº†å…¨ç¨‹ã€‚", effect: { health: 5, happiness: 10, reputation: 3 } },
            { text: "ä½ å¼€å§‹å†™åšå®¢ï¼Œåˆ†äº«è‡ªå·±çš„ç”Ÿæ´»ã€‚", effect: { happiness: 4, reputation: 3 } },
            { text: "ä½ è¢«è¯Šæ–­å‡ºè½»åº¦è„‚è‚ªè‚ï¼Œéœ€è¦æ³¨æ„é¥®é£Ÿã€‚", effect: { health: -5, stress: 5 } },
            { text: "ä½ å¼€å§‹å­¦ä¹ åšé¥­ï¼Œå¨è‰ºè¿›æ­¥å¾ˆå¿«ã€‚", effect: { happiness: 5 }, skillGain: 'cooking' },
            { text: "ä½ çš„å…¬å¸ä¸Šå¸‚äº†ï¼Œä½ æŒæœ‰çš„è‚¡ç¥¨å¤§æ¶¨ï¼", effect: { money: 500000, happiness: 20, reputation: 20 } },
            { text: "ä½ å¼€å§‹è€ƒè™‘ä¹°æˆ¿ï¼Œçœ‹äº†å¾ˆå¤šæ¥¼ç›˜ã€‚", effect: { stress: 5 } },
            { text: "ä½ å’Œè€æœ‹å‹é‡é€¢ï¼Œä¸€èµ·å›å¿†é’æ˜¥ã€‚", effect: { happiness: 8 } }
        ];

        // ä¸­å¹´æœŸäº‹ä»¶ (31-50å²)
        const middleAgeEvents = [
            { text: "ä½ é­é‡äº†ä¸­å¹´å±æœºï¼Œå¼€å§‹æ€€ç–‘äººç”Ÿçš„æ„ä¹‰ã€‚", effect: { happiness: -5, stress: 10 } },
            { text: "ä½ çš„å­©å­è€ƒä¸Šäº†é‡ç‚¹é«˜ä¸­ï¼Œä½ å¾ˆæ¬£æ…°ã€‚", effect: { happiness: 10, stress: -5 } },
            { text: "ä½ çš„å­©å­å›é€†æœŸåˆ°äº†ï¼Œç»å¸¸å’Œä½ åµæ¶ã€‚", effect: { happiness: -8, stress: 10 } },
            { text: "ä½ é€èµ°äº†å¹´è¿ˆçš„çˆ¶æ¯ï¼Œæ„Ÿå—åˆ°äº†ç”Ÿå‘½çš„è„†å¼±ã€‚", effect: { happiness: -15, intelligence: 5, stress: 10 } },
            { text: "ä½ çš„å­©å­è€ƒä¸Šäº†ç†æƒ³çš„å¤§å­¦ï¼Œä½ æ„Ÿåˆ°å¤šå¹´çš„ä»˜å‡ºéƒ½å€¼å¾—äº†ã€‚", effect: { happiness: 20, stress: -10 } },
            { text: "ä½ åœ¨èŒåœºä¸Šè·å¾—äº†æ™‹å‡ï¼Œæˆä¸ºéƒ¨é—¨ç»ç†ã€‚", effect: { happiness: 10, reputation: 10, money: 20000 }, promotion: true },
            { text: "ä½ å¼€å§‹å…³æ³¨å…»ç”Ÿï¼Œæ¯å¤©å–èŒ¶é”»ç‚¼ã€‚", effect: { health: 5, happiness: 3 } },
            { text: "ä½ è¢«è¯Šæ–­å‡ºé«˜è¡€å‹ï¼Œéœ€è¦æ³¨æ„èº«ä½“ã€‚", effect: { health: -10, stress: 5 } },
            { text: "ä½ å’Œé…å¶çš„æ„Ÿæƒ…è¶Šæ¥è¶Šæ·¡ï¼Œåƒè€å¤«è€å¦»ã€‚", effect: { happiness: -3 } },
            { text: "ä½ ä»¬å†³å®šé‡æ–°æ‰¾å›æ‹çˆ±çš„æ„Ÿè§‰ï¼Œå»åº¦äº†ç¬¬äºŒæ¬¡èœœæœˆã€‚", effect: { happiness: 15, money: -10000 } },
            { text: "ä½ å¼€å§‹åŸ¹å…»æ–°çš„å…´è¶£çˆ±å¥½ï¼Œç”Ÿæ´»å˜å¾—å……å®ã€‚", effect: { happiness: 8 } },
            { text: "ä½ å‚åŠ äº†ä¸€æ¬¡é«˜ä¸­åŒå­¦èšä¼šï¼Œæ„Ÿæ…¨ä¸‡åƒã€‚", effect: { happiness: 5, stress: 3 } },
            { text: "ä½ çš„å…¬å¸è¢«æ”¶è´­äº†ï¼Œä½ æ‹¿åˆ°äº†ä¸€å¤§ç¬”è¡¥å¿é‡‘ã€‚", effect: { money: 300000, happiness: 5 } },
            { text: "ä½ å¼€å§‹è€ƒè™‘æå‰é€€ä¼‘ï¼Œäº«å—ç”Ÿæ´»ã€‚", effect: { happiness: 3, stress: -5 } },
            { text: "ä½ çš„å­©å­å¸¦å¯¹è±¡å›å®¶ï¼Œä½ å‡†å¤‡è§æœªæ¥çš„å„¿åª³/å¥³å©¿ã€‚", effect: { happiness: 5, stress: 3 } },
            { text: "ä½ çš„å­©å­ç»“å©šäº†ï¼Œä½ æ„Ÿæ…¨æ—¶å…‰é£é€ã€‚", effect: { happiness: 15, money: -100000 } },
            { text: "ä½ æœ‰äº†å­™å­/å­™å¥³ï¼Œå‡çº§å½“çˆ·çˆ·å¥¶å¥¶äº†ï¼", effect: { happiness: 20 }, addRelation: { type: 'å®¶äºº', closeness: 95 } },
            { text: "ä½ å¼€å§‹å†™å›å¿†å½•ï¼Œè®°å½•è‡ªå·±çš„äººç”Ÿã€‚", effect: { happiness: 5, intelligence: 2 } },
            { text: "ä½ çš„è€æ¯›ç—…åˆçŠ¯äº†ï¼Œéœ€è¦ä½é™¢æ²»ç–—ã€‚", effect: { health: -15, money: -30000, stress: 10 } },
            { text: "ä½ æˆåŠŸæˆ’çƒŸ/æˆ’é…’ï¼Œèº«ä½“å¥½äº†å¾ˆå¤šã€‚", effect: { health: 10, happiness: 5 } },
            { text: "ä½ å¼€å§‹å­¦ä¹ ä½¿ç”¨æ–°ç§‘æŠ€ï¼Œä¸æƒ³è¢«æ—¶ä»£æ·˜æ±°ã€‚", effect: { intelligence: 3, happiness: 2 } },
            { text: "ä½ çš„æŠ•èµ„è·å¾—äº†ä¸°åšçš„å›æŠ¥ã€‚", effect: { money: 100000, happiness: 10 } },
            { text: "ä½ è¢«å¹´è½»äººå«'å¤§å”/é˜¿å§¨'ï¼Œæ„Ÿåˆ°æœ‰ç‚¹å¤±è½ã€‚", effect: { happiness: -3, appearance: -3 } },
            { text: "ä½ å¼€å§‹åšä¹‰å·¥ï¼Œå¸®åŠ©éœ€è¦å¸®åŠ©çš„äººã€‚", effect: { happiness: 8, morality: 5, reputation: 5 } },
            { text: "ä½ å’Œå¤šå¹´æœªè§çš„è€å‹é‡é€¢ï¼Œä¸€èµ·å–é…’èŠå¤©ã€‚", effect: { happiness: 8, health: -2 } },
            { text: "ä½ çš„å…¬å¸è£å‘˜ï¼Œä½ è™½ç„¶ä¿ä½äº†å·¥ä½œä½†å‹åŠ›å¾ˆå¤§ã€‚", effect: { stress: 15, happiness: -5 } },
            { text: "ä½ å¼€å§‹è§„åˆ’é€€ä¼‘åçš„ç”Ÿæ´»ï¼Œå……æ»¡æœŸå¾…ã€‚", effect: { happiness: 5, stress: -3 } },
            { text: "ä½ å‚åŠ äº†ä¸€æ¬¡ä½“æ£€ï¼Œå„é¡¹æŒ‡æ ‡éƒ½è¿˜ä¸é”™ã€‚", effect: { happiness: 5, health: 3 } },
            { text: "ä½ çš„å¤´å‘å¼€å§‹å˜ç™½ï¼Œæ„Ÿå¹å²æœˆä¸é¥¶äººã€‚", effect: { appearance: -3 } },
            { text: "ä½ å¼€å§‹æ”¶è—ä¸€äº›ä¸œè¥¿ï¼Œæ‰¾åˆ°äº†æ–°çš„ä¹è¶£ã€‚", effect: { happiness: 5, money: -5000 } }
        ];

        // è€å¹´æœŸäº‹ä»¶ (51å²+)
        const elderlyEvents = [
            { text: "ä½ é€€ä¼‘äº†ï¼Œå¼€å§‹äº«å—æ‚ é—²çš„æ™šå¹´ç”Ÿæ´»ã€‚", effect: { happiness: 5, stress: -20 }, retire: true },
            { text: "ä½ å¼€å§‹å­¦ç”»ç”»ï¼Œå‘ç°äº†æ–°çš„å…´è¶£çˆ±å¥½ã€‚", effect: { happiness: 8, intelligence: 2 } },
            { text: "ä½ çš„å­™å­å‡ºç”Ÿäº†ï¼Œå››ä¸–åŒå ‚å…¶ä¹èèã€‚", effect: { happiness: 15 } },
            { text: "è€æœ‹å‹ä»¬ç›¸ç»§ç¦»ä¸–ï¼Œä½ æ„Ÿåˆ°å­¤ç‹¬ã€‚", effect: { happiness: -10 } },
            { text: "ä½ è·å¾—äº†'é•¿å¯¿è€äºº'çš„ç§°å·ï¼Œè®°è€…æ¥é‡‡è®¿ä½ ã€‚", effect: { happiness: 8, reputation: 10 } },
            { text: "èº«ä½“å„é¡¹æœºèƒ½è¡°é€€ï¼Œéœ€è¦äººç…§é¡¾ã€‚", effect: { health: -15, happiness: -5 } },
            { text: "ä½ å¼€å§‹å›å¿†å¾€äº‹ï¼Œäººç”Ÿåƒç”µå½±ä¸€æ ·åœ¨è„‘æµ·ä¸­æ’­æ”¾ã€‚", effect: { happiness: 5, intelligence: 2 } },
            { text: "ä½ å’Œè€ä¼´ä¸€èµ·å…»èŠ±ç§è‰ï¼Œäº«å—å®é™çš„ç”Ÿæ´»ã€‚", effect: { happiness: 8, health: 2 } },
            { text: "ä½ çš„å…»è€é‡‘è¶³å¤Ÿç”Ÿæ´»ï¼Œä¸ç”¨æ‹…å¿ƒç»æµé—®é¢˜ã€‚", effect: { happiness: 5, stress: -5 } },
            { text: "ä½ å‚åŠ äº†ä¸€æ¬¡è€å¹´æ—…è¡Œå›¢ï¼Œè®¤è¯†äº†å¾ˆå¤šæ–°æœ‹å‹ã€‚", effect: { happiness: 10 }, addRelation: { type: 'æœ‹å‹', closeness: 50 } },
            { text: "ä½ å¼€å§‹æ•™å­™å­/å­™å¥³ä¸€äº›äººç”Ÿé“ç†ã€‚", effect: { happiness: 8, morality: 3 } },
            { text: "ä½ çš„è€ä¼´å…ˆä½ ä¸€æ­¥ç¦»å¼€äº†ï¼Œä½ å¾ˆéš¾è¿‡ã€‚", effect: { happiness: -20, stress: 10 } },
            { text: "å­å¥³ä»¬å¾ˆå­é¡ºï¼Œç»å¸¸æ¥çœ‹æœ›ä½ ã€‚", effect: { happiness: 10 } },
            { text: "ä½ ä½è¿›äº†å…»è€é™¢ï¼Œç”Ÿæ´»æœ‰äººç…§é¡¾ã€‚", effect: { happiness: 3, health: 3, money: -5000 } },
            { text: "ä½ å¼€å§‹å†™å®¶ä¹¦ï¼Œç»™å­å­™åä»£ç•™ä¸‹ä¸€äº›è¯ã€‚", effect: { happiness: 5, intelligence: 2 } },
            { text: "ä½ çš„è®°å¿†åŠ›å¼€å§‹è¡°é€€ï¼Œç»å¸¸å¿˜äº‹ã€‚", effect: { intelligence: -5, stress: 3 } },
            { text: "ä½ æ‘”äº†ä¸€è·¤ï¼Œå¹¸å¥½æ²¡æœ‰å¤§ç¢ã€‚", effect: { health: -10, stress: 5 } },
            { text: "ä½ æ”¶åˆ°äº†ä¸€ä»½æ„å¤–çš„ç¤¼ç‰©ï¼Œæ˜¯è¿œæ–¹çš„äº²æˆšå¯„æ¥çš„ã€‚", effect: { happiness: 5 } },
            { text: "ä½ å¼€å§‹ç›¸ä¿¡ä¸€äº›å…»ç”Ÿä¹‹é“ï¼Œæ¯å¤©æŒ‰æ—¶ä½œæ¯ã€‚", effect: { health: 5 } },
            { text: "ä½ çœ‹æ·¡äº†ç”Ÿæ­»ï¼Œå¯¹æ­»äº¡ä¸å†ææƒ§ã€‚", effect: { happiness: 5, stress: -10 } },
            { text: "ä½ çš„é‡å­™å‡ºç”Ÿäº†ï¼Œäº”ä¸–åŒå ‚ï¼", effect: { happiness: 20 } },
            { text: "ä½ å¼€å§‹æ•´ç†è‡ªå·±çš„é—ç‰©ï¼Œå‡†å¤‡å’Œè¿™ä¸ªä¸–ç•Œå‘Šåˆ«ã€‚", effect: { happiness: -3, intelligence: 3 } },
            { text: "ä½ åšäº†ä¸€ä¸ªç¾æ¢¦ï¼Œæ¢¦è§äº†å¹´è½»æ—¶çš„è‡ªå·±ã€‚", effect: { happiness: 5 } },
            { text: "åŒ»ç”Ÿè¯´ä½ èº«ä½“å¾ˆå¥åº·ï¼Œè¿˜èƒ½æ´»å¾ˆå¤šå¹´ã€‚", effect: { happiness: 8, health: 5 } },
            { text: "ä½ å†³å®šæŠŠç§¯è“„æç»™æ…ˆå–„æœºæ„ï¼Œå¸®åŠ©æ›´å¤šçš„äººã€‚", effect: { happiness: 10, morality: 10, money: -500000 } },
            { text: "ä½ å’Œå­å¥³ä»¬ä¸€èµ·åƒäº†ä¸€é¡¿å›¢åœ†é¥­ï¼Œæ„Ÿåˆ°å¾ˆæ»¡è¶³ã€‚", effect: { happiness: 10 } },
            { text: "ä½ å¼€å§‹å­¦ä¹ å†¥æƒ³ï¼Œå†…å¿ƒå˜å¾—å¹³é™ã€‚", effect: { happiness: 5, stress: -10 } },
            { text: "ä½ æ”¶åˆ°äº†è€æœ‹å‹çš„ä¿¡ï¼Œå›å¿†èµ·äº†é’æ˜¥å²æœˆã€‚", effect: { happiness: 5 } },
            { text: "ä½ å†³å®šæŠŠæˆ¿å­ç•™ç»™å­å¥³ï¼Œè‡ªå·±ä½å…»è€é™¢ã€‚", effect: { happiness: 5, morality: 5 } },
            { text: "ä½ å¼€å§‹ç›¸ä¿¡æ¥ä¸–ï¼Œå¯¹æ­»äº¡æœ‰äº†æ–°çš„ç†è§£ã€‚", effect: { happiness: 3, stress: -5 } }
        ];

        // éšæœºäº‹ä»¶ (å…¨å¹´é¾„æ®µ)
        const randomEvents = [
            { text: "åœ¨è¡—ä¸Šæ¡åˆ°äº†100å—é’±", effect: { money: 100, happiness: 3 }, type: 'good' },
            { text: "æ„Ÿå†’äº†ï¼Œä¼‘æ¯äº†å¥½å‡ å¤©", effect: { health: -8, happiness: -3, money: -200 }, type: 'bad' },
            { text: "å¸®åŠ©äº†ä¸€ä½è¿·è·¯çš„è€å¥¶å¥¶", effect: { happiness: 5, health: 2, morality: 3 }, type: 'good' },
            { text: "æŠ•èµ„è‚¡ç¥¨å°èµšä¸€ç¬”", effect: { money: 5000, happiness: 5 }, type: 'good' },
            { text: "è¢«å°å·æ‰’äº†é’±åŒ…", effect: { money: -500, happiness: -5 }, type: 'bad' },
            { text: "å‚åŠ é©¬æ‹‰æ¾æ¯”èµ›è·å¾—å¥–ç‰Œ", effect: { health: 5, happiness: 8, appearance: 3, reputation: 3 }, type: 'good' },
            { text: "ç†¬å¤œæ‰“æ¸¸æˆå¯¼è‡´ç²¾ç¥èé¡", effect: { health: -5, energy: -20, happiness: 5 }, type: 'bad' },
            { text: "è¯»äº†ä¸€æœ¬å¥½ä¹¦ï¼Œæ”¶è·é¢‡ä¸°", effect: { intelligence: 3, happiness: 2 }, type: 'good', book: true },
            { text: "é‡åˆ°è€æœ‹å‹ï¼Œä¸€èµ·å–äº†ä¸‹åˆèŒ¶", effect: { happiness: 5, money: -100 }, type: 'neutral' },
            { text: "ä¹°å½©ç¥¨ä¸­äº†å¤§å¥–ï¼", effect: { money: 100000, happiness: 30 }, type: 'good', rare: true, lottery: 'big' },
            { text: "é­é‡è½¦ç¥¸ï¼Œæ‰€å¹¸æ— å¤§ç¢", effect: { health: -20, money: -5000, happiness: -10 }, type: 'bad', accident: true },
            { text: "åœ¨å…¬å¸å¹´ä¼šä¸ŠæŠ½ä¸­ä¸€ç­‰å¥–", effect: { money: 5000, happiness: 8 }, type: 'good' },
            { text: "è¢«é¢†å¯¼è¡¨æ‰¬ï¼Œå¿ƒæƒ…å¤§å¥½", effect: { happiness: 5, reputation: 3 }, type: 'good' },
            { text: "å’ŒåŒäº‹å‘ç”Ÿäº†çŸ›ç›¾", effect: { happiness: -3, stress: 5 }, type: 'bad' },
            { text: "å­¦ä¼šäº†ä¸€é“æ–°èœ", effect: { happiness: 3 }, skillGain: 'cooking', type: 'good' },
            { text: "çœ‹äº†ä¸€éƒ¨æ„Ÿäººçš„ç”µå½±", effect: { happiness: 3, stress: -3 }, type: 'good' },
            { text: "æ‰‹æœºåäº†ï¼Œéœ€è¦æ¢æ–°", effect: { money: -3000, happiness: -3 }, type: 'bad' },
            { text: "åœ¨å…¬å›­æ•£æ­¥ï¼Œå¿ƒæƒ…æ”¾æ¾", effect: { happiness: 3, health: 2 }, type: 'good' },
            { text: "åƒäº†ä¸€é¡¿ç¾å‘³çš„ç«é”…", effect: { happiness: 5, health: -2 }, type: 'good', food: true },
            { text: "è¢«ç½‘ç»œè¯ˆéª—ï¼ŒæŸå¤±äº†ä¸€ç¬”é’±", effect: { money: -10000, happiness: -10, stress: 10 }, type: 'bad' },
            { text: "å‚åŠ äº†ä¸€æ¬¡å¿—æ„¿è€…æ´»åŠ¨", effect: { happiness: 5, morality: 5 }, type: 'good' },
            { text: "å® ç‰©ç”Ÿç—…äº†ï¼ŒèŠ±äº†å¾ˆå¤šé’±æ²»ç–—", effect: { money: -2000, happiness: -3 }, type: 'bad' },
            { text: "åœ¨äºŒæ‰‹å¸‚åœºæ·˜åˆ°äº†å®è´", effect: { money: -500, happiness: 5 }, type: 'good' },
            { text: "å®¶é‡Œæ°´ç®¡çˆ†äº†ï¼Œéœ€è¦ç»´ä¿®", effect: { money: -2000, happiness: -3 }, type: 'bad' },
            { text: "æ”¶åˆ°äº†æ„å¤–çš„çº¢åŒ…", effect: { money: 1000, happiness: 5 }, type: 'good' },
            { text: "ç‰™ç—›éš¾å¿ï¼Œå»çœ‹äº†ç‰™åŒ»", effect: { money: -1500, health: -3 }, type: 'bad' },
            { text: "å‚åŠ äº†ä¸€æ¬¡æœ‰è¶£çš„è®²åº§", effect: { intelligence: 2, happiness: 3 }, type: 'good' },
            { text: "ä¸‹é›¨å¤©æ²¡å¸¦ä¼ï¼Œæ·‹æˆäº†è½æ±¤é¸¡", effect: { health: -3, happiness: -2 }, type: 'bad' },
            { text: "å‘ç°äº†ä¸€å®¶å¾ˆå¥½åƒçš„é¤å…", effect: { happiness: 5 }, type: 'good', food: true },
            { text: "æ‰‹æœºä¸­äº†ç—…æ¯’ï¼Œæ•°æ®ä¸¢å¤±", effect: { happiness: -5, stress: 5 }, type: 'bad' },
            { text: "å‚åŠ äº†ä¸€æ¬¡æˆ·å¤–å¾’æ­¥", effect: { health: 5, happiness: 5 }, type: 'good' },
            { text: "è¢«é‚»å±…æŠ•è¯‰å™ªéŸ³", effect: { happiness: -3, stress: 3 }, type: 'bad' },
            { text: "åœ¨ç½‘ä¸Šå–é—²ç½®èµšäº†ä¸€ç¬”", effect: { money: 500, happiness: 3 }, type: 'good' },
            { text: "é’¥åŒ™ä¸¢äº†ï¼Œéœ€è¦æ¢é”", effect: { money: -500, happiness: -2 }, type: 'bad' },
            { text: "çœ‹äº†ä¸€åœºç²¾å½©çš„çƒèµ›", effect: { happiness: 5 }, type: 'good' },
            { text: "è¢«è¯¯ä¼šäº†ï¼Œæ„Ÿåˆ°å¾ˆå§”å±ˆ", effect: { happiness: -5, stress: 5 }, type: 'bad' },
            { text: "å­¦ä¼šäº†ä¸€é¦–æ–°æ­Œ", effect: { happiness: 3 }, skillGain: 'music', type: 'good' },
            { text: "ç”µè„‘åäº†ï¼Œéœ€è¦ä¿®ç†", effect: { money: -1000, happiness: -3 }, type: 'bad' },
            { text: "å‚åŠ äº†ä¸€æ¬¡å®¶åº­èšä¼š", effect: { happiness: 5 }, type: 'good' },
            { text: "è¢«æ¨é”€äº†ä¸éœ€è¦çš„ä¸œè¥¿", effect: { money: -500, happiness: -2 }, type: 'bad' },
            { text: "åœ¨å›¾ä¹¦é¦†åº¦è¿‡äº†ä¸€ä¸ªå®‰é™çš„ä¸‹åˆ", effect: { happiness: 3, intelligence: 2 }, type: 'good', book: true },
            { text: "ç”µæ¢¯åäº†ï¼Œçˆ¬äº†åå‡ å±‚æ¥¼", effect: { health: 2, energy: -10 }, type: 'neutral' },
            { text: "æ”¶åˆ°äº†ä¸€ä»½ç²¾ç¾çš„ç¤¼ç‰©", effect: { happiness: 5 }, type: 'good' },
            { text: "è¢«è€æ¿ä¸´æ—¶å®‰æ’åŠ ç­", effect: { happiness: -3, stress: 5, energy: -10 }, type: 'bad' },
            { text: "å‘ç°äº†ä¸€æ¡è¿‘è·¯ï¼Œçœäº†å¾ˆå¤šæ—¶é—´", effect: { happiness: 2 }, type: 'good' },
            { text: "é’±åŒ…ä¸¢äº†ï¼Œé‡Œé¢çš„è¯ä»¶éœ€è¦è¡¥åŠ", effect: { money: -1000, happiness: -5, stress: 5 }, type: 'bad' },
            { text: "åœ¨å’–å•¡åº—é‡åˆ°äº†ä¸€ä¸ªæœ‰è¶£çš„äºº", effect: { happiness: 3 }, type: 'good' },
            { text: "ç©ºè°ƒåäº†ï¼Œçƒ­å¾—ç¡ä¸ç€", effect: { happiness: -3, health: -2 }, type: 'bad' },
            { text: "å®Œæˆäº†ä¸€å¹…æ»¡æ„çš„ç”»ä½œ", effect: { happiness: 5 }, skillGain: 'art', type: 'good' },
            { text: "è¢«èšŠå­å’¬äº†ä¸€èº«åŒ…", effect: { happiness: -2 }, type: 'bad' },
            { text: "å¸®åŠ©åŒäº‹è§£å†³äº†ä¸€ä¸ªéš¾é¢˜", effect: { happiness: 3, reputation: 3 }, type: 'good' },
            { text: "ç½‘è´­çš„ä¸œè¥¿è´¨é‡å¾ˆå·®", effect: { money: -200, happiness: -2 }, type: 'bad' },
            { text: "åœ¨å…¬å›­å–‚é¸½å­ï¼Œå¿ƒæƒ…å¾ˆå¹³é™", effect: { happiness: 3, stress: -3 }, type: 'good' },
            { text: "æ‰‹æœºæ¬ è´¹åœæœºäº†", effect: { happiness: -2, money: -200 }, type: 'bad' },
            { text: "å­¦ä¼šäº†ä¸€ä¸ªæ–°çš„ç¼–ç¨‹æŠ€å·§", effect: { happiness: 3, intelligence: 2 }, skillGain: 'programming', type: 'good' },
            { text: "è¢«æ´’æ°´è½¦æº…äº†ä¸€èº«æ°´", effect: { happiness: -3 }, type: 'bad' },
            { text: "åœ¨æ—§ä¹¦é‡Œå‘ç°äº†ä¸€å¼ è€ç…§ç‰‡", effect: { happiness: 3 }, type: 'good' },
            { text: "å¤–å–é€é”™äº†ï¼Œç­‰äº†å¾ˆä¹…", effect: { happiness: -3 }, type: 'bad' },
            { text: "çœ‹äº†ä¸€åœºç¾ä¸½çš„æ—¥è½", effect: { happiness: 5, stress: -5 }, type: 'good' },
            { text: "è¢«ç‹—è¿½äº†ä¸€æ®µè·¯", effect: { health: -2, happiness: -3 }, type: 'bad' },
            { text: "æ•´ç†æˆ¿é—´ï¼Œå‘ç°äº†å¾ˆå¤šå›å¿†", effect: { happiness: 3 }, type: 'good' },
            { text: "ç½‘ç»œæ–­äº†ï¼Œå·¥ä½œæ— æ³•è¿›è¡Œ", effect: { happiness: -3, stress: 5 }, type: 'bad' },
            { text: "ç»™æµæµªçŒ«å–‚é£Ÿï¼Œæ„Ÿè§‰å¾ˆæ¸©æš–", effect: { happiness: 3, morality: 2 }, type: 'good' },
            { text: "è¢«è¯¯è§£ä¸ºå°å·ï¼Œå¾ˆå°´å°¬", effect: { happiness: -5, stress: 5 }, type: 'bad' },
            { text: "å­¦ä¼šäº†ä¸€ä¸ªæ–°çš„é­”æœ¯", effect: { happiness: 3 }, type: 'good' },
            { text: "ä¸‹é›¨å¤©é‹å­è¿›æ°´äº†", effect: { happiness: -2 }, type: 'bad' },
            { text: "åœ¨è¡—å¤´è‰ºäººçš„è¡¨æ¼”å‰é©»è¶³", effect: { happiness: 3, money: -20 }, type: 'good' },
            { text: "è¢«ç”µæ¢¯é—¨å¤¹äº†ä¸€ä¸‹", effect: { health: -2, happiness: -2 }, type: 'bad' },
            { text: "å†™äº†ä¸€ç¯‡æ»¡æ„çš„åšå®¢æ–‡ç« ", effect: { happiness: 4, intelligence: 1 }, type: 'good' },
            { text: "è¢«åŒäº‹èƒŒåè¯´åè¯", effect: { happiness: -3, stress: 5 }, type: 'bad' },
            { text: "åœ¨è¶…å¸‚é‡åˆ°äº†å¤§å‡ä»·", effect: { money: -500, happiness: 5 }, type: 'good' },
            { text: "å¿˜è®°å¸¦é’¥åŒ™ï¼Œè¢«é”åœ¨é—¨å¤–", effect: { happiness: -3, money: -200 }, type: 'bad' },
            { text: "å¬äº†ä¸€é¦–å¾ˆæ²»æ„ˆçš„æ­Œ", effect: { happiness: 3, stress: -3 }, type: 'good' },
            { text: "è¢«ç†Šå­©å­æ‰“æ‰°äº†ä¼‘æ¯", effect: { happiness: -3 }, type: 'bad' },
            { text: "åœ¨å…¬å›­é•¿æ¤…ä¸Šç¡äº†ä¸ªåˆè§‰", effect: { energy: 10, happiness: 3 }, type: 'good' },
            { text: "è¢«æ¨é”€ç”µè¯éªšæ‰°", effect: { happiness: -2 }, type: 'bad' },
            { text: "å‘ç°äº†ä¸€å®¶å¾ˆæ£’çš„ç‹¬ç«‹ä¹¦åº—", effect: { happiness: 5, intelligence: 1 }, type: 'good', book: true },
            { text: "åœ°é“åè¿‡ç«™äº†", effect: { happiness: -2 }, type: 'bad' },
            { text: "ç»™æ¤ç‰©æµ‡æ°´ï¼Œçœ‹ç€å®ƒä»¬æˆé•¿", effect: { happiness: 3 }, type: 'good' },
            { text: "è¢«é¢†å¯¼æ— ç¼˜æ— æ•…æ‰¹è¯„", effect: { happiness: -5, stress: 10 }, type: 'bad' },
            { text: "åœ¨å¤œå¸‚åƒäº†å¾ˆå¤šå¥½åƒçš„", effect: { happiness: 5, health: -2, money: -200 }, type: 'good', food: true },
            { text: "æ‰‹æœºæ²¡ç”µäº†ï¼Œå¤±è”äº†ä¸€ä¸‹åˆ", effect: { happiness: -3, stress: 3 }, type: 'bad' },
            { text: "çœ‹äº†ä¸€éƒ¨ç»å…¸çš„é»‘ç™½ç”µå½±", effect: { happiness: 3, intelligence: 1 }, type: 'good' },
            { text: "è¢«å¤§é›¨å›°åœ¨äº†å•†åœº", effect: { happiness: -2, money: -300 }, type: 'bad' },
            { text: "åœ¨å¥èº«æˆ¿çªç ´äº†è‡ªå·±çš„è®°å½•", effect: { health: 3, happiness: 5 }, type: 'good' },
            { text: "è¢«åŒäº‹æŠ¢èµ°äº†åŠŸåŠ³", effect: { happiness: -5, stress: 5 }, type: 'bad' },
            { text: "åœ¨æ—§è´§å¸‚åœºæ·˜åˆ°äº†ç»ç‰ˆä¹¦", effect: { happiness: 5, money: -100 }, type: 'good', book: true },
            { text: "è¢«çƒ­æ°´çƒ«ä¼¤äº†", effect: { health: -5, happiness: -3 }, type: 'bad' },
            { text: "å‚åŠ äº†ä¸€æ¬¡æœ‰è¶£çš„æ¡Œæ¸¸èšä¼š", effect: { happiness: 5 }, type: 'good' },
            { text: "è¢«å¿«é€’å¼„ä¸¢äº†é‡è¦åŒ…è£¹", effect: { happiness: -5, stress: 5 }, type: 'bad' },
            { text: "åœ¨æ¸…æ™¨çš„å…¬å›­çœ‹åˆ°äº†æ—¥å‡º", effect: { happiness: 5, stress: -5 }, type: 'good' },
            { text: "è¢«æœ‹å‹æ”¾é¸½å­äº†", effect: { happiness: -3 }, type: 'bad' },
            { text: "å­¦ä¼šäº†ä¸€ä¸ªæ–°çš„ç‘œä¼½åŠ¨ä½œ", effect: { health: 2, happiness: 3 }, type: 'good' },
            { text: "è¢«ç”µæ¢¯é‡Œçš„å¹¿å‘Šåµå¾—å¿ƒçƒ¦", effect: { happiness: -2 }, type: 'bad' },
            { text: "åœ¨æµ·è¾¹æ¡åˆ°äº†æ¼‚äº®çš„è´å£³", effect: { happiness: 3 }, type: 'good' },
            { text: "è¢«è€æ¿è¦æ±‚å‘¨æœ«åŠ ç­", effect: { happiness: -5, stress: 5 }, type: 'bad' },
            { text: "çœ‹äº†ä¸€åœºç²¾å½©çš„æ¼”å”±ä¼š", effect: { happiness: 10, money: -500 }, type: 'good' },
            { text: "è¢«èšŠå­å®äº†çœ¼ç›", effect: { health: -2, appearance: -3, happiness: -3 }, type: 'bad' },
            { text: "åœ¨å±±é¡¶çœ‹åˆ°äº†äº‘æµ·", effect: { happiness: 8, stress: -5 }, type: 'good' },
            { text: "è¢«åŒäº‹å€Ÿäº†é’±ä¸è¿˜", effect: { money: -500, happiness: -5 }, type: 'bad' },
            { text: "å®Œæˆäº†ä¸€é¡¹å›°éš¾çš„å·¥ä½œä»»åŠ¡", effect: { happiness: 5, reputation: 3 }, type: 'good' },
            { text: "è¢«å¤–å–éª‘æ‰‹å·®è¯„å¨èƒ", effect: { happiness: -3, stress: 3 }, type: 'bad' },
            { text: "åœ¨å›¾ä¹¦é¦†å€Ÿåˆ°äº†æœŸå¾…å·²ä¹…çš„ä¹¦", effect: { happiness: 4, intelligence: 2 }, type: 'good', book: true },
            { text: "è¢«é‚»å±…è£…ä¿®çš„å£°éŸ³åµåˆ°", effect: { happiness: -3, stress: 3 }, type: 'bad' },
            { text: "åœ¨è¡—å¤´é‡åˆ°äº†å¯çˆ±çš„å°ç‹—", effect: { happiness: 5 }, type: 'good' },
            { text: "è¢«é¢†å¯¼ç”»å¤§é¥¼", effect: { happiness: -2 }, type: 'bad' },
            { text: "åœ¨åšç‰©é¦†åº¦è¿‡äº†ä¸€ä¸ªå……å®çš„ä¸‹åˆ", effect: { happiness: 5, intelligence: 3 }, type: 'good' },
            { text: "è¢«å…¬äº¤è½¦é—¨å¤¹äº†ä¸€ä¸‹", effect: { health: -2, happiness: -2 }, type: 'bad' },
            { text: "åœ¨å’–å•¡åº—å†™å®Œäº†æ‹–å»¶å·²ä¹…çš„æŠ¥å‘Š", effect: { happiness: 5, stress: -5 }, type: 'good' },
            { text: "è¢«åŒäº‹æŠ¢èµ°äº†åœè½¦ä½", effect: { happiness: -3 }, type: 'bad' },
            { text: "åœ¨å…¬å›­çœ‹åˆ°äº†å½©è™¹", effect: { happiness: 8 }, type: 'good' },
            { text: "è¢«å¤§é›¨æ·‹æ¹¿äº†é‡è¦æ–‡ä»¶", effect: { happiness: -5, stress: 5 }, type: 'bad' },
            { text: "å­¦ä¼šäº†ä¸€é¦–æ–°çš„é’¢ç´æ›²", effect: { happiness: 5 }, skillGain: 'music', type: 'good' },
            { text: "è¢«ç”µæ¢¯é‡Œçš„é¦™æ°´å‘³ç†å¾—å¤´æ™•", effect: { happiness: -2 }, type: 'bad' },
            { text: "åœ¨æ—§è¡£æœé‡Œå‘ç°äº†é—å¿˜çš„ç°é‡‘", effect: { money: 200, happiness: 5 }, type: 'good' },
            { text: "è¢«å¿«é€’é€é”™äº†åœ°å€", effect: { happiness: -3 }, type: 'bad' },
            { text: "åœ¨å±‹é¡¶èŠ±å›­çœ‹æ˜Ÿæ˜Ÿ", effect: { happiness: 5, stress: -5 }, type: 'good' },
            { text: "è¢«è€æ¿è¦æ±‚æ— å¿åŠ ç­", effect: { happiness: -5, stress: 10 }, type: 'bad' },
            { text: "åœ¨äºŒæ‰‹åº—ä¹°åˆ°äº†ç»ç‰ˆå”±ç‰‡", effect: { happiness: 5, money: -200 }, type: 'good' },
            { text: "è¢«åœ°é“é‡Œçš„æ‹¥æŒ¤æŒ¤å¾—éš¾å—", effect: { health: -2, happiness: -3 }, type: 'bad' },
            { text: "åœ¨æ¸…æ™¨å¬åˆ°äº†é¸Ÿé¸£", effect: { happiness: 3, stress: -3 }, type: 'good' },
            { text: "è¢«æœ‹å‹è¯¯è§£äº†ä½ çš„æ„æ€", effect: { happiness: -3 }, type: 'bad' },
            { text: "åœ¨æµ·è¾¹å†™ä¸‹äº†è‡ªå·±çš„æ„¿æœ›", effect: { happiness: 4 }, type: 'good' },
            { text: "è¢«é¢†å¯¼è¦æ±‚åšä¸å±äºä½ çš„å·¥ä½œ", effect: { happiness: -3, stress: 5 }, type: 'bad' },
            { text: "åœ¨å…¬å›­é‡Œçœ‹åˆ«äººæ”¾é£ç­", effect: { happiness: 3 }, type: 'good' },
            { text: "è¢«åŒäº‹æŠ¢èµ°äº†å®¢æˆ·", effect: { happiness: -5, stress: 5 }, type: 'bad' },
            { text: "åœ¨å±±é¡¶è®¸ä¸‹äº†æ„¿æœ›", effect: { happiness: 5 }, type: 'good' },
            { text: "è¢«ç”µæ¢¯æ•…éšœå›°äº†ä¸€ä¼šå„¿", effect: { happiness: -3, stress: 5 }, type: 'bad' },
            { text: "åœ¨æ—§ç…§ç‰‡é‡Œçœ‹åˆ°äº†å¹´è½»çš„çˆ¶æ¯", effect: { happiness: 3 }, type: 'good' },
            { text: "è¢«è€æ¿å½“ä¼—æ‰¹è¯„", effect: { happiness: -8, stress: 10, reputation: -3 }, type: 'bad' },
            { text: "åœ¨å›¾ä¹¦é¦†å‘ç°äº†ä¸€æœ¬æ”¹å˜äººç”Ÿè§‚çš„ä¹¦", effect: { happiness: 5, intelligence: 3 }, type: 'good', book: true },
            { text: "è¢«å¤§é›¨å›°åœ¨äº†å…¬å¸", effect: { happiness: -3 }, type: 'bad' },
            { text: "åœ¨å…¬å›­é‡åˆ°äº†ä¸€åªé»äººçš„çŒ«", effect: { happiness: 5 }, type: 'good' },
            { text: "è¢«åŒäº‹èƒŒåæ…åˆ€å­", effect: { happiness: -5, stress: 10 }, type: 'bad' },
            { text: "åœ¨å±±é¡¶çœ‹åˆ°äº†æµæ˜Ÿ", effect: { happiness: 8 }, type: 'good' },
            { text: "è¢«é¢†å¯¼è¦æ±‚èƒŒé»‘é”…", effect: { happiness: -10, stress: 15 }, type: 'bad' },
            { text: "åœ¨æµ·è¾¹æ¡åˆ°äº†æ¼‚æµç“¶", effect: { happiness: 5 }, type: 'good' },
            { text: "è¢«å®¢æˆ·æ— ç†æŠ•è¯‰", effect: { happiness: -5, stress: 10 }, type: 'bad' },
            { text: "åœ¨å…¬å›­çœ‹åˆ°äº†ç¾ä¸½çš„æ¨±èŠ±", effect: { happiness: 5 }, type: 'good' },
            { text: "è¢«è€æ¿æ‰£äº†å¥–é‡‘", effect: { money: -2000, happiness: -5, stress: 5 }, type: 'bad' },
            { text: "åœ¨å±±é¡¶å¤§å–Šé‡Šæ”¾äº†å‹åŠ›", effect: { happiness: 5, stress: -10 }, type: 'good' },
            { text: "è¢«åŒäº‹æŠ¢èµ°äº†å‡èŒæœºä¼š", effect: { happiness: -5, stress: 10 }, type: 'bad' },
            { text: "åœ¨æµ·è¾¹çœ‹åˆ°äº†æµ·è±š", effect: { happiness: 10 }, type: 'good' },
            { text: "è¢«é¢†å¯¼è¦æ±‚å‘¨æœ«å‡ºå·®", effect: { happiness: -5, stress: 5 }, type: 'bad' },
            { text: "åœ¨å…¬å›­é‡åˆ°äº†å¤šå¹´æœªè§çš„è€å‹", effect: { happiness: 8 }, type: 'good' },
            { text: "è¢«è€æ¿è¦æ±‚é™è–ª", effect: { money: -3000, happiness: -8, stress: 10 }, type: 'bad' },
            { text: "åœ¨å±±é¡¶çœ‹åˆ°äº†æ—¥å‡º", effect: { happiness: 8, stress: -5 }, type: 'good' },
            { text: "è¢«åŒäº‹æŠ¢èµ°äº†é¡¹ç›®", effect: { happiness: -5, stress: 10 }, type: 'bad' },
            { text: "åœ¨æµ·è¾¹å†™ä¸‹äº†ç»™æœªæ¥çš„ä¿¡", effect: { happiness: 5 }, type: 'good' },
            { text: "è¢«é¢†å¯¼è¦æ±‚æ— å¿åšé¢å¤–å·¥ä½œ", effect: { happiness: -5, stress: 10 }, type: 'bad' },
            { text: "åœ¨å…¬å›­çœ‹åˆ°äº†ç¾ä¸½çš„æ™šéœ", effect: { happiness: 5, stress: -5 }, type: 'good' },
            { text: "è¢«è€æ¿è¦æ±‚ä¸»åŠ¨è¾èŒ", effect: { happiness: -10, stress: 15 }, type: 'bad' },
            { text: "åœ¨å±±é¡¶çœ‹åˆ°äº†é“¶æ²³", effect: { happiness: 10, stress: -10 }, type: 'good' },
            { text: "è¢«åŒäº‹æŠ¢èµ°äº†åŠŸåŠ³è¿˜è¢«è¯¬é™·", effect: { happiness: -10, stress: 15 }, type: 'bad' },
            { text: "åœ¨æµ·è¾¹åº¦è¿‡äº†ä¸€ä¸ªå®é™çš„å¤œæ™š", effect: { happiness: 5, stress: -5 }, type: 'good' },
            { text: "è¢«é¢†å¯¼è¦æ±‚åšè¿æ³•çš„äº‹æƒ…", effect: { happiness: -10, stress: 20, morality: -10 }, type: 'bad', choice: {
                title: "é“å¾·æŠ‰æ‹©",
                desc: "é¢†å¯¼è¦æ±‚ä½ åšä¸€ä»¶è¿æ³•çš„äº‹æƒ…ï¼Œä½ è¯¥æ€ä¹ˆåŠï¼Ÿ",
                options: [
                    { text: "æ‹’ç»å¹¶ä¸¾æŠ¥", effect: { morality: 10, reputation: 5, stress: 5 } },
                    { text: "å§”å©‰æ‹’ç»", effect: { happiness: -3, stress: 5 } },
                    { text: "è¢«è¿«ç­”åº”", effect: { morality: -10, money: 5000, stress: 15 } }
                ]
            }},
            { text: "åœ¨å…¬å›­å¸®åŠ©äº†ä¸€ä¸ªè¿·è·¯çš„å°å­©", effect: { happiness: 5, morality: 5 }, type: 'good' },
            { text: "è¢«è€æ¿æ€§éªšæ‰°", effect: { happiness: -15, stress: 20 }, type: 'bad', choice: {
                title: "æ€§éªšæ‰°",
                desc: "è€æ¿å¯¹ä½ è¿›è¡Œäº†æ€§éªšæ‰°ï¼Œä½ è¯¥æ€ä¹ˆåŠï¼Ÿ",
                options: [
                    { text: "æŠ¥è­¦å¤„ç†", effect: { morality: 5, reputation: 5, stress: 10 } },
                    { text: "å¿æ°”åå£°", effect: { happiness: -10, stress: 15 } },
                    { text: "è¾èŒç¦»å¼€", effect: { happiness: -5, stress: 5, job: null } }
                ]
            }},
            { text: "åœ¨å±±é¡¶çœ‹åˆ°äº†å£®ä¸½çš„äº‘æµ·", effect: { happiness: 10, stress: -10 }, type: 'good' },
            { text: "è¢«åŒäº‹é™·å®³èƒŒé»‘é”…", effect: { happiness: -10, stress: 15, reputation: -5 }, type: 'bad' },
            { text: "åœ¨æµ·è¾¹æ•‘åŠ©äº†ä¸€åªå—ä¼¤çš„æµ·é¸Ÿ", effect: { happiness: 8, morality: 5 }, type: 'good' },
            { text: "è¢«é¢†å¯¼è¦æ±‚é™ªé…’", effect: { health: -5, happiness: -5, stress: 5 }, type: 'bad' },
            { text: "åœ¨å…¬å›­é‡åˆ°äº†ä¸€ä½æ™ºè€…", effect: { happiness: 5, intelligence: 3 }, type: 'good' },
            { text: "è¢«è€æ¿æ‹–æ¬ å·¥èµ„", effect: { money: -5000, happiness: -10, stress: 15 }, type: 'bad' },
            { text: "åœ¨å±±é¡¶æ‚Ÿå‡ºäº†äººç”Ÿé“ç†", effect: { happiness: 5, intelligence: 5, stress: -10 }, type: 'good' },
            { text: "è¢«åŒäº‹æŠ¢èµ°äº†ä¸“åˆ©", effect: { happiness: -10, stress: 15, money: -10000 }, type: 'bad' },
            { text: "åœ¨æµ·è¾¹çœ‹åˆ°äº†ç¾ä¸½çš„æå…‰", effect: { happiness: 15 }, type: 'good', rare: true },
            { text: "è¢«é¢†å¯¼è¦æ±‚åšè¿èƒŒè‰¯å¿ƒçš„äº‹", effect: { happiness: -10, stress: 15 }, type: 'bad', choice: {
                title: "è‰¯å¿ƒæŠ‰æ‹©",
                desc: "é¢†å¯¼è¦æ±‚ä½ åšä¸€ä»¶è¿èƒŒè‰¯å¿ƒçš„äº‹ï¼Œä½ è¯¥æ€ä¹ˆåŠï¼Ÿ",
                options: [
                    { text: "åšå†³æ‹’ç»", effect: { morality: 10, stress: 5 } },
                    { text: "å§”å©‰æ¨è„±", effect: { happiness: -3, stress: 5 } },
                    { text: "è¿å¿ƒç­”åº”", effect: { morality: -10, money: 3000, stress: 15, happiness: -5 } }
                ]
            }},
            { text: "åœ¨å…¬å›­é‡åˆ°äº†ä¸€ä½è´µäºº", effect: { happiness: 5, reputation: 10, money: 5000 }, type: 'good' },
            { text: "è¢«è€æ¿æ¶æ„è§£é›‡", effect: { happiness: -10, stress: 15, job: null }, type: 'bad' },
            { text: "åœ¨å±±é¡¶çœ‹åˆ°äº†ä½›å…‰", effect: { happiness: 15, stress: -15 }, type: 'good', rare: true },
            { text: "è¢«åŒäº‹é›†ä½“æ’æŒ¤", effect: { happiness: -10, stress: 15 }, type: 'bad' },
            { text: "åœ¨æµ·è¾¹æ¡åˆ°äº†ä»·å€¼è¿åŸçš„å®çŸ³", effect: { money: 100000, happiness: 20 }, type: 'good', rare: true },
            { text: "è¢«é¢†å¯¼è¦æ±‚èƒŒé»‘é”…è¿›ç›‘ç‹±", effect: { happiness: -20, stress: 25 }, type: 'bad', choice: {
                title: "ç”Ÿæ­»æŠ‰æ‹©",
                desc: "é¢†å¯¼è¦æ±‚ä½ æ›¿ä»–èƒŒé»‘é”…ï¼Œå¯èƒ½ä¼šè¿›ç›‘ç‹±ï¼Œä½ è¯¥æ€ä¹ˆåŠï¼Ÿ",
                options: [
                    { text: "åšå†³æ‹’ç»", effect: { morality: 15, stress: 10 } },
                    { text: "å‡è£…ç­”åº”ç„¶åä¸¾æŠ¥", effect: { morality: 10, reputation: 10, stress: 10 } },
                    { text: "ç­”åº”èƒŒé»‘é”…", effect: { morality: -20, money: 50000, stress: 30, happiness: -20 } }
                ]
            }},
            { text: "åœ¨å…¬å›­é‡åˆ°äº†æ”¹å˜å‘½è¿çš„æœºé‡", effect: { happiness: 10, money: 50000, reputation: 10 }, type: 'good', rare: true },
            { text: "è¢«è€æ¿é™·å®³å…¥ç‹±", effect: { happiness: -20, stress: 25, reputation: -20 }, type: 'bad', rare: true },
            { text: "åœ¨å±±é¡¶çœ‹åˆ°äº†ç¥ä»™", effect: { happiness: 20, health: 20, stress: -20 }, type: 'good', rare: true },
            { text: "è¢«åŒäº‹è°‹æ€æœªé‚", effect: { health: -30, happiness: -20, stress: 30 }, type: 'bad', rare: true, accident: true },
            { text: "åœ¨æµ·è¾¹é‡åˆ°äº†ç¾äººé±¼", effect: { happiness: 25, appearance: 10 }, type: 'good', rare: true },
            { text: "è¢«é¢†å¯¼è¦æ±‚æ€äººç­å£", effect: { happiness: -25, stress: 35 }, type: 'bad', rare: true, choice: {
                title: "ç”Ÿæ­»æŠ‰æ‹©",
                desc: "é¢†å¯¼è¦æ±‚ä½ æ€äººç­å£ï¼Œä½ è¯¥æ€ä¹ˆåŠï¼Ÿ",
                options: [
                    { text: "æŠ¥è­¦", effect: { morality: 20, stress: 10 } },
                    { text: "é€ƒè·‘", effect: { happiness: -10, stress: 15, money: -10000 } },
                    { text: "æ€äºº", effect: { morality: -50, happiness: -30, stress: 50 } }
                ]
            }},
            { text: "åœ¨å…¬å›­æ¡åˆ°äº†ç¥ç¯", effect: { money: 1000000, happiness: 50 }, type: 'good', rare: true },
            { text: "è¢«å¤–æ˜Ÿäººç»‘æ¶", effect: { intelligence: 30, happiness: -10, stress: 20 }, type: 'neutral', rare: true },
            { text: "åœ¨å±±é¡¶é‡åˆ°äº†ç¥ä»™æŒ‡ç‚¹", effect: { intelligence: 50, happiness: 20, health: 20 }, type: 'good', rare: true },
            { text: "è¢«é›·åŠˆä¸­ä½†è·å¾—äº†è¶…èƒ½åŠ›", effect: { health: 50, happiness: 20, intelligence: 20 }, type: 'good', rare: true },
            { text: "åœ¨æµ·è¾¹å‘ç°äº†æ²‰èˆ¹å®è—", effect: { money: 5000000, happiness: 30 }, type: 'good', rare: true },
            { text: "è¢«è½¦æ’æ­»ä½†é‡ç”Ÿäº†", effect: { age: 0, happiness: 10 }, type: 'neutral', rare: true, rebirth: true },
            { text: "åœ¨å…¬å›­é‡åˆ°äº†æœªæ¥çš„è‡ªå·±", effect: { intelligence: 30, happiness: 10 }, type: 'good', rare: true },
            { text: "è¢«ç¥ä»™æ”¶ä¸ºå¾’å¼Ÿ", effect: { health: 100, happiness: 50, intelligence: 50, money: 1000000 }, type: 'good', rare: true },
            { text: "åœ¨å±±é¡¶é£å‡æˆä»™", effect: { happiness: 100 }, type: 'good', rare: true, immortal: true }
        ];

        // å­£èŠ‚äº‹ä»¶
        const seasonalEvents = {
            spring: [
                { text: "æ˜¥å¤©æ¥äº†ï¼Œä¸‡ç‰©å¤è‹ï¼Œå¿ƒæƒ…ä¹Ÿå˜å¥½äº†ã€‚", effect: { happiness: 3, health: 2 } },
                { text: "ä½ å»èµæ¨±èŠ±ï¼Œæ™¯è‰²å¾ˆç¾ã€‚", effect: { happiness: 5, money: -100 } },
                { text: "æ˜¥å›°æ¥è¢­ï¼Œæ€»æ˜¯æƒ³ç¡è§‰ã€‚", effect: { energy: -10 } },
                { text: "èŠ±ç²‰è¿‡æ•ï¼Œæ‰“å–·åšä¸åœã€‚", effect: { health: -3, happiness: -2 } }
            ],
            summer: [
                { text: "å¤å¤©åˆ°äº†ï¼Œå¤©æ°”è¶Šæ¥è¶Šçƒ­ã€‚", effect: { health: -2 } },
                { text: "ä½ å»æµ·è¾¹æ¸¸æ³³ï¼Œç©å¾—å¾ˆå¼€å¿ƒã€‚", effect: { happiness: 8, health: 3, money: -300 } },
                { text: "ç©ºè°ƒåäº†ï¼Œçƒ­å¾—ç¡ä¸ç€ã€‚", effect: { happiness: -3, health: -2 } },
                { text: "åƒäº†å¾ˆå¤šå†°æ·‡æ·‹ï¼Œå¾ˆæ»¡è¶³ã€‚", effect: { happiness: 5, health: -2, money: -50 } }
            ],
            autumn: [
                { text: "ç§‹å¤©æ¥äº†ï¼Œå¤©æ°”å‡‰çˆ½å®œäººã€‚", effect: { happiness: 3, health: 2 } },
                { text: "ä½ å»çˆ¬å±±ï¼Œçœ‹åˆ°äº†çº¢å¶ã€‚", effect: { happiness: 5, health: 3, money: -100 } },
                { text: "ç§‹é«˜æ°”çˆ½ï¼Œå­¦ä¹ æ•ˆç‡å¾ˆé«˜ã€‚", effect: { intelligence: 2 } },
                { text: "ä¸­ç§‹èŠ‚å’Œå®¶äººå›¢èšï¼Œåƒæœˆé¥¼ã€‚", effect: { happiness: 8, money: -200 } }
            ],
            winter: [
                { text: "å†¬å¤©åˆ°äº†ï¼Œå¤©æ°”å¾ˆå†·ã€‚", effect: { health: -2 } },
                { text: "ä¸‹é›ªäº†ï¼Œä½ å †äº†ä¸€ä¸ªé›ªäººã€‚", effect: { happiness: 5 } },
                { text: "åœ£è¯èŠ‚æ”¶åˆ°äº†ç¤¼ç‰©ã€‚", effect: { happiness: 5, money: -300 } },
                { text: "è¿‡å¹´å›å®¶ï¼Œå’Œå®¶äººå›¢èšã€‚", effect: { happiness: 10, money: -1000 } },
                { text: "æ„Ÿå†’å‘çƒ§äº†ï¼Œéœ€è¦ä¼‘æ¯ã€‚", effect: { health: -10, happiness: -3, money: -300 } }
            ]
        };

        // ä»»åŠ¡æ•°æ®åº“
        const questsDB = [
            { id: 'edu_primary', title: 'å®Œæˆå°å­¦å­¦ä¸š', desc: 'é€šè¿‡å°å­¦æ‰€æœ‰è€ƒè¯•', condition: (p, g) => p.age >= 12, reward: { intelligence: 5, happiness: 5 } },
            { id: 'edu_middle', title: 'å®Œæˆåˆä¸­å­¦ä¸š', desc: 'é€šè¿‡ä¸­è€ƒ', condition: (p, g) => p.age >= 15, reward: { intelligence: 8, happiness: 5 } },
            { id: 'edu_high', title: 'å®Œæˆé«˜ä¸­å­¦ä¸š', desc: 'é€šè¿‡é«˜è€ƒ', condition: (p, g) => p.age >= 18, reward: { intelligence: 10, happiness: 10 } },
            { id: 'edu_college', title: 'å¤§å­¦æ¯•ä¸š', desc: 'è·å¾—å­¦å£«å­¦ä½', condition: (p, g) => p.education.includes('å¤§å­¦'), reward: { intelligence: 15, reputation: 5 } },
            { id: 'first_job', title: 'ç¬¬ä¸€ä»½å·¥ä½œ', desc: 'æ‰¾åˆ°ä¸€ä»½å·¥ä½œ', condition: (p, g) => p.job !== null, reward: { money: 1000, happiness: 5 } },
            { id: 'promotion', title: 'å‡èŒåŠ è–ª', desc: 'è·å¾—ä¸€æ¬¡æ™‹å‡', condition: (p, g) => g.promotionCount >= 1, reward: { money: 5000, reputation: 5 } },
            { id: 'first_love', title: 'åˆæ‹', desc: 'å¼€å§‹ç¬¬ä¸€æ®µæ‹æƒ…', condition: (p, g) => g.loverCount >= 1, reward: { happiness: 10 } },
            { id: 'marriage', title: 'æ­¥å…¥å©šå§»', desc: 'ç»“å©š', condition: (p, g) => g.relations.some(r => r.type === 'é…å¶'), reward: { happiness: 15 } },
            { id: 'first_house', title: 'ä¹°æˆ¿', desc: 'è´­ä¹°ç¬¬ä¸€å¥—æˆ¿å­', condition: (p, g) => p.properties.some(prop => prop.includes('æˆ¿')), reward: { happiness: 10 } },
            { id: 'first_car', title: 'ä¹°è½¦', desc: 'è´­ä¹°ç¬¬ä¸€è¾†è½¦', condition: (p, g) => p.properties.some(prop => prop.includes('è½¦')), reward: { happiness: 5 } },
            { id: 'have_child', title: 'ä¸ºäººçˆ¶æ¯', desc: 'æ‹¥æœ‰å­©å­', condition: (p, g) => g.relations.some(r => r.type === 'å­å¥³'), reward: { happiness: 20 } },
            { id: 'travel_5', title: 'æ—…è¡Œå®¶', desc: 'å»è¿‡5ä¸ªåœ°æ–¹', condition: (p, g) => g.travelCount >= 5, reward: { happiness: 10, intelligence: 3 } },
            { id: 'skill_3', title: 'å¤šæ‰å¤šè‰º', desc: 'æŒæ¡3ä¸ªæŠ€èƒ½', condition: (p, g) => Object.keys(p.skills).length >= 3, reward: { intelligence: 5 } },
            { id: 'rich_10k', title: 'ä¸‡å…ƒæˆ·', desc: 'èµ„äº§è¾¾åˆ°1ä¸‡', condition: (p, g) => p.money >= 10000, reward: { happiness: 5 } },
            { id: 'healthy_80', title: 'å¥åº·é•¿å¯¿', desc: 'å¥åº·è¾¾åˆ°80', condition: (p, g) => p.health >= 80, reward: { happiness: 5 } },
            { id: 'happy_80', title: 'å¿«ä¹äººç”Ÿ', desc: 'å¿«ä¹è¾¾åˆ°80', condition: (p, g) => p.happiness >= 80, reward: { health: 5 } },
            { id: 'smart_80', title: 'èªæ˜äºº', desc: 'æ™ºåŠ›è¾¾åˆ°80', condition: (p, g) => p.intelligence >= 80, reward: { reputation: 5 } },
            { id: 'pretty_80', title: 'é¢œå€¼æ‹…å½“', desc: 'é­…åŠ›è¾¾åˆ°80', condition: (p, g) => p.appearance >= 80, reward: { happiness: 5 } }
        ];

        // ==================== æ¸¸æˆæ ¸å¿ƒå‡½æ•° ====================

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            // åˆ›å»ºç²’å­èƒŒæ™¯
            createParticles();
            // æ¸²æŸ“å¤©èµ‹é€‰æ‹©
            renderTalentSelection();
            // åˆå§‹åŒ–æŠ€èƒ½
            initSkills();
        }

        // åˆ›å»ºç²’å­èƒŒæ™¯
        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (10 + Math.random() * 10) + 's';
                container.appendChild(particle);
            }
        }

        // æ¸²æŸ“å¤©èµ‹é€‰æ‹©
        function renderTalentSelection() {
            const grid = document.getElementById('talentGrid');
            grid.innerHTML = talentsDB.map((talent, idx) => `
                <div class="talent-card ${talent.rarity}" onclick="toggleTalent(${idx})" id="talent-${idx}">
                    <div class="talent-name">${talent.name}</div>
                    <div class="talent-desc">${talent.desc}</div>
                </div>
            `).join('');
        }

        // åˆ‡æ¢å¤©èµ‹é€‰æ‹©ï¼ˆå¢åŠ é™åˆ¶é€»è¾‘ï¼‰
        function toggleTalent(idx) {
            const card = document.getElementById(`talent-${idx}`);
            const talent = talentsDB[idx];
            
            // å¦‚æœå·²é€‰ä¸­ï¼Œåˆ™å–æ¶ˆé€‰æ‹©
            if (gameState.selectedTalents.includes(idx)) {
                gameState.selectedTalents = gameState.selectedTalents.filter(i => i !== idx);
                card.classList.remove('selected');
                return;
            }
            
            // æ£€æŸ¥æ€»æ•°é‡é™åˆ¶ï¼ˆæœ€å¤š3ä¸ªï¼‰
            if (gameState.selectedTalents.length >= 3) {
                showNotification('æœ€å¤šåªèƒ½é€‰æ‹©3ä¸ªå¤©èµ‹ï¼', 'bad');
                return;
            }
            
            // æ£€æŸ¥çº¢è‰²å¤©èµ‹ï¼ˆlegendaryï¼‰é™åˆ¶ - æœ€å¤š1ä¸ª
            if (talent.rarity === 'legendary') {
                const hasLegendary = gameState.selectedTalents.some(i => talentsDB[i].rarity === 'legendary');
                if (hasLegendary) {
                    showNotification('çº¢è‰²å¤©èµ‹æœ€å¤šåªèƒ½é€‰æ‹©ä¸€ä¸ªï¼', 'bad');
                    return;
                }
                
                // æ£€æŸ¥ç»ä¸–å¤©æ‰ã€å¯ŒäºŒä»£ã€å¤©é€‰ä¹‹å­çš„äº’æ–¥
                const exclusiveIds = ['genius', 'rich2g', 'lucky'];
                if (exclusiveIds.includes(talent.id)) {
                    const hasExclusive = gameState.selectedTalents.some(i => {
                        const t = talentsDB[i];
                        return exclusiveIds.includes(t.id);
                    });
                    if (hasExclusive) {
                        showNotification('ç»ä¸–å¤©æ‰ã€å¯ŒäºŒä»£ã€å¤©é€‰ä¹‹å­ä¸­æœ€å¤šåªèƒ½é€‰æ‹©ä¸€ä¸ªï¼', 'bad');
                        return;
                    }
                }
            }
            
            gameState.selectedTalents.push(idx);
            card.classList.add('selected');
        }

        // é€‰æ‹©æ€§åˆ«
        function selectGender(gender) {
            gameState.player.gender = gender;
            document.querySelectorAll('.gender-btn').forEach(btn => btn.classList.remove('selected'));
            document.getElementById(gender === 'ç”·' ? 'maleBtn' : 'femaleBtn').classList.add('selected');
        }

        // åˆå§‹åŒ–æŠ€èƒ½
        function initSkills() {
            const allSkills = [];
            Object.values(skillsDB).forEach(category => {
                category.skills.forEach(skill => {
                    allSkills.push(skill);
                });
            });
            
            // éšæœºåˆå§‹åŒ–ä¸€äº›æŠ€èƒ½ä¸º1çº§
            const shuffled = allSkills.sort(() => 0.5 - Math.random());
            shuffled.slice(0, 3).forEach(skill => {
                gameState.player.skills[skill.id] = 1;
            });
        }

        // å¼€å§‹æ¸¸æˆ
        function startGame() {
            const name = document.getElementById('playerName').value.trim();
            if (!name) {
                showNotification('è¯·è¾“å…¥ä½ çš„åå­—ï¼', 'bad');
                return;
            }
            if (!gameState.player.gender) {
                showNotification('è¯·é€‰æ‹©æ€§åˆ«ï¼', 'bad');
                return;
            }

            gameState.player.name = name;
            
            // åº”ç”¨é€‰ä¸­çš„å¤©èµ‹
            gameState.selectedTalents.forEach(idx => {
                const talent = talentsDB[idx];
                gameState.player.talents.push(talent);
                talent.effect(gameState.player);
            });

            // åˆå§‹åŒ–å…³ç³»
            gameState.player.relations = [
                { name: 'çˆ¶äº²', type: 'å®¶äºº', closeness: 80, avatar: 'ğŸ‘¨' },
                { name: 'æ¯äº²', type: 'å®¶äºº', closeness: 85, avatar: 'ğŸ‘©' }
            ];

            // åˆå§‹åŒ–ä»»åŠ¡
            gameState.player.quests = questsDB.filter(q => ['edu_primary', 'first_job', 'first_love'].includes(q.id));

            // åˆ‡æ¢ç•Œé¢
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'block';

            // æ›´æ–°æ˜¾ç¤º
            updateDisplay();
            updateSkillList();
            updateRelationList();
            updateQuestList();
            updateTalentDisplay();

            showNotification('æ¸¸æˆå¼€å§‹ï¼ç¥ä½ æœ‰ä¸ªç²¾å½©çš„äººç”Ÿï¼', 'good');
            addEvent('å‡ºç”Ÿ', 'ä½ æ¥åˆ°äº†è¿™ä¸ªä¸–ç•Œï¼Œçˆ¶æ¯æ»¡æ€€æœŸå¾…åœ°çœ‹ç€ä½ ã€‚', 'good');
        }

        // å…‘æ¢ç åŠŸèƒ½
        function redeemCode() {
            const input = document.getElementById('redeemCodeInput');
            const code = input.value.trim().toUpperCase();
            const p = gameState.player;
            
            if (!code) return;
            
            // æ£€æŸ¥æ˜¯å¦å·²å…‘æ¢è¿‡
            if (gameState.player.redeemedCodes.includes(code)) {
                showNotification('è¯¥å…‘æ¢ç å·²ä½¿ç”¨è¿‡ï¼', 'bad');
                input.value = '';
                return;
            }
            
            let success = false;
            let effects = [];
            
            switch(code) {
                case 'LX520':
                case 'LX1314':
                    p.money += 1314;
                    p.health += 20;
                    p.energy += 20;
                    p.reputation += 20;
                    p.stress -= 20;
                    p.appearance += 10;
                    effects = ['é‡‘é’±+1314', 'å¥åº·+20', 'ä½“åŠ›+20', 'å£°æœ›+20', 'å‹åŠ›-20', 'é­…åŠ›+10'];
                    success = true;
                    break;
                case 'STN666':
                    p.money += 666;
                    p.energy += 20;
                    effects = ['é‡‘é’±+666', 'ä½“åŠ›+20'];
                    success = true;
                    break;
                case 'VIP6666':
                    p.money += 200;
                    effects = ['é‡‘é’±+200'];
                    success = true;
                    break;
                case 'VIP8888':
                    p.money += 300;
                    effects = ['é‡‘é’±+300'];
                    success = true;
                    break;
                case '666':
                    p.intelligence += 10;
                    effects = ['æ™ºåŠ›+10'];
                    success = true;
                    break;
                case 'SVIP999':
                case 'SVIP000':
                    p.money += 300;
                    effects = ['é‡‘é’±+300'];
                    success = true;
                    break;
                case 'LX':
                    p.money += 200;
                    effects = ['é‡‘é’±+200'];
                    success = true;
                    break;
                default:
                    showNotification('æ— æ•ˆçš„å…‘æ¢ç ï¼', 'bad');
                    return;
            }
            
            if (success) {
                gameState.player.redeemedCodes.push(code);
                showNotification(`å…‘æ¢æˆåŠŸï¼${effects.join('ï¼Œ')}`, 'good');
                updateDisplay();
                input.value = '';
                addEvent('ç³»ç»Ÿ', `ä½¿ç”¨äº†å…‘æ¢ç ï¼Œè·å¾—ï¼š${effects.join('ï¼Œ')}`, 'good');
            }
        }

        // æ›´æ–°æ˜¾ç¤º
        function updateDisplay() {
            const p = gameState.player;
            
            // åŸºæœ¬ä¿¡æ¯
            document.getElementById('displayName').textContent = p.name;
            document.getElementById('ageBadge').textContent = `${p.age}å²`;
            document.getElementById('timeDisplay').textContent = `ç¬¬${p.age}å¹´ ${p.month}æœˆ`;
            
            // å·¥ä½œæ ‡ç­¾
            const jobBadge = document.getElementById('jobBadge');
            if (p.job) {
                jobBadge.style.display = 'inline-block';
                jobBadge.textContent = p.job.name || 'æœ‰å·¥ä½œ';
            } else {
                jobBadge.style.display = 'none';
            }

            // æ•™è‚²æ ‡ç­¾
            const eduBadge = document.getElementById('eduBadge');
            if (p.education) {
                eduBadge.style.display = 'inline-block';
                eduBadge.textContent = p.education;
            }

            // å¤´åƒ
            updateAvatar();

            // å±æ€§æ¡
            updateStat('health', p.health, 100);
            updateStat('happiness', p.happiness, 100);
            updateStat('intelligence', p.intelligence, 100);
            updateStat('appearance', p.appearance, 100);
            updateStat('energy', p.energy, 100);
            updateStat('morality', p.morality + 50, 100); // é“å¾·èŒƒå›´-50~50ï¼Œæ˜¾ç¤º0~100
            updateStat('reputation', p.reputation, 100);
            updateStat('stress', p.stress, 100);

            // èµ„é‡‘
            document.getElementById('moneyDisplay').textContent = `Â¥${p.money.toLocaleString()}`;
            document.getElementById('incomeDisplay').textContent = `Â¥${p.income.toLocaleString()}`;

            // æ£€æŸ¥æ­»äº¡
            checkDeath();
            
            // æ£€æŸ¥æˆå°±
            checkAchievements();
            
            // æ£€æŸ¥ä»»åŠ¡
            checkQuests();
        }

        // æ›´æ–°å¤´åƒ
        function updateAvatar() {
            const p = gameState.player;
            const avatar = document.getElementById('playerAvatar');
            
            if (p.age < 3) avatar.textContent = 'ğŸ‘¶';
            else if (p.age < 7) avatar.textContent = p.gender === 'ç”·' ? 'ğŸ‘¦' : 'ğŸ‘§';
            else if (p.age < 13) avatar.textContent = p.gender === 'ç”·' ? 'ğŸ§’' : 'ğŸ‘§';
            else if (p.age < 18) avatar.textContent = p.gender === 'ç”·' ? 'ğŸ‘¨â€ğŸ“' : 'ğŸ‘©â€ğŸ“';
            else if (p.age < 30) avatar.textContent = p.gender === 'ç”·' ? 'ğŸ‘¨â€ğŸ’¼' : 'ğŸ‘©â€ğŸ’¼';
            else if (p.age < 50) avatar.textContent = p.gender === 'ç”·' ? 'ğŸ‘¨' : 'ğŸ‘©';
            else if (p.age < 70) avatar.textContent = p.gender === 'ç”·' ? 'ğŸ‘¨â€ğŸ¦³' : 'ğŸ‘©â€ğŸ¦³';
            else avatar.textContent = p.gender === 'ç”·' ? 'ğŸ‘´' : 'ğŸ‘µ';
        }

        // æ›´æ–°å±æ€§æ¡
        function updateStat(name, value, max) {
            value = Math.max(0, Math.min(value, max));
            document.getElementById(name + 'Value').textContent = Math.floor(value);
            document.getElementById(name + 'Bar').style.width = (value / max * 100) + '%';
            gameState.player[name] = value;
        }

        // æ›´æ–°æŠ€èƒ½åˆ—è¡¨
        function updateSkillList() {
            const list = document.getElementById('skillList');
            const skills = gameState.player.skills;
            
            if (Object.keys(skills).length === 0) {
                list.innerHTML = '<p style="color: rgba(255,255,255,0.5);">è¿˜æ²¡æœ‰å­¦ä¼šä»»ä½•æŠ€èƒ½</p>';
                return;
            }

            list.innerHTML = Object.entries(skills).map(([id, level]) => {
                const skillInfo = getSkillInfo(id);
                return `
                    <div class="skill-item">
                        <span class="skill-name">${skillInfo.name}</span>
                        <div class="skill-level">
                            ${Array(5).fill(0).map((_, i) => `
                                <span class="skill-star ${i < level ? '' : 'empty'}">â˜…</span>
                            `).join('')}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // è·å–æŠ€èƒ½ä¿¡æ¯
        function getSkillInfo(id) {
            for (const category of Object.values(skillsDB)) {
                const skill = category.skills.find(s => s.id === id);
                if (skill) return skill;
            }
            return { name: id, desc: '' };
        }

        // æ›´æ–°å…³ç³»åˆ—è¡¨
        function updateRelationList() {
            const list = document.getElementById('relationList');
            const relations = gameState.player.relations;
            
            if (relations.length === 0) {
                list.innerHTML = '<p style="color: rgba(255,255,255,0.5);">è¿˜æ²¡æœ‰å»ºç«‹äººé™…å…³ç³»</p>';
                return;
            }

            list.innerHTML = relations.slice(0, 5).map(rel => `
                <div class="relation-item">
                    <div class="relation-avatar">${rel.avatar || 'ğŸ‘¤'}</div>
                    <div class="relation-info">
                        <div class="relation-name">${rel.name}</div>
                        <div class="relation-type">${rel.type}</div>
                    </div>
                    <div class="relation-closeness">${rel.closeness}%</div>
                </div>
            `).join('');
        }

        // æ›´æ–°ä»»åŠ¡åˆ—è¡¨
        function updateQuestList() {
            const list = document.getElementById('questList');
            const quests = gameState.player.quests;
            
            if (quests.length === 0) {
                list.innerHTML = '<p style="color: rgba(255,255,255,0.5);">å½“å‰æ²¡æœ‰ä»»åŠ¡</p>';
                return;
            }

            list.innerHTML = quests.slice(0, 3).map(quest => `
                <div class="quest-item">
                    <div class="quest-title">${quest.title}</div>
                    <div class="quest-desc">${quest.desc}</div>
                </div>
            `).join('');
        }

        // æ›´æ–°å¤©èµ‹æ˜¾ç¤º
        function updateTalentDisplay() {
            const display = document.getElementById('talentDisplay');
            const talents = gameState.player.talents;
            
            if (talents.length === 0) {
                display.innerHTML = '<p style="color: rgba(255,255,255,0.5);">æ²¡æœ‰ç‰¹æ®Šå¤©èµ‹</p>';
                return;
            }

            display.innerHTML = talents.map(t => `
                <span style="display: inline-block; padding: 4px 10px; margin: 2px; background: linear-gradient(135deg, #f5af19, #f12711); border-radius: 12px; font-size: 0.8em;">${t.name}</span>
            `).join('');
        }

        // æ·»åŠ äº‹ä»¶åˆ°æ—¥å¿—
        function addEvent(time, text, type = 'neutral') {
            const log = document.getElementById('eventLog');
            const item = document.createElement('div');
            item.className = `event-item event-type-${type}`;
            item.innerHTML = `<span class="event-time">${time}ï¼š</span><span>${text}</span>`;
            log.insertBefore(item, log.firstChild);
            
            // é™åˆ¶æ—¥å¿—æ•°é‡
            while (log.children.length > 100) {
                log.removeChild(log.lastChild);
            }
        }

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(text, type = 'info') {
            const container = document.getElementById('notificationContainer');
            const notif = document.createElement('div');
            notif.className = 'notification';
            notif.style.borderLeftColor = type === 'good' ? '#27ae60' : type === 'bad' ? '#e74c3c' : '#667eea';
            notif.textContent = text;
            container.appendChild(notif);
            
            setTimeout(() => {
                notif.style.opacity = '0';
                setTimeout(() => notif.remove(), 300);
            }, 3000);
        }

        // æ˜¾ç¤ºæµ®åŠ¨æ–‡å­—
        function showFloatText(text, x, y, color) {
            const el = document.createElement('div');
            el.className = 'float-text';
            el.textContent = text;
            el.style.color = color;
            el.style.left = x + 'px';
            el.style.top = y + 'px';
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 1000);
        }

        // ä¸‹ä¸ªæœˆ
        function nextMonth() {
            if (!gameState.isAlive) return;

            const p = gameState.player;
            p.month++;
            
            if (p.month > 12) {
                p.month = 1;
                p.age++;
                // å¹´åº¦è¡°å‡
                yearlyDecay();
            }

            // æ¢å¤ä½“åŠ›
            let energyRecovery = 10;
            if (hasTalent('earlybird')) energyRecovery += 3;
            p.energy = Math.min(100, p.energy + energyRecovery);

            // è§¦å‘äº‹ä»¶
            triggerEvent();

            // ç»´æŠ¤å…³ç³»
            maintainRelations();

            // è·å¾—æ”¶å…¥
            if (p.income > 0) {
                p.money += p.income;
                showFloatText(`+Â¥${p.income}`, window.innerWidth / 2, window.innerHeight / 2, '#f5af19');
            }

            updateDisplay();
        }

        // å¹´åº¦è¡°å‡
        function yearlyDecay() {
            const p = gameState.player;
            
            // å¹´é¾„å¥åº·æ¶ˆè€—
            if (p.age > 30) p.health -= 2;
            if (p.age > 40) p.health -= 3;
            if (p.age > 50) p.health -= 5;
            if (p.age > 60) p.health -= 8;
            if (p.age > 70) p.health -= 12;
            if (p.age > 80) p.health -= 15;

            // å‹åŠ›æ¢å¤
            p.stress = Math.max(0, p.stress - 5);

            // å¿«ä¹è‡ªç„¶è¡°å‡
            if (!hasTalent('optimist')) {
                p.happiness = Math.max(0, p.happiness - 2);
            }
        }

        // è§¦å‘äº‹ä»¶
        function triggerEvent() {
            const p = gameState.player;
            const age = p.age;
            let events = [];

            // æ ¹æ®å¹´é¾„æ®µé€‰æ‹©äº‹ä»¶æ± 
            if (age < 4) events = babyEvents;
            else if (age < 7) events = toddlerEvents;
            else if (age < 13) events = childhoodEvents;
            else if (age < 19) events = teenEvents;
            else if (age < 31) events = youngAdultEvents;
            else if (age < 51) events = middleAgeEvents;
            else events = elderlyEvents;

            // æ·»åŠ å­£èŠ‚äº‹ä»¶
            const season = getSeason(p.month);
            events = events.concat(seasonalEvents[season]);

            // æ·»åŠ éšæœºäº‹ä»¶ï¼ˆæ¦‚ç‡è§¦å‘ï¼‰
            if (Math.random() < 0.3) {
                let randomPool = randomEvents;
                if (hasTalent('lucky')) {
                    // å¹¸è¿å„¿æ›´å®¹æ˜“è§¦å‘å¥½äº‹
                    randomPool = randomEvents.filter(e => e.type === 'good' || Math.random() > 0.5);
                }
                if (hasTalent('lucky_common')) {
                    randomPool = randomEvents.filter(e => e.type === 'good' || Math.random() > 0.3);
                }
                
                // ç¨€æœ‰äº‹ä»¶æ¦‚ç‡
                const rareEvents = randomPool.filter(e => e.rare);
                const normalEvents = randomPool.filter(e => !e.rare);
                
                if (Math.random() < 0.01 && rareEvents.length > 0) {
                    events = events.concat(rareEvents);
                } else {
                    events = events.concat(normalEvents);
                }
            }

            // é€‰æ‹©äº‹ä»¶
            const event = events[Math.floor(Math.random() * events.length)];
            
            // å¤„ç†é€‰æ‹©äº‹ä»¶
            if (event.choice) {
                showChoice(event);
                return;
            }

            // åº”ç”¨äº‹ä»¶æ•ˆæœ
            applyEventEffects(event);

            // æ·»åŠ äº‹ä»¶åˆ°æ—¥å¿—
            const time = `ç¬¬${p.age}å¹´${p.month}æœˆ`;
            addEvent(time, event.text, event.type || 'neutral');

            // è®°å½•å†å²
            gameState.history.push(event.text);

            // è§¦å‘é¢å¤–æ•ˆæœ
            if (event.addRelation) {
                const newRel = {
                    name: generateRandomName(event.addRelation.type),
                    ...event.addRelation,
                    avatar: getRelationAvatar(event.addRelation.type)
                };
                p.relations.push(newRel);
                showNotification(`ç»“è¯†äº†æ–°çš„${newRel.type}ï¼š${newRel.name}`, 'good');
            }

            if (event.skillGain) {
                gainSkill(event.skillGain);
            }

            if (event.book) {
                gameState.bookCount = (gameState.bookCount || 0) + 1;
            }

            if (event.travel) {
                gameState.travelCount = (gameState.travelCount || 0) + 1;
            }

            if (event.food) {
                gameState.foodCount = (gameState.foodCount || 0) + 1;
            }

            if (event.lottery === 'big') {
                gameState.lotteryWinBig = true;
            }

            if (event.accident) {
                gameState.accidentCount = (gameState.accidentCount || 0) + 1;
            }

            if (event.love) {
                gameState.loverCount = (gameState.loverCount || 0) + 1;
            }

            if (event.breakup) {
                // ç§»é™¤æ‹äººå…³ç³»
                p.relations = p.relations.filter(r => r.type !== 'æ‹äºº');
            }

            if (event.marry) {
                // å°†æ‹äººè½¬ä¸ºé…å¶
                const lover = p.relations.find(r => r.type === 'æ‹äºº');
                if (lover) {
                    lover.type = 'é…å¶';
                    lover.closeness = 90;
                }
            }

            if (event.divorce) {
                gameState.divorced = true;
                p.relations = p.relations.filter(r => r.type !== 'é…å¶');
            }

            if (event.baby) {
                const babyName = generateRandomName('å­å¥³');
                p.relations.push({
                    name: babyName,
                    type: 'å­å¥³',
                    closeness: 90,
                    avatar: 'ğŸ‘¶'
                });
            }

            if (event.job) {
                setJob(event.job, event.level || 0);
            }

            if (event.education) {
                p.education = event.education;
            }

            if (event.promotion) {
                gameState.promotionCount = (gameState.promotionCount || 0) + 1;
                promoteJob();
            }

            if (event.property) {
                p.properties.push(event.property);
            }

            if (event.retire) {
                p.job = null;
                p.income = 0;
            }

            if (event.rebirth) {
                gameState.rebirthCount = (gameState.rebirthCount || 0) + 1;
            }

            if (event.immortal) {
                gameState.isAlive = false;
                setTimeout(() => gameOver('é£å‡æˆä»™ï¼Œæ°¸ç”Ÿä¸ç­'), 1000);
                return;
            }
        }

        // è·å–å­£èŠ‚
        function getSeason(month) {
            if (month >= 3 && month <= 5) return 'spring';
            if (month >= 6 && month <= 8) return 'summer';
            if (month >= 9 && month <= 11) return 'autumn';
            return 'winter';
        }

        // åº”ç”¨äº‹ä»¶æ•ˆæœ
        function applyEventEffects(event) {
            const p = gameState.player;
            if (event.effect) {
                Object.entries(event.effect).forEach(([key, value]) => {
                    if (key === 'job') {
                        setJob(value, 0);
                    } else if (key === 'education') {
                        p.education = value;
                    } else {
                        p[key] = (p[key] || 0) + value;
                    }
                });

                // é™åˆ¶å±æ€§èŒƒå›´
                p.health = Math.max(0, Math.min(100, p.health));
                p.happiness = Math.max(0, Math.min(100, p.happiness));
                p.intelligence = Math.max(0, Math.min(100, p.intelligence));
                p.appearance = Math.max(0, Math.min(100, p.appearance));
                p.energy = Math.max(0, Math.min(100, p.energy));
                p.morality = Math.max(-50, Math.min(50, p.morality));
                p.reputation = Math.max(0, Math.min(100, p.reputation));
                p.stress = Math.max(0, Math.min(100, p.stress));
            }
        }

        // æ˜¾ç¤ºé€‰æ‹©å¯¹è¯æ¡†
        function showChoice(event) {
            const modal = document.getElementById('choiceModal');
            document.getElementById('choiceTitle').textContent = event.choice.title;
            document.getElementById('choiceDesc').textContent = event.choice.desc;
            
            const btnContainer = document.getElementById('choiceButtons');
            btnContainer.innerHTML = '';
            
            event.choice.options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'choice-btn';
                
                let effectText = [];
                Object.entries(opt.effect).forEach(([key, value]) => {
                    if (key !== 'job') {
                        const sign = value > 0 ? '+' : '';
                        effectText.push(`${getStatName(key)}${sign}${value}`);
                    }
                });
                
                btn.innerHTML = `
                    <strong>${opt.text}</strong>
                    <div class="choice-effect">${effectText.join('ï¼Œ')}</div>
                `;
                
                btn.onclick = () => {
                    applyEventEffects({ effect: opt.effect });
                    if (opt.effect.job) {
                        setJob(opt.effect.job, 0);
                    }
                    addEvent(`ç¬¬${gameState.player.age}å¹´${gameState.player.month}æœˆ`, `ä½ é€‰æ‹©äº†ï¼š${opt.text}`, 'neutral');
                    modal.classList.remove('active');
                    updateDisplay();
                };
                
                btnContainer.appendChild(btn);
            });
            
            modal.classList.add('active');
        }

        // è·å–å±æ€§å
        function getStatName(key) {
            const names = {
                health: 'å¥åº·', happiness: 'å¿«ä¹', intelligence: 'æ™ºåŠ›',
                appearance: 'é­…åŠ›', energy: 'ä½“åŠ›', money: 'é‡‘é’±',
                morality: 'é“å¾·', reputation: 'å£°æœ›', stress: 'å‹åŠ›'
            };
            return names[key] || key;
        }

        // ç”Ÿæˆéšæœºåå­—
        function generateRandomName(type) {
            const surnames = ['æ', 'ç‹', 'å¼ ', 'åˆ˜', 'é™ˆ', 'æ¨', 'èµµ', 'é»„', 'å‘¨', 'å´', 'å¾', 'å­™', 'é©¬', 'æœ±', 'èƒ¡', 'éƒ­', 'æ—', 'ä½•', 'é«˜', 'ç½—'];
            const maleNames = ['ä¼Ÿ', 'å¼º', 'ç£Š', 'å†›', 'æ´‹', 'å‹‡', 'æ°', 'æ¶›', 'æ˜', 'è¶…', 'ç§€', 'å', 'é¹', 'é£', 'ä¿Š'];
            const femaleNames = ['èŠ³', 'å¨œ', 'æ•', 'é™', 'ä¸½', 'å¼º', 'æ´', 'é›ª', 'é¢–', 'æ…§', 'å¨Ÿ', 'è‰³', 'ç‡•', 'ç²', 'æ¢…'];
            
            const surname = surnames[Math.floor(Math.random() * surnames.length)];
            let name;
            
            if (type === 'å­å¥³') {
                name = Math.random() > 0.5 ? maleNames[Math.floor(Math.random() * maleNames.length)] : femaleNames[Math.floor(Math.random() * femaleNames.length)];
            } else if (type === 'æ‹äºº' || type === 'é…å¶') {
                if (gameState.player.gender === 'ç”·') {
                    name = femaleNames[Math.floor(Math.random() * femaleNames.length)];
                } else {
                    name = maleNames[Math.floor(Math.random() * maleNames.length)];
                }
            } else {
                name = Math.random() > 0.5 ? maleNames[Math.floor(Math.random() * maleNames.length)] : femaleNames[Math.floor(Math.random() * femaleNames.length)];
            }
            
            return surname + name;
        }

        // è·å–å…³ç³»å¤´åƒ
        function getRelationAvatar(type) {
            const avatars = {
                'å®¶äºº': 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§', 'æœ‹å‹': 'ğŸ‘«', 'æ‹äºº': 'ğŸ’•', 'é…å¶': 'ğŸ’‘', 'å­å¥³': 'ğŸ‘¶',
                'åŒäº‹': 'ğŸ’¼', 'ä¸Šå¸': 'ğŸ‘”', 'ä¸‹å±': 'ğŸ™‹', 'å®¢æˆ·': 'ğŸ¤', 'ç«äº‰å¯¹æ‰‹': 'âš”ï¸'
            };
            return avatars[type] || 'ğŸ‘¤';
        }

        // ç»´æŠ¤å…³ç³»
        function maintainRelations() {
            const p = gameState.player;
            p.relations.forEach(rel => {
                if (Math.random() > 0.7) {
                    rel.closeness -= 2;
                }
            });
            p.relations = p.relations.filter(r => r.closeness > 0);
        }

        // è®¾ç½®å·¥ä½œï¼ˆå¢åŠ å¹´é¾„æ£€æŸ¥ï¼‰
        function setJob(jobType, level) {
            const career = careersDB[jobType];
            if (!career) return;
            
            // æ£€æŸ¥å¹´é¾„é™åˆ¶
            const p = gameState.player;
            if (career.minAge && p.age < career.minAge) {
                showNotification(`å¹´é¾„ä¸ç¬¦åˆè¦æ±‚ï¼è¯¥èŒä¸šéœ€è¦è‡³å°‘${career.minAge}å²`, 'bad');
                return;
            }
            if (career.maxAge && p.age > career.maxAge) {
                showNotification(`å¹´é¾„ä¸ç¬¦åˆè¦æ±‚ï¼è¯¥èŒä¸šæœ€å¤§å¹´é¾„é™åˆ¶ä¸º${career.maxAge}å²`, 'bad');
                return;
            }
            
            gameState.player.job = {
                type: jobType,
                name: career.name,
                level: level,
                levelName: career.levels[level] || career.levels[career.levels.length - 1]
            };
            
            gameState.player.income = career.salaries[level] || 0;
        }

        // æ™‹å‡
        function promoteJob() {
            const p = gameState.player;
            if (!p.job) return;
            
            const career = careersDB[p.job.type];
            if (!career) return;
            
            if (p.job.level < career.levels.length - 1) {
                p.job.level++;
                p.job.levelName = career.levels[p.job.level];
                p.income = career.salaries[p.job.level];
                showNotification(`æ­å–œæ™‹å‡ï¼ä½ ç°åœ¨æ˜¯${p.job.levelName}äº†ï¼`, 'good');
            }
        }

        // è·å¾—æŠ€èƒ½
        function gainSkill(skillId) {
            const p = gameState.player;
            if (!p.skills[skillId]) {
                p.skills[skillId] = 1;
            } else if (p.skills[skillId] < 5) {
                p.skills[skillId]++;
            }
            updateSkillList();
        }

        // æ£€æŸ¥æ˜¯å¦æœ‰æŸä¸ªå¤©èµ‹
        function hasTalent(talentId) {
            return gameState.player.talents.some(t => t.id === talentId);
        }

        // æ‰§è¡Œè¡ŒåŠ¨
        function doAction(action) {
            if (!gameState.isAlive) return;
            
            const p = gameState.player;
            let success = true;
            
            switch(action) {
                case 'study':
                    if (p.energy < 10) {
                        showNotification('ä½“åŠ›ä¸è¶³ï¼', 'bad');
                        success = false;
                        break;
                    }
                    p.energy -= 10;
                    let intGain = Math.floor(Math.random() * 3) + 1;
                    if (hasTalent('genius')) intGain *= 2;
                    p.intelligence += intGain;
                    p.stress += 2;
                    gainSkill('literature');
                    addEvent('è¡ŒåŠ¨', `ä½ è®¤çœŸå­¦ä¹ äº†ä¸€æ•´å¤©ï¼Œæ™ºåŠ›æå‡äº†${intGain}ç‚¹ï¼`, 'good');
                    break;
                    
                case 'work':
                    if (p.energy < 20) {
                        showNotification('ä½“åŠ›ä¸è¶³ï¼', 'bad');
                        success = false;
                        break;
                    }
                    if (!p.job) {
                        showNotification('ä½ è¿˜æ²¡æœ‰å·¥ä½œï¼', 'bad');
                        success = false;
                        break;
                    }
                    p.energy -= 20;
                    p.stress += 5;
                    let income = p.income;
                    if (hasTalent('workaholic')) income = Math.floor(income * 1.5);
                    p.money += income;
                    gameState.workStreak = (gameState.workStreak || 0) + 1;
                    addEvent('è¡ŒåŠ¨', `ä½ å·¥ä½œäº†ä¸€ä¸ªæœˆï¼Œè·å¾—å·¥èµ„ Â¥${income.toLocaleString()}ï¼`, 'money');
                    showFloatText(`+Â¥${income}`, window.innerWidth / 2, window.innerHeight / 2, '#f5af19');
                    break;
                    
                case 'exercise':
                    if (p.energy < 15) {
                        showNotification('ä½“åŠ›ä¸è¶³ï¼', 'bad');
                        success = false;
                        break;
                    }
                    p.energy -= 15;
                    let healthGain = Math.floor(Math.random() * 4) + 2;
                    if (hasTalent('athlete')) healthGain *= 1.5;
                    p.health += healthGain;
                    p.appearance += 1;
                    p.stress -= 3;
                    gainSkill('fitness');
                    addEvent('è¡ŒåŠ¨', `é”»ç‚¼è®©ä½ æ„Ÿè§‰ç¥æ¸…æ°”çˆ½ï¼Œå¥åº·æå‡äº†${healthGain}ç‚¹ï¼`, 'good');
                    gameState.exerciseCount = (gameState.exerciseCount || 0) + 1;
                    break;
                    
                case 'social':
                    if (p.money < 50) {
                        showNotification('èµ„é‡‘ä¸è¶³ï¼', 'bad');
                        success = false;
                        break;
                    }
                    p.money -= 50;
                    let happyGain = Math.floor(Math.random() * 6) + 3;
                    if (hasTalent('social')) happyGain *= 2;
                    p.happiness += happyGain;
                    p.appearance += 1;
                    p.stress -= 2;
                    
                    if (Math.random() > 0.6) {
                        const newFriend = {
                            name: generateRandomName('æœ‹å‹'),
                            type: 'æœ‹å‹',
                            closeness: Math.floor(Math.random() * 30) + 40,
                            avatar: 'ğŸ‘«'
                        };
                        p.relations.push(newFriend);
                        addEvent('è¡ŒåŠ¨', `ä½ å‚åŠ äº†ä¸€åœºèšä¼šï¼Œç»“è¯†äº†æ–°æœ‹å‹${newFriend.name}ï¼Œå¿«ä¹å¢åŠ äº†${happyGain}ç‚¹ï¼`, 'social');
                    } else {
                        addEvent('è¡ŒåŠ¨', `ä½ å’Œæœ‹å‹ä»¬åº¦è¿‡äº†æ„‰å¿«çš„æ—¶å…‰ï¼Œå¿«ä¹å¢åŠ äº†${happyGain}ç‚¹ï¼`, 'good');
                    }
                    break;
                    
                case 'rest':
                    let restEnergy = 20;
                    if (hasTalent('earlybird')) restEnergy += 10;
                    p.energy = Math.min(100, p.energy + restEnergy);
                    p.health += 3;
                    p.happiness += 2;
                    p.stress -= 5;
                    gameState.workStreak = 0;
                    addEvent('è¡ŒåŠ¨', 'å¥½å¥½ä¼‘æ¯äº†ä¸€è§‰ï¼Œä½“åŠ›æ¢å¤äº†ä¸å°‘ï¼', 'good');
                    break;
                    
                case 'travel':
                    if (p.money < 500) {
                        showNotification('èµ„é‡‘ä¸è¶³ï¼æ—…è¡Œéœ€è¦Â¥500', 'bad');
                        success = false;
                        break;
                    }
                    p.money -= 500;
                    let travelHappy = Math.floor(Math.random() * 8) + 5;
                    p.happiness += travelHappy;
                    p.intelligence += 2;
                    p.stress -= 10;
                    gameState.travelCount = (gameState.travelCount || 0) + 1;
                    addEvent('è¡ŒåŠ¨', `ä½ å»äº†ä¸€ä¸ªç¾ä¸½çš„åŸå¸‚æ—…æ¸¸ï¼Œå¿«ä¹å¢åŠ äº†${travelHappy}ç‚¹ï¼Œè¿˜å¼€é˜”äº†çœ¼ç•Œï¼`, 'good');
                    break;
                    
                case 'date':
                    if (p.money < 200) {
                        showNotification('èµ„é‡‘ä¸è¶³ï¼çº¦ä¼šéœ€è¦Â¥200', 'bad');
                        success = false;
                        break;
                    }
                    p.money -= 200;
                    p.happiness += 8;
                    p.stress -= 3;
                    
                    const lover = p.relations.find(r => r.type === 'æ‹äºº');
                    if (lover) {
                        lover.closeness = Math.min(100, lover.closeness + 5);
                        addEvent('è¡ŒåŠ¨', `ä½ å’Œ${lover.name}åº¦è¿‡äº†ä¸€ä¸ªæµªæ¼«çš„çº¦ä¼šï¼`, 'love');
                    } else {
                        // æœ‰æœºä¼šé‡åˆ°æ–°çš„äºº
                        if (Math.random() > 0.5 && p.age >= 15) {
                            const newLover = {
                                name: generateRandomName('æ‹äºº'),
                                type: 'æ‹äºº',
                                closeness: 50,
                                avatar: 'ğŸ’•'
                            };
                            p.relations.push(newLover);
                            gameState.loverCount = (gameState.loverCount || 0) + 1;
                            addEvent('è¡ŒåŠ¨', `ä½ åœ¨çº¦ä¼šä¸­é‡åˆ°äº†å¿ƒåŠ¨çš„äººï¼š${newLover.name}ï¼`, 'love');
                        } else {
                            addEvent('è¡ŒåŠ¨', 'ä½ åº¦è¿‡äº†ä¸€ä¸ªæ„‰å¿«çš„å¤œæ™šï¼Œä½†æ²¡æœ‰é‡åˆ°ç‰¹åˆ«çš„äººã€‚', 'neutral');
                        }
                    }
                    break;
                    
                case 'skill':
                    if (p.money < 300) {
                        showNotification('èµ„é‡‘ä¸è¶³ï¼å­¦ä¹ æŠ€èƒ½éœ€è¦Â¥300', 'bad');
                        success = false;
                        break;
                    }
                    p.money -= 300;
                    p.intelligence += 3;
                    p.stress += 2;
                    
                    // éšæœºè·å¾—ä¸€ä¸ªæŠ€èƒ½
                    const allSkillIds = [];
                    Object.values(skillsDB).forEach(cat => {
                        cat.skills.forEach(s => allSkillIds.push(s.id));
                    });
                    const randomSkill = allSkillIds[Math.floor(Math.random() * allSkillIds.length)];
                    gainSkill(randomSkill);
                    addEvent('è¡ŒåŠ¨', `ä½ å­¦ä¹ äº†æ–°æŠ€èƒ½ï¼Œæ„Ÿè§‰æ”¶è·æ»¡æ»¡ï¼`, 'good');
                    break;
            }
            
            if (success) {
                updateDisplay();
            }
        }

        // è‡ªåŠ¨æ’­æ”¾
        function toggleAutoPlay() {
            if (gameState.isAutoPlaying) {
                clearInterval(gameState.autoPlayInterval);
                gameState.isAutoPlaying = false;
                document.getElementById('autoBtn').innerHTML = '<span>â–¶ï¸</span> è‡ªåŠ¨';
            } else {
                gameState.isAutoPlaying = true;
                document.getElementById('autoBtn').innerHTML = '<span>â¸ï¸</span> åœæ­¢';
                gameState.autoPlayInterval = setInterval(() => {
                    if (gameState.isAlive) {
                        nextMonth();
                    } else {
                        toggleAutoPlay();
                    }
                }, 500);
            }
        }

        // æ£€æŸ¥æ­»äº¡
        function checkDeath() {
            const p = gameState.player;
            let deathReason = '';
            
            if (p.health <= 0) deathReason = 'å› ç—…åŒ»æ²»æ— æ•ˆ';
            else if (p.happiness <= 0) {
                gameState.depressionTime = (gameState.depressionTime || 0) + 1;
                if (gameState.depressionTime >= 12) {
                    deathReason = 'æŠ‘éƒè€Œç»ˆ';
                }
            } else {
                gameState.depressionTime = 0;
            }
            
            if (p.age > 80 && Math.random() > 0.95) deathReason = 'å¯¿ç»ˆæ­£å¯';
            if (p.age > 100 && Math.random() > 0.9) deathReason = 'å®‰è¯¦ç¦»ä¸–';
            if (p.age > 120) deathReason = 'æ‰“ç ´äº†äººç±»å¯¿å‘½çºªå½•';
            
            if (deathReason) {
                gameState.isAlive = false;
                clearInterval(gameState.autoPlayInterval);
                setTimeout(() => gameOver(deathReason), 1000);
            }
        }

        // æ¸¸æˆç»“æŸ
        function gameOver(reason) {
            document.getElementById('gameScreen').style.display = 'none';
            document.getElementById('gameOverScreen').style.display = 'flex';
            
            document.getElementById('deathReason').textContent = reason;
            document.getElementById('finalAge').textContent = gameState.player.age;
            document.getElementById('finalMoney').textContent = `Â¥${gameState.player.money.toLocaleString()}`;
            document.getElementById('finalAchievements').textContent = gameState.player.achievements.length;
            
            // ç”Ÿæˆäººç”Ÿæ€»ç»“
            const p = gameState.player;
            let summary = `${p.name}ï¼Œ${p.gender}æ€§ï¼Œäº«å¹´${p.age}å²ã€‚`;
            summary += `ä¸€ç”Ÿ${p.money > 100000 ? 'ç§¯ç´¯äº†å¯è§‚çš„è´¢å¯Œ' : 'å¹³æ·¡èŠ‚ä¿­'}ï¼Œ`;
            summary += `${p.intelligence > 70 ? 'èªæ˜ç¿æ™º' : 'å¹³å‡¡æœ´å®'}ï¼Œ`;
            summary += `${p.happiness > 70 ? 'ä¹è§‚å¼€æœ—' : 'å†…æ•›æ²‰ç¨³'}ã€‚`;
            summary += `æ‹¥æœ‰${p.properties.length}å¤„èµ„äº§ï¼Œ`;
            summary += `${Object.keys(p.skills).length}é¡¹æŠ€èƒ½ï¼Œ`;
            summary += `ç•™ä¸‹äº†${p.relations.length}æ®µçè´µçš„äººé™…å…³ç³»ã€‚`;
            document.getElementById('lifeStory').textContent = summary;
            
            // æ˜¾ç¤ºæˆå°±
            const achContainer = document.getElementById('unlockedAchievements');
            achContainer.innerHTML = p.achievements.map(ach => `
                <div class="achievement-item unlocked">
                    <div class="achievement-icon">${ach.icon}</div>
                    <div class="achievement-name">${ach.name}</div>
                </div>
            `).join('');
        }

        // æ£€æŸ¥æˆå°±
        function checkAchievements() {
            const p = gameState.player;
            
            achievementsDB.forEach(ach => {
                if (!p.achievements.find(a => a.id === ach.id) && ach.condition(p, gameState)) {
                    p.achievements.push(ach);
                    showNotification(`ğŸ† è§£é”æˆå°±ï¼š${ach.name}ï¼`, 'good');
                    addEvent('æˆå°±', `è§£é”æˆå°±ï¼š${ach.name} - ${ach.desc}`, 'good');
                }
            });
        }

        // æ£€æŸ¥ä»»åŠ¡
        function checkQuests() {
            const p = gameState.player;
            
            // æ£€æŸ¥å½“å‰ä»»åŠ¡æ˜¯å¦å®Œæˆ
            p.quests = p.quests.filter(quest => {
                if (quest.condition(p, gameState)) {
                    // å®Œæˆä»»åŠ¡
                    showNotification(`ğŸ“‹ å®Œæˆä»»åŠ¡ï¼š${quest.title}ï¼`, 'good');
                    addEvent('ä»»åŠ¡', `å®Œæˆä»»åŠ¡ï¼š${quest.title}ï¼`, 'good');
                    
                    // å‘æ”¾å¥–åŠ±
                    if (quest.reward) {
                        Object.entries(quest.reward).forEach(([key, value]) => {
                            p[key] = (p[key] || 0) + value;
                        });
                    }
                    
                    return false; // ç§»é™¤å·²å®Œæˆçš„ä»»åŠ¡
                }
                return true;
            });
            
            // æ·»åŠ æ–°ä»»åŠ¡
            questsDB.forEach(quest => {
                if (!p.quests.find(q => q.id === quest.id) && 
                    !quest.condition(p, gameState) &&
                    Math.random() < 0.1) {
                    p.quests.push(quest);
                }
            });
            
            updateQuestList();
        }

        // æ˜¾ç¤ºå•†åº—
        function showShop() {
            const modal = document.getElementById('shopModal');
            const grid = document.getElementById('shopGrid');
            
            grid.innerHTML = shopItems.map((item, idx) => {
                const owned = gameState.player.properties.includes(item.name);
                const canAfford = gameState.player.money >= item.price;
                
                return `
                    <div class="shop-item ${owned ? 'owned' : ''}" onclick="buyItem(${idx})">
                        <div class="shop-item-name">${item.name}</div>
                        <div class="shop-item-price">Â¥${item.price.toLocaleString()}</div>
                        <div class="shop-item-desc">${item.desc}</div>
                        ${owned ? '<div style="color: #27ae60;">å·²æ‹¥æœ‰</div>' : ''}
                        ${!canAfford && !owned ? '<div style="color: #e74c3c;">èµ„é‡‘ä¸è¶³</div>' : ''}
                    </div>
                `;
            }).join('');
            
            modal.classList.add('active');
        }

        // è´­ä¹°ç‰©å“
        function buyItem(idx) {
            const item = shopItems[idx];
            const p = gameState.player;
            
            if (p.properties.includes(item.name)) {
                showNotification('ä½ å·²ç»æ‹¥æœ‰è¿™ä¸ªç‰©å“äº†ï¼', 'bad');
                return;
            }
            
            if (p.money < item.price) {
                showNotification('èµ„é‡‘ä¸è¶³ï¼', 'bad');
                return;
            }
            
            // å¤„ç†æŠ•èµ„
            if (item.category === 'investment') {
                if (item.risk) {
                    const roll = Math.random();
                    if (roll > 0.5) {
                        const profit = Math.floor(item.price * (Math.random() * 0.5 + 0.2));
                        p.money += profit;
                        gameState.investProfit = (gameState.investProfit || 0) + profit;
                        showNotification(`æŠ•èµ„æˆåŠŸï¼è·åˆ© Â¥${profit.toLocaleString()}`, 'good');
                    } else if (roll < 0.3) {
                        const loss = Math.floor(item.price * (Math.random() * 0.3 + 0.1));
                        p.money -= loss;
                        showNotification(`æŠ•èµ„äºæŸï¼æŸå¤± Â¥${loss.toLocaleString()}`, 'bad');
                    } else {
                        p.money -= item.price;
                        showNotification('æŠ•èµ„æŒå¹³', 'neutral');
                    }
                } else if (item.safe) {
                    p.money -= item.price;
                    setTimeout(() => {
                        p.money += item.price * 1.1;
                        showNotification('å€ºåˆ¸åˆ°æœŸï¼è·å¾—æœ¬æ¯', 'good');
                        updateDisplay();
                    }, 3000);
                }
            } else {
                p.money -= item.price;
                
                if (item.effect) {
                    Object.entries(item.effect).forEach(([key, value]) => {
                        p[key] = (p[key] || 0) + value;
                    });
                }
                
                if (item.permanent) {
                    p.properties.push(item.name);
                }
                
                showNotification(`è´­ä¹°äº†${item.name}ï¼`, 'good');
            }
            
            updateDisplay();
            showShop(); // åˆ·æ–°å•†åº—
        }

        // æ˜¾ç¤ºæˆå°±
        function showAchievements() {
            const modal = document.getElementById('achievementModal');
            const grid = document.getElementById('achievementGrid');
            const p = gameState.player;
            
            grid.innerHTML = achievementsDB.map(ach => {
                const unlocked = p.achievements.find(a => a.id === ach.id);
                return `
                    <div class="achievement-item ${unlocked ? 'unlocked' : ''}">
                        <div class="achievement-icon">${ach.icon}</div>
                        <div class="achievement-name">${ach.name}</div>
                        <div style="font-size: 0.75em; color: rgba(255,255,255,0.5);">${ach.desc}</div>
                    </div>
                `;
            }).join('');
            
            modal.classList.add('active');
        }

        // æ˜¾ç¤ºèŒä¸šï¼ˆå¢åŠ å¹´é¾„é™åˆ¶æ˜¾ç¤ºï¼‰
        function showCareer() {
            const modal = document.getElementById('careerModal');
            const content = document.getElementById('careerContent');
            const p = gameState.player;
            
            if (!p.job) {
                content.innerHTML = '<p>ä½ å½“å‰æ²¡æœ‰å·¥ä½œ</p><button class="btn btn-primary" onclick="findJob()">æ‰¾å·¥ä½œ</button>';
            } else {
                const career = careersDB[p.job.type];
                content.innerHTML = `
                    <p><strong>å½“å‰èŒä¸šï¼š</strong>${p.job.name}</p>
                    <p><strong>èŒä½ï¼š</strong>${p.job.levelName}</p>
                    <p><strong>æœˆæ”¶å…¥ï¼š</strong>Â¥${p.income.toLocaleString()}</p>
                    <p><strong>å¹´é¾„é™åˆ¶ï¼š</strong>${career.minAge || 'æ— '} - ${career.maxAge || 'æ— '}å²</p>
                    <p><strong>æ™‹å‡è·¯å¾„ï¼š</strong>${career.levels.join(' â†’ ')}</p>
                    <button class="btn btn-primary" onclick="findJob()">æ¢å·¥ä½œ</button>
                `;
            }
            
            modal.classList.add('active');
        }

        // æ‰¾å·¥ä½œï¼ˆå¢åŠ å¹´é¾„å’Œæ•°å€¼é™åˆ¶æ£€æŸ¥ï¼‰
        function findJob() {
            const p = gameState.player;
            
            // æ ¹æ®æŠ€èƒ½å’Œå±æ€§æ¨èå·¥ä½œ
            const availableJobs = [];
            
            // æ£€æŸ¥æ¯ä¸ªèŒä¸šçš„é™åˆ¶
            const checkJob = (type, name, level) => {
                const career = careersDB[type];
                if (!career) return;
                
                // æ£€æŸ¥å¹´é¾„é™åˆ¶
                if (career.minAge && p.age < career.minAge) return;
                if (career.maxAge && p.age > career.maxAge) return;
                
                // æ£€æŸ¥å±æ€§è¦æ±‚ï¼ˆåŸæœ‰çš„ï¼‰
                let meetReq = true;
                for (let [stat, val] of Object.entries(career.requirements)) {
                    if ((p.skills[stat] || 0) < val && p[stat] < val) {
                        meetReq = false;
                        break;
                    }
                }
                
                if (meetReq) {
                    availableJobs.push({ type, name, level, career });
                }
            };
            
            if (p.skills.programming >= 2) checkJob('programmer', 'ç¨‹åºå‘˜', 0);
            if (p.skills.art >= 2 || p.skills.music >= 2) checkJob('artist', 'è‰ºæœ¯å®¶', 0);
            if (p.skills.fitness >= 3) checkJob('athlete', 'è¿åŠ¨å‘˜', 0);
            if (p.intelligence >= 50) {
                checkJob('doctor', 'åŒ»ç”Ÿ', 0);
                checkJob('lawyer', 'å¾‹å¸ˆ', 0);
            }
            
            checkJob('worker', 'æ™®é€šèŒå‘˜', 0);
            checkJob('freelancer', 'è‡ªç”±èŒä¸šè€…', 0);
            checkJob('entrepreneur', 'åˆ›ä¸šè€…', 0);
            checkJob('civil', 'å…¬åŠ¡å‘˜', 0);
            
            const content = document.getElementById('careerContent');
            if (availableJobs.length === 0) {
                content.innerHTML = '<p>å½“å‰æ²¡æœ‰é€‚åˆä½ çš„å·¥ä½œï¼ˆå¯èƒ½å¹´é¾„æˆ–æŠ€èƒ½ä¸ç¬¦åˆè¦æ±‚ï¼‰</p>';
            } else {
                content.innerHTML = `
                    <p>é€‰æ‹©ä½ æƒ³è¦ä»äº‹çš„èŒä¸šï¼ˆå·²è¿‡æ»¤å¹´é¾„ä¸ç¬¦çš„èŒä¸šï¼‰ï¼š</p>
                    ${availableJobs.map(job => `
                        <button class="choice-btn" onclick="setJob('${job.type}', ${job.level}); closeModal('careerModal');">
                            <strong>${job.name}</strong>
                            <div class="choice-effect">å¹´é¾„é™åˆ¶: ${job.career.minAge || 'æ— '}-${job.career.maxAge || 'æ— '}å² | è¦æ±‚: ${Object.entries(job.career.requirements).map(([k,v]) => `${k}${v}`).join(', ') || 'æ— '}</div>
                        </button>
                    `).join('')}
                `;
            }
        }

        // æ˜¾ç¤ºæŠ€èƒ½æ ‘
        function showSkills() {
            const modal = document.getElementById('skillModal');
            const content = document.getElementById('skillTreeContent');
            
            content.innerHTML = Object.entries(skillsDB).map(([key, category]) => `
                <div style="margin-bottom: 20px;">
                    <h3 style="color: #f5af19; margin-bottom: 10px;">${category.name}</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px;">
                        ${category.skills.map(skill => {
                            const level = gameState.player.skills[skill.id] || 0;
                            return `
                                <div style="padding: 10px; background: rgba(0,0,0,0.2); border-radius: 8px;">
                                    <div style="font-weight: 600;">${skill.name}</div>
                                    <div style="font-size: 0.8em; color: rgba(255,255,255,0.5);">${skill.desc}</div>
                                    <div style="margin-top: 5px;">
                                        ${Array(5).fill(0).map((_, i) => `
                                            <span style="color: ${i < level ? '#f5af19' : 'rgba(255,255,255,0.2)'}">â˜…</span>
                                        `).join('')}
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `).join('');
            
            modal.classList.add('active');
        }

        // æ˜¾ç¤ºäººé™…å…³ç³»
        function showRelations() {
            const modal = document.getElementById('relationsModal') || createRelationsModal();
            const list = document.getElementById('relationsList');
            
            list.innerHTML = gameState.player.relations.map(rel => `
                <div class="relation-item">
                    <div class="relation-avatar">${rel.avatar}</div>
                    <div class="relation-info">
                        <div class="relation-name">${rel.name}</div>
                        <div class="relation-type">${rel.type} Â· äº²å¯†åº¦${rel.closeness}%</div>
                    </div>
                    <button class="btn btn-secondary" onclick="interact('${rel.name}')">äº’åŠ¨</button>
                </div>
            `).join('');
            
            modal.classList.add('active');
        }

        // åˆ›å»ºå…³ç³»æ¨¡æ€æ¡†
        function createRelationsModal() {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.id = 'relationsModal';
            modal.innerHTML = `
                <div class="modal-content">
                    <h2 class="modal-header">ğŸ‘¥ äººé™…å…³ç³»</h2>
                    <div id="relationsList"></div>
                    <button class="btn btn-primary" onclick="closeModal('relationsModal')" style="margin-top: 15px; width: 100%;">å…³é—­</button>
                </div>
            `;
            document.body.appendChild(modal);
            return modal;
        }

        // ä¸äººäº’åŠ¨
        function interact(name) {
            const rel = gameState.player.relations.find(r => r.name === name);
            if (rel) {
                rel.closeness = Math.min(100, rel.closeness + 5);
                gameState.player.happiness += 3;
                gameState.player.money -= 50;
                showNotification(`ä½ ä¸${name}åº¦è¿‡äº†æ„‰å¿«çš„æ—¶å…‰ï¼`, 'good');
                updateDisplay();
                showRelations();
            }
        }

        // æ˜¾ç¤ºèµ„äº§
        function showProperties() {
            const p = gameState.player;
            if (p.properties.length === 0) {
                showNotification('ä½ è¿˜æ²¡æœ‰ä»»ä½•èµ„äº§ï¼', 'bad');
                return;
            }
            
            let content = 'ğŸ  ä½ çš„èµ„äº§ï¼š\n\n';
            p.properties.forEach(prop => {
                content += `â€¢ ${prop}\n`;
            });
            
            alert(content);
        }

        // å…³é—­æ¨¡æ€æ¡†
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // é‡æ–°å¼€å§‹
        function restartGame() {
            location.reload();
        }

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.remove('active');
                }
            });
        });

        // é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' && gameState.isAlive && document.getElementById('gameScreen').style.display !== 'none') {
                e.preventDefault();
                nextMonth();
            }
        });

        // åˆå§‹åŒ–
        initGame();
    </script>
</body>
</html>
